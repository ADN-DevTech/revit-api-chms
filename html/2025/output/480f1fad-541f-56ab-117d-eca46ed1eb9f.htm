<html><head><title>GeometryCreationUtilities.CreateFixedReferenceSweptGeometry(CurveLoop, Int32, Double, IList&lt;CurveLoop&gt;, XYZ, SolidOptions) Method</title><meta name="Title" content="CreateFixedReferenceSweptGeometry(CurveLoop, Int32, Double, IList&lt;CurveLoop&gt;, XYZ, SolidOptions) Method" /><meta name="Microsoft.Help.Id" content="M:Autodesk.Revit.DB.GeometryCreationUtilities.CreateFixedReferenceSweptGeometry(Autodesk.Revit.DB.CurveLoop,System.Int32,System.Double,System.Collections.Generic.IList{Autodesk.Revit.DB.CurveLoop},Autodesk.Revit.DB.XYZ,Autodesk.Revit.DB.SolidOptions)" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="container" content="Autodesk.Revit.DB" /><meta name="file" content="480f1fad-541f-56ab-117d-eca46ed1eb9f" /><meta name="guid" content="480f1fad-541f-56ab-117d-eca46ed1eb9f" /><meta name="Description" content="Creates a solid by sweeping one or more closed coplanar curve loops along a path while keeping the profile plane oriented so that a line in the plane that is initially perpendicular to a given fixed direction remains perpendicular as the profile is swept a" /></head><body onload="SetDefaultLanguage('cs');"><div class="pageBody"><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Geometry<wbr />Creation<wbr />Utilities<span id="LSTCD46ADCF_0" data-languageSpecificText="cpp=::|nu=."></span>Create<wbr />Fixed<wbr />Reference<wbr />Swept<wbr />Geometry(Curve<wbr />Loop, Int<wbr />32, Double, IList<span id="LSTCD46ADCF_1" data-languageSpecificText="cpp=&lt;|cs=&lt;|fs=&lt;|vb=(Of |nu=("></span>Curve<wbr />Loop<span id="LSTCD46ADCF_2" data-languageSpecificText="cpp=&gt;|cs=&gt;|fs=&gt;|vb=)|nu=)"></span>, XYZ, Solid<wbr />Options) Method</h1></td></tr></table><div class="summary">
   Creates a solid by sweeping one or more closed coplanar curve loops along a path while keeping the
   profile plane oriented so that a line in the plane that is initially perpendicular to a given fixed
   direction remains perpendicular as the profile is swept along the path.
</div><br /><strong>Namespace:</strong> <a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB</a><br /><strong>Assembly:</strong> RevitAPI (in RevitAPI.dll) Version: 25.0.0.0 (25.0.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDB')" onkeypress="SectionExpandCollapse_CheckKey('IDB', event)" tabindex="0"><img id="IDBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="IDBSection" class="collapsibleSection"><div id="IDAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAB_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cs','1','4');return false;">C#</a></div><div id="IDAB_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','vb','2','4');return false;">VB</a></div><div id="IDAB_tab3" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cpp','3','4');return false;">C++</a></div><div id="IDAB_tab4" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAB');return false;" title="Copy">Copy</a></div></div><div id="IDAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">Solid</span> <span class="identifier">CreateFixedReferenceSweptGeometry</span>(
	<span class="identifier">CurveLoop</span> <span class="parameter">sweepPath</span>,
	<span class="identifier">int</span> <span class="parameter">pathAttachmentCrvIdx</span>,
	<span class="identifier">double</span> <span class="parameter">pathAttachmentParam</span>,
	<span class="identifier">IList</span>&lt;<span class="identifier">CurveLoop</span>&gt; <span class="parameter">profileLoops</span>,
	<span class="identifier">XYZ</span> <span class="parameter">fixedReferenceDirection</span>,
	<span class="identifier">SolidOptions</span> <span class="parameter">solidOptions</span>
)</pre></div><div id="IDAB_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">CreateFixedReferenceSweptGeometry</span> ( 
	<span class="parameter">sweepPath</span> <span class="keyword">As</span> <span class="identifier">CurveLoop</span>,
	<span class="parameter">pathAttachmentCrvIdx</span> <span class="keyword">As</span> <span class="identifier">Integer</span>,
	<span class="parameter">pathAttachmentParam</span> <span class="keyword">As</span> <span class="identifier">Double</span>,
	<span class="parameter">profileLoops</span> <span class="keyword">As</span> <span class="identifier">IList</span>(<span class="keyword">Of</span> <span class="identifier">CurveLoop</span>),
	<span class="parameter">fixedReferenceDirection</span> <span class="keyword">As</span> <span class="identifier">XYZ</span>,
	<span class="parameter">solidOptions</span> <span class="keyword">As</span> <span class="identifier">SolidOptions</span>
) <span class="keyword">As</span> <span class="identifier">Solid</span></pre></div><div id="IDAB_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="keyword">static</span> <span class="identifier">Solid</span>^ <span class="identifier">CreateFixedReferenceSweptGeometry</span>(
	<span class="identifier">CurveLoop</span>^ <span class="parameter">sweepPath</span>, 
	<span class="identifier">int</span> <span class="parameter">pathAttachmentCrvIdx</span>, 
	<span class="identifier">double</span> <span class="parameter">pathAttachmentParam</span>, 
	<span class="identifier">IList</span>&lt;<span class="identifier">CurveLoop</span>^&gt;^ <span class="parameter">profileLoops</span>, 
	<span class="identifier">XYZ</span>^ <span class="parameter">fixedReferenceDirection</span>, 
	<span class="identifier">SolidOptions</span>^ <span class="parameter">solidOptions</span>
)</pre></div><div id="IDAB_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">static</span> <span class="keyword">member</span> <span class="identifier">CreateFixedReferenceSweptGeometry</span> : 
        <span class="parameter">sweepPath</span> : <span class="identifier">CurveLoop</span> * 
        <span class="parameter">pathAttachmentCrvIdx</span> : <span class="identifier">int</span> * 
        <span class="parameter">pathAttachmentParam</span> : <span class="identifier">float</span> * 
        <span class="parameter">profileLoops</span> : <span class="identifier">IList</span>&lt;<span class="identifier">CurveLoop</span>&gt; * 
        <span class="parameter">fixedReferenceDirection</span> : <span class="identifier">XYZ</span> * 
        <span class="parameter">solidOptions</span> : <span class="identifier">SolidOptions</span> <span class="keyword">-&gt;</span> <span class="identifier">Solid</span> </pre></div></div></div><h4>Parameters</h4><dl><dt class="has-text-weight-normal"><span class="parameter">sweepPath</span>  <a href="84824924-cb89-9e20-de6e-3461f429dfd6.htm">CurveLoop</a></dt><dd>
   The sweep path, consisting of a set of contiguous curves. The path may be open or closed,
   but should not otherwise have any self-intersections. The path may be planar or non-planar.
   With the exception of path curves that lie in a plane parallel to %fixedReferenceDirection%,
   the curve's tangent should be nowhere parallel to %fixedReferenceDirection%. If the sweep path
   has corners, the solid segments that meet at a corner may not meet smoothly.
</dd><dt class="has-text-weight-normal"><span class="parameter">pathAttachmentCrvIdx</span>  <a href="https://learn.microsoft.com/dotnet/api/system.int32" target="_blank" rel="noopener noreferrer">Int32</a></dt><dd>
   The index of the curve in the sweep path where the profile loops are situated.
   Indexing starts at 0. Together with pathAttachmentParam, this specifies the profile's attachment point.
</dd><dt class="has-text-weight-normal"><span class="parameter">pathAttachmentParam</span>  <a href="https://learn.microsoft.com/dotnet/api/system.double" target="_blank" rel="noopener noreferrer">Double</a></dt><dd>
   Parameter of the path curve specified by pathAttachmentCrvIdx.
   The profile curves must lie in the plane orthogonal to the path at this attachment point.
</dd><dt class="has-text-weight-normal"><span class="parameter">profileLoops</span>  <a href="https://learn.microsoft.com/dotnet/api/system.collections.generic.ilist-1" target="_blank" rel="noopener noreferrer">IList</a><span id="LSTCD46ADCF_3" data-languageSpecificText="cpp=&lt;|cs=&lt;|fs=&lt;|vb=(Of |nu=("></span><a href="84824924-cb89-9e20-de6e-3461f429dfd6.htm">CurveLoop</a><span id="LSTCD46ADCF_4" data-languageSpecificText="cpp=&gt;|cs=&gt;|fs=&gt;|vb=)|nu=)"></span></dt><dd>
   The curve loops defining the planar domain to be swept along the path.
   No conditions are imposed on the orientations of the loops; this function will use copies of the input loops
   that have been oriented as necessary to conform to Revit's orientation conventions.
   Restrictions:
   <ul><li>The loops must lie in the plane orthogonal to the path at the attachment point as defined above. </li><li>The curve loop(s) must be closed and should define a single planar domain (one outer loop and, optionally, one or more inner loops). </li><li>The curve loops must be without intersections, self-intersections, or degeneracies. </li><li>No loop may contain just one closed curve - split such loops into two or more curves beforehand. </li></ul></dd><dt class="has-text-weight-normal"><span class="parameter">fixedReferenceDirection</span>  <a href="c2fd995c-95c0-58fb-f5de-f3246cbc5600.htm">XYZ</a></dt><dd>
   A unit vector specifying the fixed direction used to control how the profile plane is swept along the path; see the description and remarks above.
   The profile CurveLoops do not satisfy the input requirements.
</dd><dt class="has-text-weight-normal"><span class="parameter">solidOptions</span>  <a href="75d6caeb-62d1-d31f-47fe-618ac7cedf19.htm">SolidOptions</a></dt><dd>
   The optional information to control the properties of the Solid.
</dd></dl><h4>Return Value</h4><a href="7a3b5ac1-c66d-9f81-a11d-9bcd4e026295.htm">Solid</a><br />
   The requested solid.
</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDJC')" onkeypress="SectionExpandCollapse_CheckKey('IDJC', event)" tabindex="0"><img id="IDJCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Exceptions</span></div><div id="IDJCSection" class="collapsibleSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="2e6e4206-97a8-dd4b-df5d-4269f4bb6088.htm">ArgumentException</a></td><td>
   The input argument sweepPath should at least contain one curve.
   -or-
   The input argument pathAttachmentCrvIdx is not valid.
   -or-
</td></tr><tr><td><a href="631e1424-60f4-929b-4e52-dda9dcd26316.htm">ArgumentNullException</a></td><td>
   A non-optional argument was null
</td></tr><tr><td><a href="60f148c9-ece0-a6bb-4e12-bb4a9c8c8a24.htm">ArgumentOutOfRangeException</a></td><td>
   fixedReferenceDirection is not length 1.0.
</td></tr></table></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDBC')" onkeypress="SectionExpandCollapse_CheckKey('IDBC', event)" tabindex="0"><img id="IDBCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="IDBCSection" class="collapsibleSection">
   The profile loops must lie in a plane orthogonal to the sweep path at some attachment point along the path.
   An example where this method is useful is in constructing railings. If the fixed direction is the upward
   vertical, a line in the profile plane that is initially horizontal will remain horizontal as the profile
   is swept along the path. This property can be used to ensure that the top of the railing remains horizontal
   all along the railing.

   The STEP ISO 10303-42 and IFC standards define a "Fixed Reference Sweep" similar to this sweep method, though
   there are some minor technical differences:
   <ul><li>The STEP ISO reference describes a specific parameterization of the swept surface, whereas we do not guarantee any particular parameterization (partly because we simplify the surface when possible).</li><li>Neither reference mentions what should be done if the sweep pathâ€™s tangent is tangent to the reference direction at some point(s) or along the entire directrix.</li><li>Both references impose unnecessary conditions, and they're inconsistent: STEP says "the swept_curve is required to be a curve lying in the plane z = 0" while IFC says "The SweptArea shall lie in the plane z = 0" (SweptArea is the profile being swept).</li></ul></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Reference</h4><div><a href="e829700d-48ff-0914-b288-5ceb93d8ee86.htm">GeometryCreationUtilities Class</a></div><div><a href="ec46c241-cb1a-2e5b-d834-fca5e1047ffa.htm">CreateFixedReferenceSweptGeometry Overload</a></div><div><a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB Namespace</a></div></div></div></div>
        </div></body></html>