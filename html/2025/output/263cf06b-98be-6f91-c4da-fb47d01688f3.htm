<html><head><title>FilteredElementCollector Class</title><meta name="Title" content="FilteredElementCollector Class" /><meta name="Microsoft.Help.Id" content="T:Autodesk.Revit.DB.FilteredElementCollector" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="System.Keywords" content="Autodesk.Revit.DB.FilteredElementCollector class" /><meta name="System.Keywords" content="FilteredElementCollector class" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.DB.FilteredElementCollector" /><meta name="Microsoft.Help.F1" content="FilteredElementCollector" /><meta name="container" content="Autodesk.Revit.DB" /><meta name="file" content="263cf06b-98be-6f91-c4da-fb47d01688f3" /><meta name="guid" content="263cf06b-98be-6f91-c4da-fb47d01688f3" /><meta name="Microsoft.Help.Category" content="CSharp" /><meta name="Microsoft.Help.Category" content="VB" /><meta name="Description" content="This class is used to search, filter and iterate through a set of elements." /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /></head><body onload="SetDefaultLanguage('cs');"><div class="pageBody"><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Filtered<wbr />Element<wbr />Collector Class</h1></td></tr></table><div class="summary">
   This class is used to search, filter and iterate through a set of elements.
</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDDA')" onkeypress="SectionExpandCollapse_CheckKey('IDDA', event)" tabindex="0"><img id="IDDAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Inheritance Hierarchy</span></div><div id="IDDASection" class="collapsibleSection"><a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">System<span id="LST7F61EEAF_0" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>Object</a><br />  <span class="selflink">Autodesk.Revit.DB<span id="LST7F61EEAF_1" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>FilteredElementCollector</span><br /></div><br /><strong>Namespace:</strong> <a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB</a><br /><strong>Assembly:</strong> RevitAPI (in RevitAPI.dll) Version: 25.0.0.0 (25.0.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDB')" onkeypress="SectionExpandCollapse_CheckKey('IDB', event)" tabindex="0"><img id="IDBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="IDBSection" class="collapsibleSection"><div id="IDAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAB_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cs','1','4');return false;">C#</a></div><div id="IDAB_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','vb','2','4');return false;">VB</a></div><div id="IDAB_tab3" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cpp','3','4');return false;">C++</a></div><div id="IDAB_tab4" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAB');return false;" title="Copy">Copy</a></div></div><div id="IDAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">class</span> <span class="identifier">FilteredElementCollector</span> : <span class="identifier">IEnumerable</span>&lt;<span class="identifier">Element</span>&gt;, 
	<span class="identifier">IDisposable</span></pre></div><div id="IDAB_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Class</span> <span class="identifier">FilteredElementCollector</span>
	<span class="keyword">Implements</span> <span class="identifier">IEnumerable</span>(<span class="keyword">Of</span> <span class="identifier">Element</span>), <span class="identifier">IDisposable</span></pre></div><div id="IDAB_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">ref class</span> <span class="identifier">FilteredElementCollector</span> : <span class="identifier">IEnumerable</span>&lt;<span class="identifier">Element</span>^&gt;, 
	<span class="identifier">IDisposable</span></pre></div><div id="IDAB_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">type</span> <span class="identifier">FilteredElementCollector</span> = 
    <span class="keyword">class</span>
        <span class="keyword">interface</span> <span class="identifier">IEnumerable</span>&lt;<span class="identifier">Element</span>&gt;
        <span class="keyword">interface</span> <span class="identifier">IDisposable</span>
    <span class="keyword">end</span></pre></div></div></div></div><p>The <span class="selflink">FilteredElementCollector</span> type exposes the following members.</p><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDAAFA')" onkeypress="SectionExpandCollapse_CheckKey('IDAAFA', event)" tabindex="0"><img id="IDAAFAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Constructors</span></div><div id="IDAAFASection" class="collapsibleSection"><table id="ConstructorList" class="members"><tr><th class="iconColumn"> </th><th>Name</th><th>Description</th></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="0635f1e4-652a-7e42-15af-94f24c4d8e8d.htm">FilteredElementCollector(Document)</a></td><td>
   Constructs a new FilteredElementCollector that will search and filter the set of elements in a document.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="6359776d-915e-f8a2-4147-b31024671ee1.htm">FilteredElementCollector(Document, ElementId)</a></td><td>
   Constructs a new FilteredElementCollector that will search and filter the visible elements in a view.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="901f78a0-1f6c-217b-ea48-8b404324e88b.htm">FilteredElementCollector(Document, ICollection<span id="LST7F61EEAF_2" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=("></span>ElementId<span id="LST7F61EEAF_3" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)"></span>)</a></td><td>
   Constructs a new FilteredElementCollector that will search and filter a specified set of elements.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="968b52a0-de55-2f96-de40-968812bc41c7.htm">FilteredElementCollector(Document, ElementId, ElementId)</a></td><td>
   Constructs a new FilteredElementCollector that will search and filter the visible elements from
   a Revit link in a host document view.
</td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4FA')" onkeypress="SectionExpandCollapse_CheckKey('ID4FA', event)" tabindex="0"><img id="ID4FAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Properties</span></div><div id="ID4FASection" class="collapsibleSection"><table id="PropertyList" class="members"><tr><th class="iconColumn"> </th><th>Name</th><th>Description</th></tr><tr><td><img src="../icons/pubProperty.gif" alt="Public property" title="Public property" /></td><td><a href="259b95d7-5686-d69c-669f-904c3b08d6c8.htm">IsValidObject</a></td><td>
   Specifies whether the .NET object represents a valid Revit entity.
</td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDBFA')" onkeypress="SectionExpandCollapse_CheckKey('IDBFA', event)" tabindex="0"><img id="IDBFAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Methods</span></div><div id="IDBFASection" class="collapsibleSection"><table id="MethodList" class="members"><tr><th class="iconColumn"> </th><th>Name</th><th>Description</th></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="92a2be0f-f632-2337-5bdd-ae3e832f3c33.htm">ContainedInDesignOption</a></td><td>
   Applies an ElementDesignOptionFilter to the collector.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="c23c8781-f645-c059-7db5-d0cfd732dda1.htm">Dispose</a></td><td>Releases all resources used by the <span class="selflink">FilteredElementCollector</span></td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)" target="_blank" rel="noopener noreferrer">Equals</a></td><td>Determines whether the specified object is equal to the current object.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="80e23fdc-c005-163b-5643-38d84411a73d.htm">Excluding</a></td><td>
   Applies an ExclusionFilter to the collector.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="c8c1cae0-4ac8-a309-e915-6d491137d47e.htm">FirstElement</a></td><td>
   Returns the first element to pass the filter(s).
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="b1b42ac5-e816-983a-f44d-5cf441ca1ad9.htm">FirstElementId</a></td><td>
   Returns the id of the first element to pass the filter(s).
</td></tr><tr><td><img src="../icons/protMethod.gif" alt="Protected method" title="Protected method" /></td><td><a href="07236f22-1721-1f6e-0fb6-f03709923430.htm">GetBasicIEnumerator</a></td><td>Returns an enumerator that iterates through a collection.</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="886aabfd-ea87-e54c-d108-37d09a44d612.htm">GetElementCount</a></td><td>
   Gets the number of elements in your current filter.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="0b1cdbeb-21ce-a4c5-6cae-253595818085.htm">GetElementIdIterator</a></td><td>
   Returns an element id iterator to the elements passing the filters.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="7113e21c-90f8-8f58-3b00-407fc1cd56e0.htm">GetElementIterator</a></td><td>
   Returns an element iterator to the elements passing the filters.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="746ac65b-35c2-d0db-53d7-4fe0fd61ab1f.htm">GetEnumerator</a></td><td>Returns an enumerator that iterates through a collection.</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode#system-object-gethashcode" target="_blank" rel="noopener noreferrer">GetHashCode</a></td><td>Serves as the default hash function.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.gettype#system-object-gettype" target="_blank" rel="noopener noreferrer">GetType</a></td><td>Gets the <a href="https://learn.microsoft.com/dotnet/api/system.type" target="_blank" rel="noopener noreferrer">Type</a> of the current instance.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="5b204fc8-7702-cf7e-346a-3a4c1767924b.htm">IntersectWith</a></td><td>
   Intersects the set of elements passing the filter in this collector
   with the set of elements passing the filter in another collector.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /></td><td><a href="9c7f3f9c-aa8a-8077-9235-ff1058c8b20b.htm">IsViewValidForElementIteration</a></td><td>
   Identifies if the particular element is valid for iteration of drawn elements.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="c3523c35-4a07-9723-3c28-de3cc47b2ad0.htm">OfCategory</a></td><td>
   Applies an ElementCategoryFilter to the collector.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="63304108-73f8-844e-82fc-5b8fad9839b0.htm">OfCategoryId</a></td><td>
   Applies an ElementCategoryFilter to the collector.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="b0a5f22c-6951-c3af-cd29-1f28f574035d.htm">OfClass</a></td><td>
   Applies an ElementClassFilter to the collector.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="54f2107a-bd87-41fe-dd00-385253ba5915.htm">OwnedByView</a></td><td>
   Applies an ElementOwnerViewFilter to the collector.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="bfb8c8a2-aa2f-b1bc-7d57-7e3f7d39fcae.htm">ToElementIds</a></td><td>
   Returns the complete set of element ids that pass the filter(s).
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="732b4a0d-62d8-b86d-120b-8ea3d9713b34.htm">ToElements</a></td><td>
   Returns the complete set of elements that pass the filter(s).
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.tostring#system-object-tostring" target="_blank" rel="noopener noreferrer">ToString</a></td><td>Returns a string that represents the current object.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="957cc5cb-5c7f-cac9-ec86-35afe824c432.htm">UnionWith</a></td><td>
   Unites the set of elements passing the filter in this collector
   with the set of elements passing the filter in another collector.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="3f3269fc-367c-1fec-9ddb-d0b54ecc4f0e.htm">WhereElementIsCurveDriven</a></td><td>
   Applies an ElementIsCurveDrivenFilter to the collector.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="77793daa-5a26-b4d6-9019-4d998a55099e.htm">WhereElementIsElementType</a></td><td>
   Applies an ElementIsElementTypeFilter to the collector.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="061cbbb9-26f1-a8f8-a4b2-3d7ff0105199.htm">WhereElementIsNotElementType</a></td><td>
   Applies an inverted ElementIsElementTypeFilter to the collector.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="38b15459-9ffe-204a-0193-47c3a1b5e6e2.htm">WhereElementIsViewIndependent</a></td><td>
   Applies an ElementOwnerViewFilter to the collector.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="42d4eef3-55a1-2739-0ef8-6bc1d9fc2755.htm">WherePasses</a></td><td>
   Applies an element filter to the collector.
</td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDBC')" onkeypress="SectionExpandCollapse_CheckKey('IDBC', event)" tabindex="0"><img id="IDBCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="IDBCSection" class="collapsibleSection"><p>Developers can assign a variety of conditions to filter the elements that are returned.
   This class requires that at least one condition be set before making the attempt to access the elements.</p><p>Revit will attempt to organize the filters in order to minimize expansion of elements regardless of
   the order in which conditions and filters are applied.</p><p>There are three groups of methods that you can use on a given collector once you have applied filter(s)
   to it.  One group provides collections of all passing elements, a second finds the first match of the given
   filter(s), and a third provides an iterator that is evaluated lazily (each element is tested by the filter
   only when the iterator reaches it).   You should only use
   one of the methods from these group at a time; the collector will reset if you call another method to
   extract elements.  Thus, if you have previously obtained an iterator, it will be stopped and traverse no more
   elements if you call another method to extract elements.</p><p>In .NET, this class supports the IEnumerable interface for Elements.  You can use this class with
   LINQ queries and operations to process lists of elements.  Note that because the ElementFilters
   and the shortcut methods offered by this class process elements in native code before their
   managed wrappers are generated, better performance will be obtained by using as many native filters
   as possible on the collector before attempting to process the results using LINQ queries.</p><p>One special consideration when using this class in .NET: the debugger will attempt
   to traverse the members of the collector because of its implementation of IEnumerable.  You may see strange
   results if you also attempt to extract the first element or all elements from the collector while the debugger
   is also looking at the contents of the collector.</p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Reference</h4><div><a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB Namespace</a></div></div></div></div>
        </div></body></html>