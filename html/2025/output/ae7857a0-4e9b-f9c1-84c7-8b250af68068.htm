<html><head><title>WorksharingUtils Class</title><meta name="Title" content="WorksharingUtils Class" /><meta name="Microsoft.Help.Id" content="T:Autodesk.Revit.DB.WorksharingUtils" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="System.Keywords" content="Autodesk.Revit.DB.WorksharingUtils class" /><meta name="System.Keywords" content="WorksharingUtils class" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.DB.WorksharingUtils" /><meta name="Microsoft.Help.F1" content="WorksharingUtils" /><meta name="container" content="Autodesk.Revit.DB" /><meta name="file" content="ae7857a0-4e9b-f9c1-84c7-8b250af68068" /><meta name="guid" content="ae7857a0-4e9b-f9c1-84c7-8b250af68068" /><meta name="Microsoft.Help.Category" content="CSharp" /><meta name="Microsoft.Help.Category" content="VB" /><meta name="Description" content="A static class that contains utility functions related to worksharing." /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /></head><body onload="SetDefaultLanguage('cs');"><div class="pageBody"><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Worksharing<wbr />Utils Class</h1></td></tr></table><div class="summary">
   A static class that contains utility functions related to worksharing.
</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDDA')" onkeypress="SectionExpandCollapse_CheckKey('IDDA', event)" tabindex="0"><img id="IDDAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Inheritance Hierarchy</span></div><div id="IDDASection" class="collapsibleSection"><a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">System<span id="LSTBF8114F0_0" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>Object</a><br />  <span class="selflink">Autodesk.Revit.DB<span id="LSTBF8114F0_1" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>WorksharingUtils</span><br /></div><br /><strong>Namespace:</strong> <a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB</a><br /><strong>Assembly:</strong> RevitAPI (in RevitAPI.dll) Version: 25.0.0.0 (25.0.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDB')" onkeypress="SectionExpandCollapse_CheckKey('IDB', event)" tabindex="0"><img id="IDBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="IDBSection" class="collapsibleSection"><div id="IDAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAB_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cs','1','4');return false;">C#</a></div><div id="IDAB_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','vb','2','4');return false;">VB</a></div><div id="IDAB_tab3" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cpp','3','4');return false;">C++</a></div><div id="IDAB_tab4" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAB');return false;" title="Copy">Copy</a></div></div><div id="IDAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">class</span> <span class="identifier">WorksharingUtils</span> : <span class="identifier">IDisposable</span></pre></div><div id="IDAB_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Class</span> <span class="identifier">WorksharingUtils</span>
	<span class="keyword">Implements</span> <span class="identifier">IDisposable</span></pre></div><div id="IDAB_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">ref class</span> <span class="identifier">WorksharingUtils</span> : <span class="identifier">IDisposable</span></pre></div><div id="IDAB_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">type</span> <span class="identifier">WorksharingUtils</span> = 
    <span class="keyword">class</span>
        <span class="keyword">interface</span> <span class="identifier">IDisposable</span>
    <span class="keyword">end</span></pre></div></div></div></div><p>The <span class="selflink">WorksharingUtils</span> type exposes the following members.</p><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDNFA')" onkeypress="SectionExpandCollapse_CheckKey('IDNFA', event)" tabindex="0"><img id="IDNFAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Properties</span></div><div id="IDNFASection" class="collapsibleSection"><table id="PropertyList" class="members"><tr><th class="iconColumn"> </th><th>Name</th><th>Description</th></tr><tr><td><img src="../icons/pubProperty.gif" alt="Public property" title="Public property" /></td><td><a href="6f86ac74-bb9d-56b0-eb5c-fbaeb169ef3e.htm">IsValidObject</a></td><td>
   Specifies whether the .NET object represents a valid Revit entity.
</td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDCFA')" onkeypress="SectionExpandCollapse_CheckKey('IDCFA', event)" tabindex="0"><img id="IDCFAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Methods</span></div><div id="IDCFASection" class="collapsibleSection"><table id="MethodList" class="members"><tr><th class="iconColumn"> </th><th>Name</th><th>Description</th></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="5553298f-e8a3-13f1-3f1b-f3505e82eb5c.htm">CheckoutElements(Document, ICollection<span id="LSTBF8114F0_2" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=("></span>ElementId<span id="LSTBF8114F0_3" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)"></span>)</a></td><td>
   Obtains ownership for the current user of as many specified elements as possible.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /></td><td><a href="50d213af-17cb-b92a-6251-ce9a79e5ce5b.htm">CheckoutElements(Document, ISet<span id="LSTBF8114F0_4" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=("></span>ElementId<span id="LSTBF8114F0_5" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)"></span>, TransactWithCentralOptions)</a></td><td>
   Obtains ownership for the current user of as many specified elements as possible.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="97f0d4eb-ad2a-ca9d-a896-5144bd68c5a5.htm">CheckoutWorksets(Document, ICollection<span id="LSTBF8114F0_6" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=("></span>WorksetId<span id="LSTBF8114F0_7" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)"></span>)</a></td><td>
   Obtains ownership for the current user of as many specified worksets as possible.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /></td><td><a href="39b55560-c85b-bebc-e825-b76b5ba313a7.htm">CheckoutWorksets(Document, ISet<span id="LSTBF8114F0_8" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=("></span>WorksetId<span id="LSTBF8114F0_9" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)"></span>, TransactWithCentralOptions)</a></td><td>
   Obtains ownership for the current user of as many specified worksets as possible.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /></td><td><a href="90102c11-d982-77f5-d08c-e68b1a882281.htm">CreateNewLocal</a></td><td>
   Takes a path to a central model and copies the model into a new local file for the current user.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="260ca2a7-7757-529e-228e-e3c511904af7.htm">Dispose</a></td><td>Releases all resources used by the <span class="selflink">WorksharingUtils</span></td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)" target="_blank" rel="noopener noreferrer">Equals</a></td><td>Determines whether the specified object is equal to the current object.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /></td><td><a href="1a4b4bbb-060d-1f42-fbb2-ab85081f8e7f.htm">GetCheckoutStatus(Document, ElementId)</a></td><td>
   Gets the ownership status of an element.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /></td><td><a href="8359bb9a-01d2-d595-c72b-718c70841511.htm">GetCheckoutStatus(Document, ElementId, String<span id="LSTBF8114F0_10" data-languageSpecificText="cpp=%"></span>)</a></td><td>
   Gets the ownership status and outputs the owner of an element.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode#system-object-gethashcode" target="_blank" rel="noopener noreferrer">GetHashCode</a></td><td>Serves as the default hash function.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="346a8cda-0222-557c-8de7-deea05418868.htm">GetModelUpdatesStatus</a></td><td>
   Gets the status of a single element in the central model.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.gettype#system-object-gettype" target="_blank" rel="noopener noreferrer">GetType</a></td><td>Gets the <a href="https://learn.microsoft.com/dotnet/api/system.type" target="_blank" rel="noopener noreferrer">Type</a> of the current instance.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /></td><td><a href="15ec1e3e-61d5-b6a1-3604-8b866a988270.htm">GetUserWorksetInfo</a></td><td>
   Gets information about user worksets in a workshared model file, without fully opening the file.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /></td><td><a href="1e54c25f-7d7a-7484-be7b-d741084418a9.htm">GetWorksharingTooltipInfo</a></td><td>
   Gets worksharing information about an element to display in an in-canvas tooltip.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /></td><td><a href="09f4e163-cb8f-de87-d641-3ba667adf4e0.htm">RelinquishOwnership</a></td><td>
   Relinquishes ownership by the current user of as many specified elements and worksets as possible,
   and grants element ownership requested by other users on a first-come, first-served basis.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.tostring#system-object-tostring" target="_blank" rel="noopener noreferrer">ToString</a></td><td>Returns a string that represents the current object.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDBC')" onkeypress="SectionExpandCollapse_CheckKey('IDBC', event)" tabindex="0"><img id="IDBCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="IDBCSection" class="collapsibleSection"><p> Return values from inquiries about the worksharing status of elements or worksets
   rely on local caching of information from the central model so it is possible that the
   information is out of date. Because of this, the return value is suitable for reporting to an
   interactive user (e.g. via a mechanism similar to Worksharing display mode), but cannot be considered
   a reliable indication of whether the element can be immediately edited by the application.  To make an immediate
   attempt to edit elements, use <span class="noLink">[!:CheckoutElements()]</span> and check the return status,
   then confirm if the elements are up to date.</p><p> In addition, information about the current user may not be
   reliable while Revit is in the middle of an editing transaction.  For example,
   if you move an unowned wall from an unowned workset to a workset you own,
   then before you explicitly or Revit automatically checks out the wall for you,
   GetCheckoutStatus() might erroneously tell you CheckoutStatus.OwnedByCurrentUser
   because although the official (as seen in central and by other users) owner is no one,
   locally it looks like you already own it since it belongs to a workset you own. </p><p> For operations that interact with central (as opposed to use only cached values),
   Revit might opportunistically refresh some editing permissions or check the status of editing requests. </p><p> Some useful definitions to keep in mind follow:
   <ul><li>The owner of a workset: the user who has the Workset checked out; this could be nobody (the empty string). </li><li> The borrower of an element: the user who has explicitly checked out ("borrowed") the Element;
   this could be nobody. </li><li> The owner of an element: If element is borrowed (i.e. explicitly checked out),
   then the element's owner is the borrower, otherwise it is the owner or the workset containing the element. </li></ul></p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDDC')" onkeypress="SectionExpandCollapse_CheckKey('IDDC', event)" tabindex="0"><img id="IDDCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Example</span></div><div id="IDDCSection" class="collapsibleSection"><div id="IDADC" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDADC_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDADC','cs','1','4');return false;">C#</a></div><div id="IDADC_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDADC','vb','2','4');return false;">VB</a></div><div id="IDADC_tab3" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDADC','cpp','3','4');return false;">C++</a></div><div id="IDADC_tab4" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDADC','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDADC_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDADC');return false;" title="Copy">Copy</a></div></div><div id="IDADC_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">public</span> <span class="highlight-keyword">void</span> GetElementWorksharingInfo(Document doc, Element elem)
{
    String message = String.Empty;
    message += <span class="highlight-literal">"Element Id: "</span> + elem.Id;

    <span class="highlight-comment">// The workset the element belongs to</span>
    WorksetId worksetId = elem.WorksetId;
    message += (<span class="highlight-literal">"\nWorkset Id : "</span> + worksetId.ToString());

    <span class="highlight-comment">// Model Updates Status of the element</span>
    ModelUpdatesStatus updateStatus = WorksharingUtils.GetModelUpdatesStatus(doc, elem.Id);
    message += (<span class="highlight-literal">"\nUpdate status : "</span> + updateStatus.ToString());

    <span class="highlight-comment">// Checkout Status of the element</span>
    CheckoutStatus checkoutStatus = WorksharingUtils.GetCheckoutStatus(doc, elem.Id);
    message += (<span class="highlight-literal">"\nCheckout status : "</span> + checkoutStatus.ToString());

    <span class="highlight-comment">// Getting WorksharingTooltipInfo of a given element Id</span>
    WorksharingTooltipInfo tooltipInfo = WorksharingUtils.GetWorksharingTooltipInfo(doc, elem.Id);
    message += (<span class="highlight-literal">"\nCreator : "</span> + tooltipInfo.Creator);
    message += (<span class="highlight-literal">"\nCurrent Owner : "</span> + tooltipInfo.Owner);
    message += (<span class="highlight-literal">"\nLast Changed by : "</span> + tooltipInfo.LastChangedBy);

    Autodesk.Revit.UI.TaskDialog.Show(<span class="highlight-literal">"GetElementWorksharingInfo"</span>, message);
}</pre></div><div id="IDADC_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="highlight-keyword">Public</span> <span class="highlight-keyword">Sub</span> GetElementWorksharingInfo(doc <span class="highlight-keyword">As</span> Document, elem <span class="highlight-keyword">As</span> Element)
    <span class="highlight-keyword">Dim</span> message <span class="highlight-keyword">As</span> [<span class="highlight-keyword">String</span>] = [<span class="highlight-keyword">String</span>].Empty
    message += <span class="highlight-literal">"Element Id: "</span> + elem.Id.ToString

    <span class="highlight-comment">' The workset the element belongs to</span>
    <span class="highlight-keyword">Dim</span> worksetId <span class="highlight-keyword">As</span> WorksetId = elem.WorksetId
    message += (vbLf &amp; <span class="highlight-literal">"Workset Id : "</span> + worksetId.ToString())

    <span class="highlight-comment">' Model Updates Status of the element</span>
    <span class="highlight-keyword">Dim</span> updateStatus <span class="highlight-keyword">As</span> ModelUpdatesStatus = WorksharingUtils.GetModelUpdatesStatus(doc, elem.Id)
    message += (vbLf &amp; <span class="highlight-literal">"Update status : "</span> + updateStatus.ToString())

    <span class="highlight-comment">' Checkout Status of the element</span>
    <span class="highlight-keyword">Dim</span> checkoutStatus <span class="highlight-keyword">As</span> CheckoutStatus = WorksharingUtils.GetCheckoutStatus(doc, elem.Id)
    message += (vbLf &amp; <span class="highlight-literal">"Checkout status : "</span> + checkoutStatus.ToString())

    <span class="highlight-comment">' Getting WorksharingTooltipInfo of a given element Id</span>
    <span class="highlight-keyword">Dim</span> tooltipInfo <span class="highlight-keyword">As</span> WorksharingTooltipInfo = WorksharingUtils.GetWorksharingTooltipInfo(doc, elem.Id)
    message += (vbLf &amp; <span class="highlight-literal">"Creator : "</span> + tooltipInfo.Creator)
    message += (vbLf &amp; <span class="highlight-literal">"Current Owner : "</span> + tooltipInfo.Owner)
    message += (vbLf &amp; <span class="highlight-literal">"Last Changed by : "</span> + tooltipInfo.LastChangedBy)

    Autodesk.Revit.UI.TaskDialog.Show(<span class="highlight-literal">"GetElementWorksharingInfo"</span>, message)
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span></pre></div><div id="IDADC_code_Div3" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div><div id="IDADC_code_Div4" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div></div></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Reference</h4><div><a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB Namespace</a></div></div></div></div>
        </div></body></html>