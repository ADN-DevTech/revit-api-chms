<html><head><title>SchemaBuilder.AddMapField Method</title><meta name="Title" content="AddMapField Method" /><meta name="Microsoft.Help.Id" content="M:Autodesk.Revit.DB.ExtensibleStorage.SchemaBuilder.AddMapField(System.String,System.Type,System.Type)" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="System.Keywords" content="SchemaBuilder.AddMapField method" /><meta name="System.Keywords" content="AddMapField method" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.DB.ExtensibleStorage.SchemaBuilder.AddMapField" /><meta name="Microsoft.Help.F1" content="SchemaBuilder.AddMapField" /><meta name="Microsoft.Help.F1" content="AddMapField" /><meta name="container" content="Autodesk.Revit.DB.ExtensibleStorage" /><meta name="file" content="ed30389b-a527-c867-3903-ce033f55552c" /><meta name="guid" content="ed30389b-a527-c867-3903-ce033f55552c" /><meta name="Description" content="Creates a field containing an ordered key-value map in the Schema, with given name and type of contained values." /></head><body onload="SetDefaultLanguage('cs');"><div class="pageBody"><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Schema<wbr />Builder<span id="LSTA1B6AB43_0" data-languageSpecificText="cpp=::|nu=."></span>Add<wbr />Map<wbr />Field Method</h1></td></tr></table><div class="summary">
   Creates a field containing an ordered key-value map in the Schema, with given name and
   type of contained values.
</div><br /><strong>Namespace:</strong> <a href="79486a74-376c-9555-c873-45d5a750f051.htm">Autodesk.Revit.DB.ExtensibleStorage</a><br /><strong>Assembly:</strong> RevitAPI (in RevitAPI.dll) Version: 25.0.0.0 (25.0.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDB')" onkeypress="SectionExpandCollapse_CheckKey('IDB', event)" tabindex="0"><img id="IDBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="IDBSection" class="collapsibleSection"><div id="IDAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAB_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cs','1','4');return false;">C#</a></div><div id="IDAB_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','vb','2','4');return false;">VB</a></div><div id="IDAB_tab3" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cpp','3','4');return false;">C++</a></div><div id="IDAB_tab4" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAB');return false;" title="Copy">Copy</a></div></div><div id="IDAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="identifier">FieldBuilder</span> <span class="identifier">AddMapField</span>(
	<span class="identifier">string</span> <span class="parameter">fieldName</span>,
	<span class="identifier">Type</span> <span class="parameter">keyType</span>,
	<span class="identifier">Type</span> <span class="parameter">valueType</span>
)</pre></div><div id="IDAB_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Function</span> <span class="identifier">AddMapField</span> ( 
	<span class="parameter">fieldName</span> <span class="keyword">As</span> <span class="identifier">String</span>,
	<span class="parameter">keyType</span> <span class="keyword">As</span> <span class="identifier">Type</span>,
	<span class="parameter">valueType</span> <span class="keyword">As</span> <span class="identifier">Type</span>
) <span class="keyword">As</span> <span class="identifier">FieldBuilder</span></pre></div><div id="IDAB_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="identifier">FieldBuilder</span>^ <span class="identifier">AddMapField</span>(
	<span class="identifier">String</span>^ <span class="parameter">fieldName</span>, 
	<span class="identifier">Type</span>^ <span class="parameter">keyType</span>, 
	<span class="identifier">Type</span>^ <span class="parameter">valueType</span>
)</pre></div><div id="IDAB_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">member</span> <span class="identifier">AddMapField</span> : 
        <span class="parameter">fieldName</span> : <span class="identifier">string</span> * 
        <span class="parameter">keyType</span> : <span class="identifier">Type</span> * 
        <span class="parameter">valueType</span> : <span class="identifier">Type</span> <span class="keyword">-&gt;</span> <span class="identifier">FieldBuilder</span> </pre></div></div></div><h4>Parameters</h4><dl><dt class="has-text-weight-normal"><span class="parameter">fieldName</span>  <a href="https://learn.microsoft.com/dotnet/api/system.string" target="_blank" rel="noopener noreferrer">String</a></dt><dd>
   The name of the new field.
</dd><dt class="has-text-weight-normal"><span class="parameter">keyType</span>  <a href="https://learn.microsoft.com/dotnet/api/system.type" target="_blank" rel="noopener noreferrer">Type</a></dt><dd>
   The type of the keys for the new field.
</dd><dt class="has-text-weight-normal"><span class="parameter">valueType</span>  <a href="https://learn.microsoft.com/dotnet/api/system.type" target="_blank" rel="noopener noreferrer">Type</a></dt><dd>
   The type of the values for the new field.
</dd></dl><h4>Return Value</h4><a href="13cd8e7c-acc8-af6e-0ae6-a9b77fcd913c.htm">FieldBuilder</a><br />
   The FieldBuilder object may be used to add more details to the field. Make sure to set
   the unit type if the field contains floating-point values.
</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDGC')" onkeypress="SectionExpandCollapse_CheckKey('IDGC', event)" tabindex="0"><img id="IDGCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Exceptions</span></div><div id="IDGCSection" class="collapsibleSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="2e6e4206-97a8-dd4b-df5d-4269f4bb6088.htm">ArgumentException</a></td><td>
   The parameter fieldName is not acceptable for naming Extensible Storage objects.
   -or-
   The field type is not supported.
</td></tr><tr><td><a href="631e1424-60f4-929b-4e52-dda9dcd26316.htm">ArgumentNullException</a></td><td>
   A non-optional argument was null
</td></tr><tr><td><a href="05972c68-fa6d-3a83-d720-ad84fbc4780f.htm">ArgumentsInconsistentException</a></td><td>
   The combination of key and value types is not supported.
</td></tr><tr><td><a href="9e715f03-3884-e539-4dd6-8d7545733adc.htm">InvalidOperationException</a></td><td>
   The SchemaBuilder has already finished building the Schema.
</td></tr></table></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDBC')" onkeypress="SectionExpandCollapse_CheckKey('IDBC', event)" tabindex="0"><img id="IDBCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="IDBCSection" class="collapsibleSection">
   The supported types for the keys are Boolean, Byte, Int16, Int32, Int64, ElementId,
   GUID and String. Floating-point types (Float, Double, XYZ and UV) are not supported
   because round-off errors frequently cause numeric instability. Subentities are not
   supported because they require a custom comparison operator. The suggested workarounds
   are either placing key values into an Array and using array indices for keys, or
   just using an Array of subentities.

   Natural comparison of contained types is used for sorting.

   The supported types for values are the same as for simple fields.
   See <a href="5de0ea30-a58e-4db2-373c-05222a139465.htm">AddSimpleField(String, Type)</a> for details.
   <p>Note that a schema may contain a maximum of 256 fields.</p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Reference</h4><div><a href="e74f9357-cc3c-558e-73b8-38ce6d247869.htm">SchemaBuilder Class</a></div><div><a href="79486a74-376c-9555-c873-45d5a750f051.htm">Autodesk.Revit.DB.ExtensibleStorage Namespace</a></div></div></div></div>
        </div></body></html>