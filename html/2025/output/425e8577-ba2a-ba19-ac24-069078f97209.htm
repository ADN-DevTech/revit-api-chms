<html><head><title>FamilyItemFactory.NewExtrusion Method</title><meta name="Title" content="NewExtrusion Method" /><meta name="Microsoft.Help.Id" content="M:Autodesk.Revit.Creation.FamilyItemFactory.NewExtrusion(System.Boolean,Autodesk.Revit.DB.CurveArrArray,Autodesk.Revit.DB.SketchPlane,System.Double)" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="System.Keywords" content="FamilyItemFactory.NewExtrusion method" /><meta name="System.Keywords" content="NewExtrusion method" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.Creation.FamilyItemFactory.NewExtrusion" /><meta name="Microsoft.Help.F1" content="FamilyItemFactory.NewExtrusion" /><meta name="Microsoft.Help.F1" content="NewExtrusion" /><meta name="container" content="Autodesk.Revit.Creation" /><meta name="file" content="425e8577-ba2a-ba19-ac24-069078f97209" /><meta name="guid" content="425e8577-ba2a-ba19-ac24-069078f97209" /><meta name="Microsoft.Help.Category" content="CSharp" /><meta name="Microsoft.Help.Category" content="VB" /><meta name="Description" content="Add a new Extrusion instance into the Autodesk Revit family document." /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /></head><body onload="SetDefaultLanguage('cs');"><div class="pageBody"><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Family<wbr />Item<wbr />Factory<span id="LSTA76B1B7E_0" data-languageSpecificText="cpp=::|nu=."></span>New<wbr />Extrusion Method</h1></td></tr></table><div class="summary">Add a new Extrusion instance into the Autodesk Revit family document.</div><br /><strong>Namespace:</strong> <a href="ded320da-058a-4edd-0418-0582389559a7.htm">Autodesk.Revit.Creation</a><br /><strong>Assembly:</strong> RevitAPI (in RevitAPI.dll) Version: 25.0.0.0 (25.0.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDB')" onkeypress="SectionExpandCollapse_CheckKey('IDB', event)" tabindex="0"><img id="IDBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="IDBSection" class="collapsibleSection"><div id="IDAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAB_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cs','1','4');return false;">C#</a></div><div id="IDAB_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','vb','2','4');return false;">VB</a></div><div id="IDAB_tab3" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cpp','3','4');return false;">C++</a></div><div id="IDAB_tab4" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAB');return false;" title="Copy">Copy</a></div></div><div id="IDAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="identifier">Extrusion</span> <span class="identifier">NewExtrusion</span>(
	<span class="identifier">bool</span> <span class="parameter">isSolid</span>,
	<span class="identifier">CurveArrArray</span> <span class="parameter">profile</span>,
	<span class="identifier">SketchPlane</span> <span class="parameter">sketchPlane</span>,
	<span class="identifier">double</span> <span class="parameter">end</span>
)</pre></div><div id="IDAB_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Function</span> <span class="identifier">NewExtrusion</span> ( 
	<span class="parameter">isSolid</span> <span class="keyword">As</span> <span class="identifier">Boolean</span>,
	<span class="parameter">profile</span> <span class="keyword">As</span> <span class="identifier">CurveArrArray</span>,
	<span class="parameter">sketchPlane</span> <span class="keyword">As</span> <span class="identifier">SketchPlane</span>,
	<span class="parameter">end</span> <span class="keyword">As</span> <span class="identifier">Double</span>
) <span class="keyword">As</span> <span class="identifier">Extrusion</span></pre></div><div id="IDAB_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="identifier">Extrusion</span>^ <span class="identifier">NewExtrusion</span>(
	<span class="identifier">bool</span> <span class="parameter">isSolid</span>, 
	<span class="identifier">CurveArrArray</span>^ <span class="parameter">profile</span>, 
	<span class="identifier">SketchPlane</span>^ <span class="parameter">sketchPlane</span>, 
	<span class="identifier">double</span> <span class="parameter">end</span>
)</pre></div><div id="IDAB_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">member</span> <span class="identifier">NewExtrusion</span> : 
        <span class="parameter">isSolid</span> : <span class="identifier">bool</span> * 
        <span class="parameter">profile</span> : <span class="identifier">CurveArrArray</span> * 
        <span class="parameter">sketchPlane</span> : <span class="identifier">SketchPlane</span> * 
        <span class="parameter">end</span> : <span class="identifier">float</span> <span class="keyword">-&gt;</span> <span class="identifier">Extrusion</span> </pre></div></div></div><h4>Parameters</h4><dl><dt class="has-text-weight-normal"><span class="parameter">isSolid</span>  <a href="https://learn.microsoft.com/dotnet/api/system.boolean" target="_blank" rel="noopener noreferrer">Boolean</a></dt><dd>Indicates if the Extrusion is Solid or Void.</dd><dt class="has-text-weight-normal"><span class="parameter">profile</span>  <a href="c9d071fe-9724-42ed-e280-57381cd44301.htm">CurveArrArray</a></dt><dd>The profile of the newly created Extrusion. This may contain more 
than one curve loop. Each loop must be a fully closed curve loop and the loops may not 
intersect. All input curves must lie in the same plane.
The loop can be a unbound circle or ellipse,  but its geometry will be split in two in 
order to satisfy requirements for sketches used in extrusions.</dd><dt class="has-text-weight-normal"><span class="parameter">sketchPlane</span>  <a href="ba104029-d175-7e75-caef-667a4281f4af.htm">SketchPlane</a></dt><dd>The sketch plane for the extrusion.  The direction of extrusion
is determined by the normal for the sketch plane.  To extrude in the other direction set 
the end value to negative.</dd><dt class="has-text-weight-normal"><span class="parameter">end</span>  <a href="https://learn.microsoft.com/dotnet/api/system.double" target="_blank" rel="noopener noreferrer">Double</a></dt><dd>The length of the extrusion.</dd></dl><h4>Return Value</h4><a href="1d8cca8f-0ef5-0cb6-a33b-f044b968cd89.htm">Extrusion</a><br />If creation was successful the new Extrusion is returned, 
otherwise an exception with failure information will be thrown.</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDHC')" onkeypress="SectionExpandCollapse_CheckKey('IDHC', event)" tabindex="0"><img id="IDHCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Exceptions</span></div><div id="IDHCSection" class="collapsibleSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="2e6e4206-97a8-dd4b-df5d-4269f4bb6088.htm">ArgumentException</a></td><td>
Thrown when the input argument-profile-is <span class="keyword"><span id="LSTA76B1B7E_1" data-languageSpecificText="cpp=nullptr|vb=Nothing|nu=null"></span></span> or empty array.
</td></tr><tr><td><a href="631e1424-60f4-929b-4e52-dda9dcd26316.htm">ArgumentNullException</a></td><td>
Thrown when the input argument-sketchPlane-is <span class="keyword"><span id="LSTA76B1B7E_2" data-languageSpecificText="cpp=nullptr|vb=Nothing|nu=null"></span></span>.
</td></tr><tr><td><a href="2e6e4206-97a8-dd4b-df5d-4269f4bb6088.htm">ArgumentException</a></td><td>
Thrown when the input argument-sketchPlane-is an invalid sketch plane.
</td></tr><tr><td><a href="9e715f03-3884-e539-4dd6-8d7545733adc.htm">InvalidOperationException</a></td><td>
Thrown when the creation failed.
</td></tr></table></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDGC')" onkeypress="SectionExpandCollapse_CheckKey('IDGC', event)" tabindex="0"><img id="IDGCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="IDGCSection" class="collapsibleSection">This method creates an extrusion in a family document. The extrusion will be 
extended perpendicular to the sketch plane of the extrusion profile. </div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDLC')" onkeypress="SectionExpandCollapse_CheckKey('IDLC', event)" tabindex="0"><img id="IDLCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Example</span></div><div id="IDLCSection" class="collapsibleSection"><div id="IDALC" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDALC_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDALC','cs','1','4');return false;">C#</a></div><div id="IDALC_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDALC','vb','2','4');return false;">VB</a></div><div id="IDALC_tab3" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDALC','cpp','3','4');return false;">C++</a></div><div id="IDALC_tab4" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDALC','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDALC_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDALC');return false;" title="Copy">Copy</a></div></div><div id="IDALC_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">private</span> Extrusion CreateExtrusion(Autodesk.Revit.DB.Document document, SketchPlane sketchPlane)
{
    Extrusion rectExtrusion = <span class="highlight-keyword">null</span>;

    <span class="highlight-comment">// make sure we have a family document</span>
    <span class="highlight-keyword">if</span> (<span class="highlight-keyword">true</span> == document.IsFamilyDocument)
    {
        <span class="highlight-comment">// define the profile for the extrusion</span>
        CurveArrArray curveArrArray = <span class="highlight-keyword">new</span> CurveArrArray();
        CurveArray curveArray1 = <span class="highlight-keyword">new</span> CurveArray();
        CurveArray curveArray2 = <span class="highlight-keyword">new</span> CurveArray();
        CurveArray curveArray3 = <span class="highlight-keyword">new</span> CurveArray();

        <span class="highlight-comment">// create a rectangular profile</span>
        XYZ p0 = XYZ.Zero;
        XYZ p1 = <span class="highlight-keyword">new</span> XYZ(<span class="highlight-number">10</span>, <span class="highlight-number">0</span>, <span class="highlight-number">0</span>);
        XYZ p2 = <span class="highlight-keyword">new</span> XYZ(<span class="highlight-number">10</span>, <span class="highlight-number">10</span>, <span class="highlight-number">0</span>);
        XYZ p3 = <span class="highlight-keyword">new</span> XYZ(<span class="highlight-number">0</span>, <span class="highlight-number">10</span>, <span class="highlight-number">0</span>);
        Line line1 = Line.CreateBound(p0, p1);
        Line line2 = Line.CreateBound(p1, p2);
        Line line3 = Line.CreateBound(p2, p3);
        Line line4 = Line.CreateBound(p3, p0);
        curveArray1.Append(line1);
        curveArray1.Append(line2);
        curveArray1.Append(line3);
        curveArray1.Append(line4);

        curveArrArray.Append(curveArray1);

        <span class="highlight-comment">// create solid rectangular extrusion</span>
        rectExtrusion = document.FamilyCreate.NewExtrusion(<span class="highlight-keyword">true</span>, curveArrArray, sketchPlane, <span class="highlight-number">10</span>);

        <span class="highlight-keyword">if</span> (<span class="highlight-keyword">null</span> != rectExtrusion)
        {
            <span class="highlight-comment">// move extrusion to proper place</span>
            XYZ transPoint1 = <span class="highlight-keyword">new</span> XYZ(<span class="highlight-number">-16</span>, <span class="highlight-number">0</span>, <span class="highlight-number">0</span>);
            ElementTransformUtils.MoveElement(document, rectExtrusion.Id, transPoint1);
        }
        <span class="highlight-keyword">else</span>
        {
            <span class="highlight-keyword">throw</span> <span class="highlight-keyword">new</span> Exception(<span class="highlight-literal">"Create new Extrusion failed."</span>);
        }
    }
    <span class="highlight-keyword">else</span>
    {
        <span class="highlight-keyword">throw</span> <span class="highlight-keyword">new</span> Exception(<span class="highlight-literal">"Please open a Family document before invoking this command."</span>);
    }

    <span class="highlight-keyword">return</span> rectExtrusion;
}</pre></div><div id="IDALC_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="highlight-keyword">Private</span> <span class="highlight-keyword">Function</span> CreateExtrusion(document <span class="highlight-keyword">As</span> Autodesk.Revit.DB.Document, sketchPlane <span class="highlight-keyword">As</span> SketchPlane) <span class="highlight-keyword">As</span> Extrusion
    <span class="highlight-keyword">Dim</span> rectExtrusion <span class="highlight-keyword">As</span> Extrusion = <span class="highlight-keyword">Nothing</span>

    <span class="highlight-comment">' make sure we have a family document</span>
    <span class="highlight-keyword">If</span> <span class="highlight-keyword">True</span> = document.IsFamilyDocument <span class="highlight-keyword">Then</span>
        <span class="highlight-comment">' define the profile for the extrusion</span>
        <span class="highlight-keyword">Dim</span> curveArrArray <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> CurveArrArray()
        <span class="highlight-keyword">Dim</span> curveArray1 <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> CurveArray()
        <span class="highlight-keyword">Dim</span> curveArray2 <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> CurveArray()
        <span class="highlight-keyword">Dim</span> curveArray3 <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> CurveArray()

        <span class="highlight-comment">' create a rectangular profile</span>
        <span class="highlight-keyword">Dim</span> p0 <span class="highlight-keyword">As</span> XYZ = XYZ.Zero
        <span class="highlight-keyword">Dim</span> p1 <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> XYZ(<span class="highlight-number">10</span>, <span class="highlight-number">0</span>, <span class="highlight-number">0</span>)
        <span class="highlight-keyword">Dim</span> p2 <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> XYZ(<span class="highlight-number">10</span>, <span class="highlight-number">10</span>, <span class="highlight-number">0</span>)
        <span class="highlight-keyword">Dim</span> p3 <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> XYZ(<span class="highlight-number">0</span>, <span class="highlight-number">10</span>, <span class="highlight-number">0</span>)
        <span class="highlight-keyword">Dim</span> line1 <span class="highlight-keyword">As</span> Line = Line.CreateBound(p0, p1)
        <span class="highlight-keyword">Dim</span> line2 <span class="highlight-keyword">As</span> Line = Line.CreateBound(p1, p2)
        <span class="highlight-keyword">Dim</span> line3 <span class="highlight-keyword">As</span> Line = Line.CreateBound(p2, p3)
        <span class="highlight-keyword">Dim</span> line4 <span class="highlight-keyword">As</span> Line = Line.CreateBound(p3, p0)
        curveArray1.Append(line1)
        curveArray1.Append(line2)
        curveArray1.Append(line3)
        curveArray1.Append(line4)

        curveArrArray.Append(curveArray1)

        <span class="highlight-comment">' create solid rectangular extrusion</span>
        rectExtrusion = document.FamilyCreate.NewExtrusion(<span class="highlight-keyword">True</span>, curveArrArray, sketchPlane, <span class="highlight-number">10</span>)

        <span class="highlight-keyword">If</span> rectExtrusion <span class="highlight-keyword">IsNot</span> <span class="highlight-keyword">Nothing</span> <span class="highlight-keyword">Then</span>
            <span class="highlight-comment">' move extrusion to proper place</span>
            <span class="highlight-keyword">Dim</span> transPoint1 <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> XYZ(<span class="highlight-number">-16</span>, <span class="highlight-number">0</span>, <span class="highlight-number">0</span>)
            ElementTransformUtils.MoveElement(document, rectExtrusion.Id, transPoint1)
        <span class="highlight-keyword">Else</span>
            <span class="highlight-keyword">Throw</span> <span class="highlight-keyword">New</span> Exception(<span class="highlight-literal">"Create new Extrusion failed."</span>)
        <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
    <span class="highlight-keyword">Else</span>
        <span class="highlight-keyword">Throw</span> <span class="highlight-keyword">New</span> Exception(<span class="highlight-literal">"Please open a Family document before invoking this command."</span>)
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>

    <span class="highlight-keyword">Return</span> rectExtrusion
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Function</span></pre></div><div id="IDALC_code_Div3" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div><div id="IDALC_code_Div4" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div></div></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Reference</h4><div><a href="a7622967-1381-c17f-ed04-1ebe40da0440.htm">FamilyItemFactory Class</a></div><div><a href="ded320da-058a-4edd-0418-0582389559a7.htm">Autodesk.Revit.Creation Namespace</a></div></div></div></div>
        </div></body></html>