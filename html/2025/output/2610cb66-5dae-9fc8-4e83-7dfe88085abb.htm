<html><head><title>ViewCropRegionShapeManager Class</title><meta name="Title" content="ViewCropRegionShapeManager Class" /><meta name="Microsoft.Help.Id" content="T:Autodesk.Revit.DB.ViewCropRegionShapeManager" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="System.Keywords" content="Autodesk.Revit.DB.ViewCropRegionShapeManager class" /><meta name="System.Keywords" content="ViewCropRegionShapeManager class" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.DB.ViewCropRegionShapeManager" /><meta name="Microsoft.Help.F1" content="ViewCropRegionShapeManager" /><meta name="container" content="Autodesk.Revit.DB" /><meta name="file" content="2610cb66-5dae-9fc8-4e83-7dfe88085abb" /><meta name="guid" content="2610cb66-5dae-9fc8-4e83-7dfe88085abb" /><meta name="Microsoft.Help.Category" content="CSharp" /><meta name="Microsoft.Help.Category" content="VB" /><meta name="Description" content="A class that provides access to settings related to the crop assigned to a view or a reference callout." /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /></head><body onload="SetDefaultLanguage('cs');"><div class="pageBody"><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>View<wbr />Crop<wbr />Region<wbr />Shape<wbr />Manager Class</h1></td></tr></table><div class="summary">
   A class that provides access to settings related to the crop assigned to a view or a reference callout.
</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDDA')" onkeypress="SectionExpandCollapse_CheckKey('IDDA', event)" tabindex="0"><img id="IDDAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Inheritance Hierarchy</span></div><div id="IDDASection" class="collapsibleSection"><a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">System<span id="LSTFA9C82A6_0" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>Object</a><br />  <span class="selflink">Autodesk.Revit.DB<span id="LSTFA9C82A6_1" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>ViewCropRegionShapeManager</span><br /></div><br /><strong>Namespace:</strong> <a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB</a><br /><strong>Assembly:</strong> RevitAPI (in RevitAPI.dll) Version: 25.0.0.0 (25.0.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDB')" onkeypress="SectionExpandCollapse_CheckKey('IDB', event)" tabindex="0"><img id="IDBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="IDBSection" class="collapsibleSection"><div id="IDAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAB_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cs','1','4');return false;">C#</a></div><div id="IDAB_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','vb','2','4');return false;">VB</a></div><div id="IDAB_tab3" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cpp','3','4');return false;">C++</a></div><div id="IDAB_tab4" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAB');return false;" title="Copy">Copy</a></div></div><div id="IDAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">class</span> <span class="identifier">ViewCropRegionShapeManager</span> : <span class="identifier">IDisposable</span></pre></div><div id="IDAB_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Class</span> <span class="identifier">ViewCropRegionShapeManager</span>
	<span class="keyword">Implements</span> <span class="identifier">IDisposable</span></pre></div><div id="IDAB_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">ref class</span> <span class="identifier">ViewCropRegionShapeManager</span> : <span class="identifier">IDisposable</span></pre></div><div id="IDAB_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">type</span> <span class="identifier">ViewCropRegionShapeManager</span> = 
    <span class="keyword">class</span>
        <span class="keyword">interface</span> <span class="identifier">IDisposable</span>
    <span class="keyword">end</span></pre></div></div></div></div><p>The <span class="selflink">ViewCropRegionShapeManager</span> type exposes the following members.</p><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDRFA')" onkeypress="SectionExpandCollapse_CheckKey('IDRFA', event)" tabindex="0"><img id="IDRFAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Properties</span></div><div id="IDRFASection" class="collapsibleSection"><table id="PropertyList" class="members"><tr><th class="iconColumn"> </th><th>Name</th><th>Description</th></tr><tr><td><img src="../icons/pubProperty.gif" alt="Public property" title="Public property" /></td><td><a href="052f9969-ce4e-40c5-8573-30c4db60a25f.htm">BottomAnnotationCropOffset</a></td><td>
   The offset from the bottom of the view crop that determines the location of the annotation crop bottom boundary.
</td></tr><tr><td><img src="../icons/pubProperty.gif" alt="Public property" title="Public property" /></td><td><a href="1fc2640b-6c4a-2d85-39a7-2b50f3377145.htm">CanBeSplit</a></td><td>
   Verifies that the crop of the associated view is permitted to have multiple regions.
</td></tr><tr><td><img src="../icons/pubProperty.gif" alt="Public property" title="Public property" /></td><td><a href="4ed706b0-ed41-3cba-aae5-d75d816b2ae1.htm">CanHaveAnnotationCrop</a></td><td>
   Verifies that the view is allowed to have an annotation crop.
</td></tr><tr><td><img src="../icons/pubProperty.gif" alt="Public property" title="Public property" /></td><td><a href="4ed96171-c8ac-1623-f1d3-5da38d1bd834.htm">CanHaveShape</a></td><td>
   Verifies that the crop of the associated view is permitted to have a non-rectangular shape.
</td></tr><tr><td><img src="../icons/pubProperty.gif" alt="Public property" title="Public property" /></td><td><a href="a78e3cd6-58b3-faa0-6e10-02c22fe3bc99.htm">IsSplitHorizontally</a></td><td>
   Whether or not the view's crop is split (and the split is horizontal).
</td></tr><tr><td><img src="../icons/pubProperty.gif" alt="Public property" title="Public property" /></td><td><a href="4831f9a4-f3c1-0d83-8387-66618485baa1.htm">IsSplitVertically</a></td><td>
   Whether or not the view's crop is split (and the split is vertical).
</td></tr><tr><td><img src="../icons/pubProperty.gif" alt="Public property" title="Public property" /></td><td><a href="ff38ac8e-6b3b-f9a4-6a26-2669eb661361.htm">IsValidObject</a></td><td>
   Specifies whether the .NET object represents a valid Revit entity.
</td></tr><tr><td><img src="../icons/pubProperty.gif" alt="Public property" title="Public property" /></td><td><a href="c1df4fe4-5897-2f90-405d-4a05542179e0.htm">LeftAnnotationCropOffset</a></td><td>
   The offset from the left of the view crop that determines the location of the annotation crop left boundary.
</td></tr><tr><td><img src="../icons/pubProperty.gif" alt="Public property" title="Public property" /></td><td><a href="2d533b30-7190-442d-1c8b-f436e526c40c.htm">NumberOfSplitRegions</a></td><td>
   The number of split crop regions (1 if the crop is not currently split).
</td></tr><tr><td><img src="../icons/pubProperty.gif" alt="Public property" title="Public property" /></td><td><a href="3858d0de-caaa-8e31-545c-8c0a3c8fb0f2.htm">RightAnnotationCropOffset</a></td><td>
   The offset from the right of the view crop that determines the location of the annotation crop right boundary.
</td></tr><tr><td><img src="../icons/pubProperty.gif" alt="Public property" title="Public property" /></td><td><a href="4e4ddc06-f889-b955-a22d-c870c00526cc.htm">ShapeSet</a></td><td>
   Whether or not the view crop has a non-rectangular shape set.
</td></tr><tr><td><img src="../icons/pubProperty.gif" alt="Public property" title="Public property" /></td><td><a href="9fb6ad28-2917-3194-9b71-8fed8461d22b.htm">Split</a></td><td>
   Whether or not the view crop is split.
</td></tr><tr><td><img src="../icons/pubProperty.gif" alt="Public property" title="Public property" /></td><td><a href="b2dce097-7b29-4a40-3b06-cac4cbc49081.htm">TopAnnotationCropOffset</a></td><td>
   The offset from the top of the view crop that determines the location of the annotation crop top boundary.
</td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDAFA')" onkeypress="SectionExpandCollapse_CheckKey('IDAFA', event)" tabindex="0"><img id="IDAFAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Methods</span></div><div id="IDAFASection" class="collapsibleSection"><table id="MethodList" class="members"><tr><th class="iconColumn"> </th><th>Name</th><th>Description</th></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="7c0d13f8-0263-d113-c4cf-20cb62693001.htm">Dispose</a></td><td>Releases all resources used by the <span class="selflink">ViewCropRegionShapeManager</span></td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)" target="_blank" rel="noopener noreferrer">Equals</a></td><td>Determines whether the specified object is equal to the current object.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="4e698377-7527-c562-21bc-379c68efda5d.htm">GetAnnotationCropShape</a></td><td>
   Gets the annotation crop box assigned to the view.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="36a98b08-72be-4b0a-99f6-4a765b85b15d.htm">GetCropShape</a></td><td>
   Gets the crop boundaries that are curently active.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode#system-object-gethashcode" target="_blank" rel="noopener noreferrer">GetHashCode</a></td><td>Serves as the default hash function.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="fe2685d5-c8c3-eb61-d4d0-3fcdd48820ed.htm">GetSplitRegionMaximum</a></td><td>
   Returns the proportional location of the maximum boundary of the specified split crop region.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="62230272-ac48-3856-91a3-d5c6aa2ec031.htm">GetSplitRegionMinimum</a></td><td>
   Returns the proportional location of the minimum boundary of the specified split crop region.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="f2df4fe9-0771-4ee0-e000-d0d2b11ea35f.htm">GetSplitRegionOffset</a></td><td>
   Returns the offset for the specified split crop region.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.gettype#system-object-gettype" target="_blank" rel="noopener noreferrer">GetType</a></td><td>Gets the <a href="https://learn.microsoft.com/dotnet/api/system.type" target="_blank" rel="noopener noreferrer">Type</a> of the current instance.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="e9d91a49-9d33-f1d5-a197-e1bf33a17265.htm">IsCropRegionShapeValid</a></td><td>
   Verifies that boundary represents one closed curve loop without self-intersections,
   consisting of non-zero length straight lines in a plane parallel to the view plane.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="f72964d5-5b22-0d77-2fe0-0c127546d879.htm">RemoveCropRegionShape</a></td><td>
   Removes any non-rectangular boundary of the view's crop.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="7b04c647-cb12-3189-eb56-2251ba46d99b.htm">RemoveSplit</a></td><td>
   Removes any split applied to the view's crop.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="c750ce39-d497-7cab-028b-4da0e0ce3c91.htm">RemoveSplitRegion</a></td><td>
   Removes one region in split crop.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="548c4181-2779-40a2-8276-b7a43a85a161.htm">SetCropShape</a></td><td>
   Sets the boundary of the view's crop to the specified shape.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="081c29af-0877-a5ce-bb49-e39ba262a43f.htm">SplitRegionHorizontally</a></td><td>
   Splits horizontally one region in split crop.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="583d354f-9950-5bcd-23e0-69c15ee69a50.htm">SplitRegionVertically</a></td><td>
   Splits vertically one region in split crop.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.tostring#system-object-tostring" target="_blank" rel="noopener noreferrer">ToString</a></td><td>Returns a string that represents the current object.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDBC')" onkeypress="SectionExpandCollapse_CheckKey('IDBC', event)" tabindex="0"><img id="IDBCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="IDBCSection" class="collapsibleSection"><p>
   This class manages all the settings that make up the model and annotation crop geometry for a given view or reference callout.
   You can obtain the settings for a view from <a href="e2f53728-9b72-227a-f585-9dccf6d79d9f.htm">GetCropRegionShapeManager<span id="LSTFA9C82A6_2" data-languageSpecificText="cs=()|vb=|cpp=()|nu=()|fs=()"></span></a>.
   Obtain the settings for a reference callout from <a href="248f20e0-9735-5733-2c8a-6b871bb17d3b.htm">GetCropRegionShapeManagerForReferenceCallout(Document, ElementId)</a>.
   </p><p>
   The model crop region crops model elements, detail elements (such as insulation and detail lines), section boxes,
   and scope boxes at the model crop boundary.
   Visible crop boundaries of other related views are also cropped at the model crop boundary.
   The model crop region can be set as a polygonal boundary, a rectangular boundary,
   or rectangular boundary with one or more splits applied either horizontally or vertically.
   If a split is applied to the rectangular crop each resulting rectangular region is identified by a region index and occupies
   a percentage of the original crop rectangle. The regions may possibly be moved relative to one another.
   </p><p>
   The annotation crop region fully crops annotation elements when it touches any portion of the annotation element,
   so that no partial annotations are drawn.
   Annotations (such as symbols, tags, keynotes, and dimensions) that reference hidden or cropped model elements do not display in the view,
   even if they are inside the annotation crop region.
   The annotation crop region is always rectangular and at minimum occupies the same area as the rectangular model crop
   (or the corresponding rectangular boundary around the non-rectangular model crop),
   but can be offset to be bigger than the model crop in order to display more annotations.
   </p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDDC')" onkeypress="SectionExpandCollapse_CheckKey('IDDC', event)" tabindex="0"><img id="IDDCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Example</span></div><div id="IDDCSection" class="collapsibleSection"><div id="IDADC" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDADC_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDADC','cs','1','4');return false;">C#</a></div><div id="IDADC_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDADC','vb','2','4');return false;">VB</a></div><div id="IDADC_tab3" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDADC','cpp','3','4');return false;">C++</a></div><div id="IDADC_tab4" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDADC','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDADC_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDADC');return false;" title="Copy">Copy</a></div></div><div id="IDADC_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">public</span> <span class="highlight-keyword">void</span> CropAroundRoom(Room room, View view)
{
    <span class="highlight-keyword">if</span> (view != <span class="highlight-keyword">null</span>)
    {
        IList&lt;IList&lt;Autodesk.Revit.DB.BoundarySegment&gt;&gt; segments = room.GetBoundarySegments(<span class="highlight-keyword">new</span> SpatialElementBoundaryOptions());

        <span class="highlight-keyword">if</span> (<span class="highlight-keyword">null</span> != segments)  <span class="highlight-comment">//the room may not be bound</span>
        {
            <span class="highlight-keyword">foreach</span> (IList&lt;Autodesk.Revit.DB.BoundarySegment&gt; segmentList <span class="highlight-keyword">in</span> segments)
            {
                CurveLoop loop = <span class="highlight-keyword">new</span> CurveLoop();
                <span class="highlight-keyword">foreach</span> (Autodesk.Revit.DB.BoundarySegment boundarySegment <span class="highlight-keyword">in</span> segmentList)
                {
                    loop.Append(boundarySegment.GetCurve());
                }

                ViewCropRegionShapeManager vcrShapeMgr = view.GetCropRegionShapeManager();
                vcrShapeMgr.SetCropShape(loop);
                <span class="highlight-keyword">break</span>;  <span class="highlight-comment">// if more than one set of boundary segments for room, crop around the first one</span>
            }
        }
    }
}</pre></div><div id="IDADC_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="highlight-keyword">Public</span> <span class="highlight-keyword">Sub</span> CropAroundRoom(room <span class="highlight-keyword">As</span> Room, view <span class="highlight-keyword">As</span> View)
    <span class="highlight-keyword">If</span> view <span class="highlight-keyword">IsNot</span> <span class="highlight-keyword">Nothing</span> <span class="highlight-keyword">Then</span>
        <span class="highlight-keyword">Dim</span> segments <span class="highlight-keyword">As</span> IList(<span class="highlight-keyword">Of</span> IList(<span class="highlight-keyword">Of</span> Autodesk.Revit.DB.BoundarySegment)) = room.GetBoundarySegments(<span class="highlight-keyword">New</span> SpatialElementBoundaryOptions())

        <span class="highlight-keyword">If</span> segments <span class="highlight-keyword">IsNot</span> <span class="highlight-keyword">Nothing</span> <span class="highlight-keyword">Then</span>
            <span class="highlight-comment">'the room may not be bound</span>
            <span class="highlight-keyword">For</span> <span class="highlight-keyword">Each</span> segmentList <span class="highlight-keyword">As</span> IList(<span class="highlight-keyword">Of</span> Autodesk.Revit.DB.BoundarySegment) <span class="highlight-keyword">In</span> segments
                <span class="highlight-keyword">Dim</span> [<span class="highlight-keyword">loop</span>] <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> CurveLoop()
                <span class="highlight-keyword">For</span> <span class="highlight-keyword">Each</span> boundarySegment <span class="highlight-keyword">As</span> Autodesk.Revit.DB.BoundarySegment <span class="highlight-keyword">In</span> segmentList
                    [<span class="highlight-keyword">loop</span>].Append(boundarySegment.GetCurve())
                <span class="highlight-keyword">Next</span>

                <span class="highlight-keyword">Dim</span> vcrShapeMgr <span class="highlight-keyword">As</span> ViewCropRegionShapeManager = view.GetCropRegionShapeManager()
                vcrShapeMgr.SetCropShape([<span class="highlight-keyword">loop</span>])
                    <span class="highlight-comment">' if more than one set of boundary segments for room, crop around the first one</span>
                <span class="highlight-keyword">Exit</span> <span class="highlight-keyword">For</span>
            <span class="highlight-keyword">Next</span>
        <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span></pre></div><div id="IDADC_code_Div3" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div><div id="IDADC_code_Div4" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div></div></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Reference</h4><div><a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB Namespace</a></div></div></div></div>
        </div></body></html>