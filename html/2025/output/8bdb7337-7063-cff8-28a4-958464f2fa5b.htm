<html><head><title>ItemFactoryBase.NewGroup Method</title><meta name="Title" content="NewGroup Method" /><meta name="Microsoft.Help.Id" content="M:Autodesk.Revit.Creation.ItemFactoryBase.NewGroup(System.Collections.Generic.ICollection{Autodesk.Revit.DB.ElementId})" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="System.Keywords" content="ItemFactoryBase.NewGroup method" /><meta name="System.Keywords" content="NewGroup method" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.Creation.ItemFactoryBase.NewGroup" /><meta name="Microsoft.Help.F1" content="ItemFactoryBase.NewGroup" /><meta name="Microsoft.Help.F1" content="NewGroup" /><meta name="container" content="Autodesk.Revit.Creation" /><meta name="file" content="8bdb7337-7063-cff8-28a4-958464f2fa5b" /><meta name="guid" content="8bdb7337-7063-cff8-28a4-958464f2fa5b" /><meta name="Microsoft.Help.Category" content="CSharp" /><meta name="Microsoft.Help.Category" content="VB" /><meta name="Description" content="Creates a new type of group." /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /></head><body onload="SetDefaultLanguage('cs');"><div class="pageBody"><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Item<wbr />Factory<wbr />Base<span id="LST3F466CDC_0" data-languageSpecificText="cpp=::|nu=."></span>New<wbr />Group Method</h1></td></tr></table><div class="summary">Creates a new type of group.</div><br /><strong>Namespace:</strong> <a href="ded320da-058a-4edd-0418-0582389559a7.htm">Autodesk.Revit.Creation</a><br /><strong>Assembly:</strong> RevitAPI (in RevitAPI.dll) Version: 25.0.0.0 (25.0.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDB')" onkeypress="SectionExpandCollapse_CheckKey('IDB', event)" tabindex="0"><img id="IDBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="IDBSection" class="collapsibleSection"><div id="IDAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAB_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cs','1','4');return false;">C#</a></div><div id="IDAB_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','vb','2','4');return false;">VB</a></div><div id="IDAB_tab3" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cpp','3','4');return false;">C++</a></div><div id="IDAB_tab4" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAB');return false;" title="Copy">Copy</a></div></div><div id="IDAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="identifier">Group</span> <span class="identifier">NewGroup</span>(
	<span class="identifier">ICollection</span>&lt;<span class="identifier">ElementId</span>&gt; <span class="parameter">elementIds</span>
)</pre></div><div id="IDAB_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Function</span> <span class="identifier">NewGroup</span> ( 
	<span class="parameter">elementIds</span> <span class="keyword">As</span> <span class="identifier">ICollection</span>(<span class="keyword">Of</span> <span class="identifier">ElementId</span>)
) <span class="keyword">As</span> <span class="identifier">Group</span></pre></div><div id="IDAB_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="identifier">Group</span>^ <span class="identifier">NewGroup</span>(
	<span class="identifier">ICollection</span>&lt;<span class="identifier">ElementId</span>^&gt;^ <span class="parameter">elementIds</span>
)</pre></div><div id="IDAB_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">member</span> <span class="identifier">NewGroup</span> : 
        <span class="parameter">elementIds</span> : <span class="identifier">ICollection</span>&lt;<span class="identifier">ElementId</span>&gt; <span class="keyword">-&gt;</span> <span class="identifier">Group</span> </pre></div></div></div><h4>Parameters</h4><dl><dt class="has-text-weight-normal"><span class="parameter">elementIds</span>  <a href="https://learn.microsoft.com/dotnet/api/system.collections.generic.icollection-1" target="_blank" rel="noopener noreferrer">ICollection</a><span id="LST3F466CDC_1" data-languageSpecificText="cpp=&lt;|cs=&lt;|fs=&lt;|vb=(Of |nu=("></span><a href="44f3f7b1-3229-3404-93c9-dc5e70337dd6.htm">ElementId</a><span id="LST3F466CDC_2" data-languageSpecificText="cpp=&gt;|cs=&gt;|fs=&gt;|vb=)|nu=)"></span></dt><dd>A set of elements which will be made into the new group.</dd></dl><h4>Return Value</h4><a href="ca54af3c-52d8-0aed-cd22-440ec2584b89.htm">Group</a><br />A new instance of a group containing the elements specified.</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDDC')" onkeypress="SectionExpandCollapse_CheckKey('IDDC', event)" tabindex="0"><img id="IDDCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="IDDCSection" class="collapsibleSection"><ul><li>The new group may contain more members than just the set input to this method.  Elements
which are closely connected with the inputs (such as sketch and sketch plane) will also be added to
the group.</li><li>Initially the group will have a generic name, such as Group 1. This can be changed by
changing the name of the group type as follows: <span class="code">newGroup.GroupType.Name = newName</span>.</li><li>If a newly-created element is being added to a group, calling document.Regenerate() may be needed to avoid
a warning visible in the UI that the group has changed outside group edit mode.</li></ul></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDEC')" onkeypress="SectionExpandCollapse_CheckKey('IDEC', event)" tabindex="0"><img id="IDECToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Example</span></div><div id="IDECSection" class="collapsibleSection"><div id="IDAEC" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAEC_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAEC','cs','1','4');return false;">C#</a></div><div id="IDAEC_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAEC','vb','2','4');return false;">VB</a></div><div id="IDAEC_tab3" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDAEC','cpp','3','4');return false;">C++</a></div><div id="IDAEC_tab4" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDAEC','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAEC_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAEC');return false;" title="Copy">Copy</a></div></div><div id="IDAEC_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">Group <span class="highlight-keyword">group</span> = <span class="highlight-keyword">null</span>;
UIDocument uidoc = <span class="highlight-keyword">new</span> UIDocument(document);
ICollection&lt;ElementId&gt; selectedIds = uidoc.Selection.GetElementIds();

<span class="highlight-keyword">if</span> (selectedIds.Count &gt; <span class="highlight-number">0</span>)
{
    <span class="highlight-comment">// Group all selected elements</span>
    <span class="highlight-keyword">group</span> = document.Create.NewGroup(selectedIds);

}</pre></div><div id="IDAEC_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="highlight-keyword">Dim</span> group <span class="highlight-keyword">As</span> Group = <span class="highlight-keyword">Nothing</span>
<span class="highlight-keyword">Dim</span> uidoc <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> UIDocument(document)
<span class="highlight-keyword">Dim</span> selectedIds <span class="highlight-keyword">As</span> ICollection(<span class="highlight-keyword">Of</span> ElementId) = uidoc.Selection.GetElementIds()

<span class="highlight-keyword">If</span> selectedIds.Count &gt; <span class="highlight-number">0</span> <span class="highlight-keyword">Then</span>
    <span class="highlight-comment">' Group all selected elements</span>

    group = document.Create.NewGroup(selectedIds)
<span class="highlight-keyword">Else</span></pre></div><div id="IDAEC_code_Div3" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div><div id="IDAEC_code_Div4" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div></div></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Reference</h4><div><a href="cba2c84a-22c0-e6e7-a99c-67656901853a.htm">ItemFactoryBase Class</a></div><div><a href="ded320da-058a-4edd-0418-0582389559a7.htm">Autodesk.Revit.Creation Namespace</a></div></div></div></div>
        </div></body></html>