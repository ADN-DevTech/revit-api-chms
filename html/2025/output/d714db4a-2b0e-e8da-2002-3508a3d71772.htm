<html><head><title>WorksharingDisplaySettings.RemoveUsers Method</title><meta name="Title" content="RemoveUsers Method" /><meta name="Microsoft.Help.Id" content="M:Autodesk.Revit.DB.WorksharingDisplaySettings.RemoveUsers(Autodesk.Revit.DB.Document,System.Collections.Generic.ICollection{System.String},System.Collections.Generic.ICollection{System.String}@)" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="System.Keywords" content="WorksharingDisplaySettings.RemoveUsers method" /><meta name="System.Keywords" content="RemoveUsers method" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.DB.WorksharingDisplaySettings.RemoveUsers" /><meta name="Microsoft.Help.F1" content="WorksharingDisplaySettings.RemoveUsers" /><meta name="Microsoft.Help.F1" content="RemoveUsers" /><meta name="container" content="Autodesk.Revit.DB" /><meta name="file" content="d714db4a-2b0e-e8da-2002-3508a3d71772" /><meta name="guid" content="d714db4a-2b0e-e8da-2002-3508a3d71772" /><meta name="Microsoft.Help.Category" content="CSharp" /><meta name="Microsoft.Help.Category" content="VB" /><meta name="Description" content="Removes users from the list of displayed users and permanently discards any customization of the graphics. Note that a user cannot be removed if he or she owns any elements." /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /></head><body onload="SetDefaultLanguage('cs');"><div class="pageBody"><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Worksharing<wbr />Display<wbr />Settings<span id="LST63665684_0" data-languageSpecificText="cpp=::|nu=."></span>Remove<wbr />Users Method</h1></td></tr></table><div class="summary">
   Removes users from the list of displayed users and permanently discards any customization of the graphics.
   Note that a user cannot be removed if he or she owns any elements.
</div><br /><strong>Namespace:</strong> <a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB</a><br /><strong>Assembly:</strong> RevitAPI (in RevitAPI.dll) Version: 25.0.0.0 (25.0.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDB')" onkeypress="SectionExpandCollapse_CheckKey('IDB', event)" tabindex="0"><img id="IDBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="IDBSection" class="collapsibleSection"><div id="IDAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAB_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cs','1','4');return false;">C#</a></div><div id="IDAB_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','vb','2','4');return false;">VB</a></div><div id="IDAB_tab3" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cpp','3','4');return false;">C++</a></div><div id="IDAB_tab4" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAB');return false;" title="Copy">Copy</a></div></div><div id="IDAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">void</span> <span class="identifier">RemoveUsers</span>(
	<span class="identifier">Document</span> <span class="parameter">document</span>,
	<span class="identifier">ICollection</span>&lt;<span class="identifier">string</span>&gt; <span class="parameter">usersToRemove</span>,
	<span class="keyword">out</span> <span class="identifier">ICollection</span>&lt;<span class="identifier">string</span>&gt; <span class="parameter">usersActuallyRemoved</span>
)</pre></div><div id="IDAB_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Sub</span> <span class="identifier">RemoveUsers</span> ( 
	<span class="parameter">document</span> <span class="keyword">As</span> <span class="identifier">Document</span>,
	<span class="parameter">usersToRemove</span> <span class="keyword">As</span> <span class="identifier">ICollection</span>(<span class="keyword">Of</span> <span class="identifier">String</span>),
	&lt;<span class="identifier">OutAttribute</span>&gt; <span class="keyword">ByRef</span> <span class="parameter">usersActuallyRemoved</span> <span class="keyword">As</span> <span class="identifier">ICollection</span>(<span class="keyword">Of</span> <span class="identifier">String</span>)
)</pre></div><div id="IDAB_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="keyword">void</span> <span class="identifier">RemoveUsers</span>(
	<span class="identifier">Document</span>^ <span class="parameter">document</span>, 
	<span class="identifier">ICollection</span>&lt;<span class="identifier">String</span>^&gt;^ <span class="parameter">usersToRemove</span>, 
	[<span class="identifier">OutAttribute</span>] <span class="identifier">ICollection</span>&lt;<span class="identifier">String</span>^&gt;^% <span class="parameter">usersActuallyRemoved</span>
)</pre></div><div id="IDAB_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">member</span> <span class="identifier">RemoveUsers</span> : 
        <span class="parameter">document</span> : <span class="identifier">Document</span> * 
        <span class="parameter">usersToRemove</span> : <span class="identifier">ICollection</span>&lt;<span class="identifier">string</span>&gt; * 
        <span class="parameter">usersActuallyRemoved</span> : <span class="identifier">ICollection</span>&lt;<span class="identifier">string</span>&gt; <span class="keyword">byref</span> <span class="keyword">-&gt;</span> <span class="keyword">unit</span> </pre></div></div></div><h4>Parameters</h4><dl><dt class="has-text-weight-normal"><span class="parameter">document</span>  <a href="db03274b-a107-aa32-9034-f3e0df4bb1ec.htm">Document</a></dt><dd>
   The document containing this.
</dd><dt class="has-text-weight-normal"><span class="parameter">usersToRemove</span>  <a href="https://learn.microsoft.com/dotnet/api/system.collections.generic.icollection-1" target="_blank" rel="noopener noreferrer">ICollection</a><span id="LST63665684_1" data-languageSpecificText="cpp=&lt;|cs=&lt;|fs=&lt;|vb=(Of |nu=("></span><a href="https://learn.microsoft.com/dotnet/api/system.string" target="_blank" rel="noopener noreferrer">String</a><span id="LST63665684_2" data-languageSpecificText="cpp=&gt;|cs=&gt;|fs=&gt;|vb=)|nu=)"></span></dt><dd>
   The usernames of the users to remove.
</dd><dt class="has-text-weight-normal"><span class="parameter">usersActuallyRemoved</span>  <a href="https://learn.microsoft.com/dotnet/api/system.collections.generic.icollection-1" target="_blank" rel="noopener noreferrer">ICollection</a><span id="LST63665684_3" data-languageSpecificText="cpp=&lt;|cs=&lt;|fs=&lt;|vb=(Of |nu=("></span><a href="https://learn.microsoft.com/dotnet/api/system.string" target="_blank" rel="noopener noreferrer">String</a><span id="LST63665684_4" data-languageSpecificText="cpp=&gt;|cs=&gt;|fs=&gt;|vb=)|nu=)"></span><span id="LST63665684_5" data-languageSpecificText="cpp=%"></span></dt><dd>
   The users that were successfully removed.  Note that you cannot remove
   users who currently own any elements.
</dd></dl></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDFC')" onkeypress="SectionExpandCollapse_CheckKey('IDFC', event)" tabindex="0"><img id="IDFCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Exceptions</span></div><div id="IDFCSection" class="collapsibleSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="631e1424-60f4-929b-4e52-dda9dcd26316.htm">ArgumentNullException</a></td><td>
   A non-optional argument was null
</td></tr></table></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDBC')" onkeypress="SectionExpandCollapse_CheckKey('IDBC', event)" tabindex="0"><img id="IDBCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="IDBCSection" class="collapsibleSection">
   Note that default graphic overrides will be applied to any elements owned by these
   users if they take ownership of any elements or worksets while they are removed.
   Note also that the list of removed users will be shared by all users of the central model and
   will remove all customizations by all users.
</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDHC')" onkeypress="SectionExpandCollapse_CheckKey('IDHC', event)" tabindex="0"><img id="IDHCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Example</span></div><div id="IDHCSection" class="collapsibleSection"><div id="IDAHC" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAHC_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAHC','cs','1','4');return false;">C#</a></div><div id="IDAHC_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAHC','vb','2','4');return false;">VB</a></div><div id="IDAHC_tab3" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDAHC','cpp','3','4');return false;">C++</a></div><div id="IDAHC_tab4" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDAHC','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAHC_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAHC');return false;" title="Copy">Copy</a></div></div><div id="IDAHC_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">public</span> <span class="highlight-keyword">void</span> RemoveAndRestoreUsers(Document doc)
{
    <span class="highlight-comment">// get or create a WorksharingDisplaySettings current active document</span>
    WorksharingDisplaySettings displaySettings = WorksharingDisplaySettings.GetOrCreateWorksharingDisplaySettings(doc);

    <span class="highlight-comment">// get all users with GraphicOverrides</span>
    ICollection&lt;String&gt; users = displaySettings.GetAllUsersWithGraphicOverrides();

    <span class="highlight-comment">// remove the users from the display settings (they will not have graphic overrides anymore)</span>
    ICollection&lt;String&gt; outUserList;
    displaySettings.RemoveUsers(doc, users, <span class="highlight-keyword">out</span> outUserList);

    <span class="highlight-comment">// show the current list of removed users</span>
    ICollection&lt;String&gt; removedUsers = displaySettings.GetRemovedUsers();

    String message = <span class="highlight-literal">"Current list of removed users: "</span>;
    <span class="highlight-keyword">if</span> (removedUsers.Count &gt; <span class="highlight-number">0</span> )
    {
       <span class="highlight-keyword">foreach</span> (String user <span class="highlight-keyword">in</span> removedUsers)
       {
          message += <span class="highlight-literal">"\n"</span> + user;
       }
    }
    <span class="highlight-keyword">else</span>
    {
        message = <span class="highlight-literal">"[Empty]"</span>;
    }

    TaskDialog.Show(<span class="highlight-literal">"Users Removed"</span>, message);

    <span class="highlight-comment">// restore the previously removed users</span>
    <span class="highlight-keyword">int</span> number = displaySettings.RestoreUsers(outUserList);

    <span class="highlight-comment">// again, show the current list of removed users</span>
    <span class="highlight-comment">// it should not contain the users that were restored</span>
    removedUsers = displaySettings.GetRemovedUsers();

    message = <span class="highlight-literal">"Current list of removed users: "</span>;
    <span class="highlight-keyword">if</span> (removedUsers.Count &gt; <span class="highlight-number">0</span> )
    {
       <span class="highlight-keyword">foreach</span> (String user <span class="highlight-keyword">in</span> removedUsers)
       {
          message += <span class="highlight-literal">"\n"</span> + user;
       }
    }
    <span class="highlight-keyword">else</span>
    {
        message = <span class="highlight-literal">"[Empty]"</span>;
    }

    TaskDialog.Show(<span class="highlight-literal">"Removed Users Restored"</span>, message);
}</pre></div><div id="IDAHC_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="highlight-keyword">Public</span> <span class="highlight-keyword">Sub</span> RemoveAndRestoreUsers(doc <span class="highlight-keyword">As</span> Document)
    <span class="highlight-comment">' get or create a WorksharingDisplaySettings current active document</span>
    <span class="highlight-keyword">Dim</span> displaySettings <span class="highlight-keyword">As</span> WorksharingDisplaySettings = WorksharingDisplaySettings.GetOrCreateWorksharingDisplaySettings(doc)

    <span class="highlight-comment">' get all users with GraphicOverrides</span>
    <span class="highlight-keyword">Dim</span> users <span class="highlight-keyword">As</span> ICollection(<span class="highlight-keyword">Of</span> [<span class="highlight-keyword">String</span>]) = displaySettings.GetAllUsersWithGraphicOverrides()

    <span class="highlight-comment">' remove the users from the display settings (they will not have graphic overrides anymore)</span>
    <span class="highlight-keyword">Dim</span> outUserList <span class="highlight-keyword">As</span> ICollection(<span class="highlight-keyword">Of</span> [<span class="highlight-keyword">String</span>]) = <span class="highlight-keyword">New</span> List(<span class="highlight-keyword">Of</span> <span class="highlight-keyword">String</span>)
    displaySettings.RemoveUsers(doc, users, outUserList)

    <span class="highlight-comment">' show the current list of removed users</span>
    <span class="highlight-keyword">Dim</span> removedUsers <span class="highlight-keyword">As</span> ICollection(<span class="highlight-keyword">Of</span> [<span class="highlight-keyword">String</span>]) = displaySettings.GetRemovedUsers()

    <span class="highlight-keyword">Dim</span> message <span class="highlight-keyword">As</span> [<span class="highlight-keyword">String</span>] = <span class="highlight-literal">"Current list of removed users: "</span>
    <span class="highlight-keyword">If</span> removedUsers.Count &gt; <span class="highlight-number">0</span> <span class="highlight-keyword">Then</span>
        <span class="highlight-keyword">For</span> <span class="highlight-keyword">Each</span> user <span class="highlight-keyword">As</span> [<span class="highlight-keyword">String</span>] <span class="highlight-keyword">In</span> removedUsers
            message += vbLf + user
        <span class="highlight-keyword">Next</span>
    <span class="highlight-keyword">Else</span>
        message = <span class="highlight-literal">"[Empty]"</span>
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>

    TaskDialog.Show(<span class="highlight-literal">"Users Removed"</span>, message)

    <span class="highlight-comment">' restore the previously removed users</span>
    <span class="highlight-keyword">Dim</span> number <span class="highlight-keyword">As</span> <span class="highlight-keyword">Integer</span> = displaySettings.RestoreUsers(outUserList)

    <span class="highlight-comment">' again, show the current list of removed users</span>
    <span class="highlight-comment">' it should not contain the users that were restored</span>
    removedUsers = displaySettings.GetRemovedUsers()

    message = <span class="highlight-literal">"Current list of removed users: "</span>
    <span class="highlight-keyword">If</span> removedUsers.Count &gt; <span class="highlight-number">0</span> <span class="highlight-keyword">Then</span>
        <span class="highlight-keyword">For</span> <span class="highlight-keyword">Each</span> user <span class="highlight-keyword">As</span> [<span class="highlight-keyword">String</span>] <span class="highlight-keyword">In</span> removedUsers
            message += vbLf + user
        <span class="highlight-keyword">Next</span>
    <span class="highlight-keyword">Else</span>
        message = <span class="highlight-literal">"[Empty]"</span>
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>

    TaskDialog.Show(<span class="highlight-literal">"Removed Users Restored"</span>, message)
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span></pre></div><div id="IDAHC_code_Div3" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div><div id="IDAHC_code_Div4" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div></div></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Reference</h4><div><a href="ec25e291-6582-7e8c-f273-efc0c391bcc4.htm">WorksharingDisplaySettings Class</a></div><div><a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB Namespace</a></div></div></div></div>
        </div></body></html>