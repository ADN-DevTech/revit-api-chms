<html><head><title>ViewSystemsAnalysisReport.RequestSystemsAnalysis Method</title><meta name="Title" content="RequestSystemsAnalysis Method" /><meta name="Microsoft.Help.Id" content="M:Autodesk.Revit.DB.Analysis.ViewSystemsAnalysisReport.RequestSystemsAnalysis(Autodesk.Revit.DB.Analysis.SystemsAnalysisOptions)" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="System.Keywords" content="ViewSystemsAnalysisReport.RequestSystemsAnalysis method" /><meta name="System.Keywords" content="RequestSystemsAnalysis method" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.DB.Analysis.ViewSystemsAnalysisReport.RequestSystemsAnalysis" /><meta name="Microsoft.Help.F1" content="ViewSystemsAnalysisReport.RequestSystemsAnalysis" /><meta name="Microsoft.Help.F1" content="RequestSystemsAnalysis" /><meta name="container" content="Autodesk.Revit.DB.Analysis" /><meta name="file" content="b36cb95e-9857-9028-4587-86fdb6767cbc" /><meta name="guid" content="b36cb95e-9857-9028-4587-86fdb6767cbc" /><meta name="Microsoft.Help.Category" content="CSharp" /><meta name="Microsoft.Help.Category" content="VB" /><meta name="Description" content="Requests a new systems analysis in the background." /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /></head><body onload="SetDefaultLanguage('cs');"><div class="pageBody"><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>View<wbr />Systems<wbr />Analysis<wbr />Report<span id="LST55DB422C_0" data-languageSpecificText="cpp=::|nu=."></span>Request<wbr />Systems<wbr />Analysis Method</h1></td></tr></table><div class="summary">
   Requests a new systems analysis in the background.
</div><br /><strong>Namespace:</strong> <a href="958e2e12-587d-f188-5d7b-f13d7dbfdf48.htm">Autodesk.Revit.DB.Analysis</a><br /><strong>Assembly:</strong> RevitAPI (in RevitAPI.dll) Version: 25.0.0.0 (25.0.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDB')" onkeypress="SectionExpandCollapse_CheckKey('IDB', event)" tabindex="0"><img id="IDBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="IDBSection" class="collapsibleSection"><div id="IDAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAB_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cs','1','4');return false;">C#</a></div><div id="IDAB_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','vb','2','4');return false;">VB</a></div><div id="IDAB_tab3" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cpp','3','4');return false;">C++</a></div><div id="IDAB_tab4" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAB');return false;" title="Copy">Copy</a></div></div><div id="IDAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">void</span> <span class="identifier">RequestSystemsAnalysis</span>(
	<span class="identifier">SystemsAnalysisOptions</span> <span class="parameter">options</span>
)</pre></div><div id="IDAB_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Sub</span> <span class="identifier">RequestSystemsAnalysis</span> ( 
	<span class="parameter">options</span> <span class="keyword">As</span> <span class="identifier">SystemsAnalysisOptions</span>
)</pre></div><div id="IDAB_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="keyword">void</span> <span class="identifier">RequestSystemsAnalysis</span>(
	<span class="identifier">SystemsAnalysisOptions</span>^ <span class="parameter">options</span>
)</pre></div><div id="IDAB_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">member</span> <span class="identifier">RequestSystemsAnalysis</span> : 
        <span class="parameter">options</span> : <span class="identifier">SystemsAnalysisOptions</span> <span class="keyword">-&gt;</span> <span class="keyword">unit</span> </pre></div></div></div><h4>Parameters</h4><dl><dt class="has-text-weight-normal"><span class="parameter">options</span>  <a href="8d8fe6a8-d3f6-c4fd-99ac-3181ba0253d6.htm">SystemsAnalysisOptions</a></dt><dd>
   The additional options to run systems analysis. If empty, use the default value in the view element.
   The request may download the weather file at current site location if not specified in the options.
</dd></dl></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDCC')" onkeypress="SectionExpandCollapse_CheckKey('IDCC', event)" tabindex="0"><img id="IDCCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Exceptions</span></div><div id="IDCCSection" class="collapsibleSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="631e1424-60f4-929b-4e52-dda9dcd26316.htm">ArgumentNullException</a></td><td>
   A non-optional argument was null
</td></tr><tr><td><a href="05972c68-fa6d-3a83-d720-ad84fbc4780f.htm">ArgumentsInconsistentException</a></td><td>
   No weather station is within 500 nautical miles of this site location.
</td></tr><tr><td><a href="73250198-dbc6-e760-4297-ec062f00f574.htm">FileNotFoundException</a></td><td>
   Fail to download the weather file.
</td></tr><tr><td><a href="9e715f03-3884-e539-4dd6-8d7545733adc.htm">InvalidOperationException</a></td><td>
   A valid energy model is required for systems analysis.
   -or-
   Unable to access the weather service. Try again later.
</td></tr></table></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDHC')" onkeypress="SectionExpandCollapse_CheckKey('IDHC', event)" tabindex="0"><img id="IDHCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Example</span></div><div id="IDHCSection" class="collapsibleSection"><div id="IDAHC" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAHC_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAHC','cs','1','4');return false;">C#</a></div><div id="IDAHC_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAHC','vb','2','4');return false;">VB</a></div><div id="IDAHC_tab3" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDAHC','cpp','3','4');return false;">C++</a></div><div id="IDAHC_tab4" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDAHC','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAHC_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAHC');return false;" title="Copy">Copy</a></div></div><div id="IDAHC_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-comment">// Create a new report and request systems analysis on the current energy model.</span>
ViewSystemsAnalysisReport newReport = <span class="highlight-keyword">null</span>;

SystemsAnalysisOptions theOptions = <span class="highlight-keyword">new</span> SystemsAnalysisOptions();
<span class="highlight-keyword">string</span> openStudioPath = Path.GetFullPath(Path.Combine(doc.Application.SystemsAnalysisWorkfilesRootPath, <span class="highlight-literal">@"..\"</span>));
<span class="highlight-comment">// The following are the default values for systems analysis if not specified.</span>
<span class="highlight-comment">// If the weather file is not specified, the analysis will use the weather at the current site location.</span>
theOptions.WorkflowFile = Path.Combine(openStudioPath, <span class="highlight-literal">@"workflows\HVAC Systems Loads and Sizing.osw"</span>);
theOptions.OutputFolder = Path.GetTempPath();
<span class="highlight-keyword">using</span> (Transaction transaction = <span class="highlight-keyword">new</span> Transaction(doc))
{
   transaction.Start(<span class="highlight-literal">"Create Systems Analysis View"</span>);

   newReport = ViewSystemsAnalysisReport.Create(doc, <span class="highlight-literal">"APITestView"</span>);
   <span class="highlight-comment">// Create a new report of systems analysis. </span>
   <span class="highlight-keyword">if</span> (newReport != <span class="highlight-keyword">null</span>)
   {
      newReport.RequestSystemsAnalysis(theOptions);
      <span class="highlight-comment">// Request the systems analysis in the background process. When the systems analysis is completed, </span>
      <span class="highlight-comment">// the result is automatically updated in the report view and the analytical space elements.</span>
      <span class="highlight-comment">// You may check the status by calling newReport.IsAnalysisCompleted().</span>
      transaction.Commit();
   }
   <span class="highlight-keyword">else</span>
   {
      transaction.RollBack();
   }
}</pre></div><div id="IDAHC_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="highlight-comment">' Create a New report And request systems analysis on the current energy model.</span>
<span class="highlight-keyword">Dim</span> newReport <span class="highlight-keyword">As</span> ViewSystemsAnalysisReport = <span class="highlight-keyword">Nothing</span>

<span class="highlight-keyword">Dim</span> theOptions <span class="highlight-keyword">As</span> SystemsAnalysisOptions = <span class="highlight-keyword">New</span> SystemsAnalysisOptions()
<span class="highlight-keyword">Dim</span> openStudioPath <span class="highlight-keyword">As</span> <span class="highlight-keyword">String</span> = Path.GetFullPath(Path.Combine(doc.Application.SystemsAnalysisWorkfilesRootPath, <span class="highlight-literal">"..\"</span>))
<span class="highlight-comment">' The following are the default values for systems analysis if not specified.</span>
<span class="highlight-comment">' If the weather file is not specified, the analysis will use the weather at the current site location.</span>
theOptions.WorkflowFile = Path.Combine(openStudioPath, <span class="highlight-literal">"workflows\HVAC Systems Loads and Sizing.osw"</span>)
theOptions.OutputFolder = Path.GetTempPath()
<span class="highlight-keyword">Using</span> t <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> Transaction(doc, <span class="highlight-literal">"Create Systems Analysis View"</span>)
   t.Start()

   newReport = ViewSystemsAnalysisReport.Create(doc, <span class="highlight-literal">"APITestView"</span>)
   <span class="highlight-comment">' Create a new report of systems analysis. </span>
   <span class="highlight-keyword">If</span> newReport <span class="highlight-keyword">IsNot</span> <span class="highlight-keyword">Nothing</span> <span class="highlight-keyword">Then</span>
      newReport.RequestSystemsAnalysis(theOptions)
      <span class="highlight-comment">' Request the systems analysis in the background process. When the systems analysis Is completed, </span>
      <span class="highlight-comment">' the result Is automatically updated in the report view And the analytical space elements.</span>
      <span class="highlight-comment">' You may check the status by calling newReport.IsAnalysisCompleted().</span>
      t.Commit()
   <span class="highlight-keyword">Else</span>
      t.RollBack()
   <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Using</span></pre></div><div id="IDAHC_code_Div3" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div><div id="IDAHC_code_Div4" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div></div></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Reference</h4><div><a href="a7b5b7de-dfdb-e57f-7fac-1ff1dbf35e4d.htm">ViewSystemsAnalysisReport Class</a></div><div><a href="958e2e12-587d-f188-5d7b-f13d7dbfdf48.htm">Autodesk.Revit.DB.Analysis Namespace</a></div></div></div></div>
        </div></body></html>