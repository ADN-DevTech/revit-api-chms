<html><head><title>Element.Geometry Property</title><meta name="Title" content="Geometry Property" /><meta name="Microsoft.Help.Id" content="P:Autodesk.Revit.DB.Element.Geometry(Autodesk.Revit.DB.Options)" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="System.Keywords" content="Element.Geometry property" /><meta name="System.Keywords" content="Geometry property" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.DB.Element.Geometry" /><meta name="Microsoft.Help.F1" content="Element.Geometry" /><meta name="Microsoft.Help.F1" content="Geometry" /><meta name="container" content="Autodesk.Revit.DB" /><meta name="file" content="d8a55a5b-2a69-d5ab-3e1f-6cf1ee43c8ec" /><meta name="guid" content="d8a55a5b-2a69-d5ab-3e1f-6cf1ee43c8ec" /><meta name="Microsoft.Help.Category" content="CSharp" /><meta name="Microsoft.Help.Category" content="VB" /><meta name="Description" content="Retrieves the geometric representation of the element." /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /></head><body onload="SetDefaultLanguage('cs');"><div class="pageBody"><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Element<span id="LSTC3798014_0" data-languageSpecificText="cpp=::|nu=."></span>Geometry Property</h1></td></tr></table><div class="summary">Retrieves the geometric representation of the element.</div><br /><strong>Namespace:</strong> <a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB</a><br /><strong>Assembly:</strong> RevitAPI (in RevitAPI.dll) Version: 25.0.0.0 (25.0.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDB')" onkeypress="SectionExpandCollapse_CheckKey('IDB', event)" tabindex="0"><img id="IDBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="IDBSection" class="collapsibleSection"><div id="IDAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAB_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cs','1','4');return false;">C#</a></div><div id="IDAB_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','vb','2','4');return false;">VB</a></div><div id="IDAB_tab3" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cpp','3','4');return false;">C++</a></div><div id="IDAB_tab4" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAB');return false;" title="Copy">Copy</a></div></div><div id="IDAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="identifier">GeometryElement</span> <span class="keyword">this</span>[
	<span class="identifier">Options</span> <span class="parameter">options</span>
] { <span class="keyword">get</span>; }</pre></div><div id="IDAB_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">ReadOnly</span> <span class="keyword">Property</span> <span class="identifier">Geometry</span> ( 
	<span class="parameter">options</span> <span class="keyword">As</span> <span class="identifier">Options</span>
) <span class="keyword">As</span> <span class="identifier">GeometryElement</span>
	<span class="keyword">Get</span></pre></div><div id="IDAB_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="keyword">property</span> <span class="identifier">GeometryElement</span>^ <span class="identifier">Geometry</span>[<span class="identifier">Options</span>^ <span class="parameter">options</span>] {
	<span class="identifier">GeometryElement</span>^ <span class="keyword">get</span> (<span class="identifier">Options</span>^ <span class="parameter">options</span>);
}</pre></div><div id="IDAB_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">member</span> <span class="identifier">Geometry</span> : <span class="identifier">GeometryElement</span> <span class="keyword">with</span> <span class="keyword">get</span></pre></div></div></div><h4>Parameters</h4><dl><dt class="has-text-weight-normal"><span class="parameter">options</span>  <a href="aa41fc13-9f81-836c-4271-82568ba5d7e8.htm">Options</a></dt><dd>User preferences for parsing of geometry.</dd></dl><h4>Property Value</h4><a href="09eaeb08-58bb-8049-8925-f3a5aa846fdc.htm">GeometryElement</a><br />An object that provides access to the geometry of the element.</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDCC')" onkeypress="SectionExpandCollapse_CheckKey('IDCC', event)" tabindex="0"><img id="IDCCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="IDCCSection" class="collapsibleSection"><p>This call will retrieve 3d representation of the element. <span class="keyword"><span id="LSTC3798014_1" data-languageSpecificText="cpp=nullptr|vb=Nothing|nu=null"></span></span> will be returned
for symbols, annotations or details. This involves extensive parsing or Revit's data
structures, so try to minimize calls if performance is critical.</p><p>Geometry objects provided from this method are obtained directly from the element. When
the element is changed for any reason, the geometry will be recalculated by Revit and geometry
objects obtained before the change are likely to no longer be valid.  If you need to preserve
geometry information obtained an element even after changes to that element, you should copy
the geometry objects or save the properties independently.</p><p>Although the geometry obtained from this method comes directly from the element, any attempt to modify 
any of the geometry objects will operate only on a disconnected copy of the original geometry object from the element.  
The modification will not affect the geometry of the original element from which it was obtained - 
to change the geometry of the element you must use methods that directly affect the geometry calculated or 
stored by Revit for this element.</p><p>If you require that the geometry items obtained contain valid 
<a href="d28155ae-817b-1f31-9c3f-c9c6a28acc0d.htm">Reference objects</a>, be sure to set the ComputeReferences
property of the Options.</p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDEC')" onkeypress="SectionExpandCollapse_CheckKey('IDEC', event)" tabindex="0"><img id="IDECToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Example</span></div><div id="IDECSection" class="collapsibleSection"><div id="IDAEC" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAEC_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAEC','cs','1','4');return false;">C#</a></div><div id="IDAEC_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAEC','vb','2','4');return false;">VB</a></div><div id="IDAEC_tab3" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDAEC','cpp','3','4');return false;">C++</a></div><div id="IDAEC_tab4" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDAEC','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAEC_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAEC');return false;" title="Copy">Copy</a></div></div><div id="IDAEC_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">public</span> <span class="highlight-keyword">void</span> GetCurvesFromABeam(Autodesk.Revit.DB.FamilyInstance beam,
                               Autodesk.Revit.DB.Options options)
{
    Autodesk.Revit.DB.GeometryElement geomElem = beam.get_Geometry(options);

    Autodesk.Revit.DB.CurveArray curves = <span class="highlight-keyword">new</span> CurveArray();
    System.Collections.Generic.List&lt;Autodesk.Revit.DB.Solid&gt; solids = <span class="highlight-keyword">new</span> System.Collections.Generic.List&lt;Autodesk.Revit.DB.Solid&gt;(); 

    <span class="highlight-comment">//Find all solids and insert them into solid array</span>
    AddCurvesAndSolids(geomElem, <span class="highlight-keyword">ref</span> curves, <span class="highlight-keyword">ref</span> solids);
}

<span class="highlight-keyword">private</span> <span class="highlight-keyword">void</span> AddCurvesAndSolids(Autodesk.Revit.DB.GeometryElement geomElem,
                                <span class="highlight-keyword">ref</span> Autodesk.Revit.DB.CurveArray curves,
                                <span class="highlight-keyword">ref</span> System.Collections.Generic.List&lt;Autodesk.Revit.DB.Solid&gt; solids)
{
    <span class="highlight-keyword">foreach</span> (Autodesk.Revit.DB.GeometryObject geomObj <span class="highlight-keyword">in</span> geomElem)
    {
        Autodesk.Revit.DB.Curve curve = geomObj <span class="highlight-keyword">as</span> Autodesk.Revit.DB.Curve;
        <span class="highlight-keyword">if</span> (<span class="highlight-keyword">null</span> != curve)
        {
            curves.Append(curve);
            <span class="highlight-keyword">continue</span>;
        }
        Autodesk.Revit.DB.Solid solid = geomObj <span class="highlight-keyword">as</span> Autodesk.Revit.DB.Solid;
        <span class="highlight-keyword">if</span> (<span class="highlight-keyword">null</span> != solid)
        {
            solids.Add(solid);
            <span class="highlight-keyword">continue</span>;
        }
        <span class="highlight-comment">//If this GeometryObject is Instance, call AddCurvesAndSolids</span>
        Autodesk.Revit.DB.GeometryInstance geomInst = geomObj <span class="highlight-keyword">as</span> Autodesk.Revit.DB.GeometryInstance;
        <span class="highlight-keyword">if</span> (<span class="highlight-keyword">null</span> != geomInst)
        {
            Autodesk.Revit.DB.GeometryElement transformedGeomElem
              = geomInst.GetInstanceGeometry(geomInst.Transform);
            AddCurvesAndSolids(transformedGeomElem, <span class="highlight-keyword">ref</span> curves, <span class="highlight-keyword">ref</span> solids);
        }
    }
}</pre></div><div id="IDAEC_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve">  <span class="highlight-keyword">Public</span> <span class="highlight-keyword">Sub</span> GetCurvesFromABeam(beam <span class="highlight-keyword">As</span> Autodesk.Revit.DB.FamilyInstance, options <span class="highlight-keyword">As</span> Autodesk.Revit.DB.Options)
      <span class="highlight-keyword">Dim</span> geomElem <span class="highlight-keyword">As</span> Autodesk.Revit.DB.GeometryElement = beam.Geometry(options)

      <span class="highlight-keyword">Dim</span> curves <span class="highlight-keyword">As</span> Autodesk.Revit.DB.CurveArray = <span class="highlight-keyword">New</span> CurveArray()
   <span class="highlight-keyword">Dim</span> solids <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> System.Collections.Generic.List(<span class="highlight-keyword">Of</span> Autodesk.Revit.DB.Solid)

      <span class="highlight-comment">'Find all solids and insert them into solid array</span>
      AddCurvesAndSolids(geomElem, curves, solids)
  <span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span>

<span class="highlight-keyword">Private</span> <span class="highlight-keyword">Sub</span> AddCurvesAndSolids(geomElem <span class="highlight-keyword">As</span> Autodesk.Revit.DB.GeometryElement, <span class="highlight-keyword">ByRef</span> curves <span class="highlight-keyword">As</span> Autodesk.Revit.DB.CurveArray, <span class="highlight-keyword">ByRef</span> solids <span class="highlight-keyword">As</span> System.Collections.Generic.List(<span class="highlight-keyword">Of</span> Autodesk.Revit.DB.Solid))
   <span class="highlight-keyword">For</span> <span class="highlight-keyword">Each</span> geomObj <span class="highlight-keyword">As</span> Autodesk.Revit.DB.GeometryObject <span class="highlight-keyword">In</span> geomElem
      <span class="highlight-keyword">Dim</span> curve <span class="highlight-keyword">As</span> Autodesk.Revit.DB.Curve = <span class="highlight-keyword">TryCast</span>(geomObj, Autodesk.Revit.DB.Curve)
      <span class="highlight-keyword">If</span> curve <span class="highlight-keyword">IsNot</span> <span class="highlight-keyword">Nothing</span> <span class="highlight-keyword">Then</span>
         curves.Append(curve)
         <span class="highlight-keyword">Continue</span> <span class="highlight-keyword">For</span>
      <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
      <span class="highlight-keyword">Dim</span> solid <span class="highlight-keyword">As</span> Autodesk.Revit.DB.Solid = <span class="highlight-keyword">TryCast</span>(geomObj, Autodesk.Revit.DB.Solid)
      <span class="highlight-keyword">If</span> solid <span class="highlight-keyword">IsNot</span> <span class="highlight-keyword">Nothing</span> <span class="highlight-keyword">Then</span>
         solids.Add(solid)
         <span class="highlight-keyword">Continue</span> <span class="highlight-keyword">For</span>
      <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
      <span class="highlight-comment">'If this GeometryObject is Instance, call AddCurvesAndSolids</span>
      <span class="highlight-keyword">Dim</span> geomInst <span class="highlight-keyword">As</span> Autodesk.Revit.DB.GeometryInstance = <span class="highlight-keyword">TryCast</span>(geomObj, Autodesk.Revit.DB.GeometryInstance)
      <span class="highlight-keyword">If</span> geomInst <span class="highlight-keyword">IsNot</span> <span class="highlight-keyword">Nothing</span> <span class="highlight-keyword">Then</span>
         <span class="highlight-keyword">Dim</span> transformedGeomElem <span class="highlight-keyword">As</span> Autodesk.Revit.DB.GeometryElement = geomInst.GetInstanceGeometry(geomInst.Transform)
         AddCurvesAndSolids(transformedGeomElem, curves, solids)
      <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
   <span class="highlight-keyword">Next</span>
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span></pre></div><div id="IDAEC_code_Div3" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div><div id="IDAEC_code_Div4" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div></div></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Reference</h4><div><a href="eb16114f-69ea-f4de-0d0d-f7388b105a16.htm">Element Class</a></div><div><a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB Namespace</a></div></div></div></div>
        </div></body></html>