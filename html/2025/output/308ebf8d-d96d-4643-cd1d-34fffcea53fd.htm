<html><head><title>Transaction Class</title><meta name="Title" content="Transaction Class" /><meta name="Microsoft.Help.Id" content="T:Autodesk.Revit.DB.Transaction" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="System.Keywords" content="Autodesk.Revit.DB.Transaction class" /><meta name="System.Keywords" content="Transaction class" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.DB.Transaction" /><meta name="Microsoft.Help.F1" content="Transaction" /><meta name="container" content="Autodesk.Revit.DB" /><meta name="file" content="308ebf8d-d96d-4643-cd1d-34fffcea53fd" /><meta name="guid" content="308ebf8d-d96d-4643-cd1d-34fffcea53fd" /><meta name="Microsoft.Help.Category" content="CSharp" /><meta name="Microsoft.Help.Category" content="VB" /><meta name="Description" content="Transactions are context-like objects that guard any changes made to a Revit model" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /></head><body onload="SetDefaultLanguage('cs');"><div class="pageBody"><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Transaction Class</h1></td></tr></table><div class="summary">
   Transactions are context-like objects that guard any changes made to a Revit model
</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDDA')" onkeypress="SectionExpandCollapse_CheckKey('IDDA', event)" tabindex="0"><img id="IDDAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Inheritance Hierarchy</span></div><div id="IDDASection" class="collapsibleSection"><a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">System<span id="LSTB1114CB_0" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>Object</a><br />  <span class="selflink">Autodesk.Revit.DB<span id="LSTB1114CB_1" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>Transaction</span><br /></div><br /><strong>Namespace:</strong> <a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB</a><br /><strong>Assembly:</strong> RevitAPI (in RevitAPI.dll) Version: 25.0.0.0 (25.0.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDB')" onkeypress="SectionExpandCollapse_CheckKey('IDB', event)" tabindex="0"><img id="IDBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="IDBSection" class="collapsibleSection"><div id="IDAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAB_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cs','1','4');return false;">C#</a></div><div id="IDAB_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','vb','2','4');return false;">VB</a></div><div id="IDAB_tab3" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cpp','3','4');return false;">C++</a></div><div id="IDAB_tab4" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAB');return false;" title="Copy">Copy</a></div></div><div id="IDAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">class</span> <span class="identifier">Transaction</span> : <span class="identifier">IDisposable</span></pre></div><div id="IDAB_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Class</span> <span class="identifier">Transaction</span>
	<span class="keyword">Implements</span> <span class="identifier">IDisposable</span></pre></div><div id="IDAB_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">ref class</span> <span class="identifier">Transaction</span> : <span class="identifier">IDisposable</span></pre></div><div id="IDAB_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">type</span> <span class="identifier">Transaction</span> = 
    <span class="keyword">class</span>
        <span class="keyword">interface</span> <span class="identifier">IDisposable</span>
    <span class="keyword">end</span></pre></div></div></div></div><p>The <span class="selflink">Transaction</span> type exposes the following members.</p><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDAAFA')" onkeypress="SectionExpandCollapse_CheckKey('IDAAFA', event)" tabindex="0"><img id="IDAAFAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Constructors</span></div><div id="IDAAFASection" class="collapsibleSection"><table id="ConstructorList" class="members"><tr><th class="iconColumn"> </th><th>Name</th><th>Description</th></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="36a9e161-5943-3a7d-b022-a2779185d02c.htm">Transaction(Document)</a></td><td>
   Instantiates a transaction object.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="8ac32652-a440-7f01-81b8-d6a7f2dc7791.htm">Transaction(Document, String)</a></td><td>
   Instantiates a transaction object
</td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDQFA')" onkeypress="SectionExpandCollapse_CheckKey('IDQFA', event)" tabindex="0"><img id="IDQFAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Properties</span></div><div id="IDQFASection" class="collapsibleSection"><table id="PropertyList" class="members"><tr><th class="iconColumn"> </th><th>Name</th><th>Description</th></tr><tr><td><img src="../icons/pubProperty.gif" alt="Public property" title="Public property" /></td><td><a href="80f24fab-a66b-7bf9-949c-1fbaa360c79d.htm">IsValidObject</a></td><td>
   Specifies whether the .NET object represents a valid Revit entity.
</td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDCFA')" onkeypress="SectionExpandCollapse_CheckKey('IDCFA', event)" tabindex="0"><img id="IDCFAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Methods</span></div><div id="IDCFASection" class="collapsibleSection"><table id="MethodList" class="members"><tr><th class="iconColumn"> </th><th>Name</th><th>Description</th></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="32714010-7138-f64f-8fde-a310354448e3.htm">Commit<span id="LSTB1114CB_2" data-languageSpecificText="cs=()|vb=|cpp=()|nu=()|fs=()"></span></a></td><td>
   Commits all changes made to the model during the transaction.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="9e9983d1-bd0d-b476-2dc4-021c56eb2bd7.htm">Commit(FailureHandlingOptions)</a></td><td>
   Commits all changes made to the model during the transaction.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="58d38d85-06cb-58ad-3631-8c2301240c94.htm">Dispose</a></td><td>Releases all resources used by the <span class="selflink">Transaction</span></td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)" target="_blank" rel="noopener noreferrer">Equals</a></td><td>Determines whether the specified object is equal to the current object.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="f306f808-a753-1585-18ef-57d65e76fad4.htm">GetFailureHandlingOptions</a></td><td>
   Returns the current failure handling options.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode#system-object-gethashcode" target="_blank" rel="noopener noreferrer">GetHashCode</a></td><td>Serves as the default hash function.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="efc9e55a-1457-db92-66ec-84fcfc688552.htm">GetName</a></td><td>
   Returns the transaction's name.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="fdf98941-eee4-d8af-e3f7-5b6c7ccc3c74.htm">GetStatus</a></td><td>
   Returns the current status of the transaction.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.gettype#system-object-gettype" target="_blank" rel="noopener noreferrer">GetType</a></td><td>Gets the <a href="https://learn.microsoft.com/dotnet/api/system.type" target="_blank" rel="noopener noreferrer">Type</a> of the current instance.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="0287f338-0d0c-aff2-c75b-0aefe452969d.htm">HasEnded</a></td><td>
   Determines whether the transaction has ended already.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="425a8103-a11b-4c45-f002-0e7bc602d074.htm">HasStarted</a></td><td>
   Determines whether the transaction has been started yet.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="bd1e69e9-961e-1c07-f70a-a29b90c6eb97.htm">RollBack<span id="LSTB1114CB_3" data-languageSpecificText="cs=()|vb=|cpp=()|nu=()|fs=()"></span></a></td><td>
   Rolls back all changes made to the model during the transaction.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="d99de9ee-168e-a114-1255-0cea9f317efb.htm">RollBack(FailureHandlingOptions)</a></td><td>
   Rolls back all changes made to the model during the transaction.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="1e913cca-f75b-8dfb-b172-5a04f3732b85.htm">SetFailureHandlingOptions</a></td><td>
   Sets options for handling failures to be used when the transaction is being committed or rolled back.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="c0283e7f-d261-6016-724c-31ae5cde96a7.htm">SetName</a></td><td>
   Sets the transaction's name.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="1146fa87-127d-c432-0f51-79a5eb102031.htm">Start<span id="LSTB1114CB_4" data-languageSpecificText="cs=()|vb=|cpp=()|nu=()|fs=()"></span></a></td><td>
   Starts the transaction.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="5fb266f4-5eca-049f-6a30-f3ed76687409.htm">Start(String)</a></td><td>
   Starts the transaction with an assigned name.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.tostring#system-object-tostring" target="_blank" rel="noopener noreferrer">ToString</a></td><td>Returns a string that represents the current object.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDBC')" onkeypress="SectionExpandCollapse_CheckKey('IDBC', event)" tabindex="0"><img id="IDBCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="IDBCSection" class="collapsibleSection"><p>Any change to a document can only be made while there is an active transaction
   open for that document. Changes do not become part of the document until the
   active transaction is <a href="32714010-7138-f64f-8fde-a310354448e3.htm">committed</a>. Consequently, all
   changes made in a transaction can be <a href="bd1e69e9-961e-1c07-f70a-a29b90c6eb97.htm">rolled back</a>
   either explicitly or implicitly by the transaction's destructor.</p><p>A document can have only one transaction open at any given time.</p><p>Transactions cannot be started when the document is in read-only mode,
   either permanently or temporarily. See the Document class methods IsReadOnly
   and IsModifiable for more details.</p><p>Transactions in linked documents are not permitted,
   for linked documents are not allowed to be modified.</p><p /><p>If a transaction was started and not finished yet by the time the Transaction object
   is about to be disposed, the default destructor will roll it back automatically, thus all
   changes made to the document while this transaction was open will be discarded.
   It is not recommended to rely on this default behavior though. Instead,
   it is advised to always call either <a href="32714010-7138-f64f-8fde-a310354448e3.htm">Commit</a>
   or <a href="bd1e69e9-961e-1c07-f70a-a29b90c6eb97.htm">RollBack</a> explicitly before the transaction
   object gets disposed.
   Please note that unless invoked explicitly the actual destruction of an object
   in managed code might not happen until the object is collected by the garbage collector.</p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDCC')" onkeypress="SectionExpandCollapse_CheckKey('IDCC', event)" tabindex="0"><img id="IDCCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Example</span></div><div id="IDCCSection" class="collapsibleSection"><div id="IDACC" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDACC_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDACC','cs','1','4');return false;">C#</a></div><div id="IDACC_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDACC','vb','2','4');return false;">VB</a></div><div id="IDACC_tab3" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDACC','cpp','3','4');return false;">C++</a></div><div id="IDACC_tab4" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDACC','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDACC_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDACC');return false;" title="Copy">Copy</a></div></div><div id="IDACC_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">public</span> <span class="highlight-keyword">void</span> CreatingSketch(UIApplication uiApplication)
{
    Autodesk.Revit.DB.Document document = uiApplication.ActiveUIDocument.Document;
    Autodesk.Revit.ApplicationServices.Application application = uiApplication.Application;

    <span class="highlight-comment">// Create a few geometry lines. These lines are transaction (not in the model),</span>
    <span class="highlight-comment">// therefore they do not need to be created inside a document transaction.</span>
    XYZ Point1 = XYZ.Zero;
    XYZ Point2 = <span class="highlight-keyword">new</span> XYZ(<span class="highlight-number">10</span>, <span class="highlight-number">0</span>, <span class="highlight-number">0</span>);
    XYZ Point3 = <span class="highlight-keyword">new</span> XYZ(<span class="highlight-number">10</span>, <span class="highlight-number">10</span>, <span class="highlight-number">0</span>);
    XYZ Point4 = <span class="highlight-keyword">new</span> XYZ(<span class="highlight-number">0</span>, <span class="highlight-number">10</span>, <span class="highlight-number">0</span>);

    Line geomLine1 = Line.CreateBound(Point1, Point2);
    Line geomLine2 = Line.CreateBound(Point4, Point3);
    Line geomLine3 = Line.CreateBound(Point1, Point4);

    <span class="highlight-comment">// This geometry plane is also transaction and does not need a transaction</span>
    XYZ origin = XYZ.Zero;
    XYZ normal = <span class="highlight-keyword">new</span> XYZ(<span class="highlight-number">0</span>, <span class="highlight-number">0</span>, <span class="highlight-number">1</span>);
    Plane geomPlane = Plane.CreateByNormalAndOrigin(normal, origin);

    <span class="highlight-comment">// In order to a sketch plane with model curves in it, we need</span>
    <span class="highlight-comment">// to start a transaction because such operations modify the model.</span>

    <span class="highlight-comment">// All and any transaction should be enclosed in a 'using'</span>
    <span class="highlight-comment">// block or guarded within a try-catch-finally blocks</span>
    <span class="highlight-comment">// to guarantee that a transaction does not out-live its scope.</span>
    <span class="highlight-keyword">using</span> (Transaction transaction = <span class="highlight-keyword">new</span> Transaction(document))
    {
       <span class="highlight-keyword">if</span> (transaction.Start(<span class="highlight-literal">"Create model curves"</span>) == TransactionStatus.Started)
       {
           <span class="highlight-comment">// Create a sketch plane in current document</span>
           SketchPlane sketch = SketchPlane.Create(document,geomPlane);

           <span class="highlight-comment">// Create a ModelLine elements using the geometry lines and sketch plane</span>
           ModelLine line1 = document.Create.NewModelCurve(geomLine1, sketch) <span class="highlight-keyword">as</span> ModelLine;
           ModelLine line2 = document.Create.NewModelCurve(geomLine2, sketch) <span class="highlight-keyword">as</span> ModelLine;
           ModelLine line3 = document.Create.NewModelCurve(geomLine3, sketch) <span class="highlight-keyword">as</span> ModelLine;

           <span class="highlight-comment">// Ask the end user whether the changes are to be committed or not</span>
           TaskDialog taskDialog = <span class="highlight-keyword">new</span> TaskDialog(<span class="highlight-literal">"Revit"</span>);
           taskDialog.MainContent = <span class="highlight-literal">"Click either [OK] to Commit, or [Cancel] to Roll back the transaction."</span>;
           TaskDialogCommonButtons buttons = TaskDialogCommonButtons.Ok | TaskDialogCommonButtons.Cancel;
           taskDialog.CommonButtons = buttons;

           <span class="highlight-keyword">if</span> (TaskDialogResult.Ok == taskDialog.Show())
           {
               <span class="highlight-comment">// For many various reasons, a transaction may not be committed</span>
               <span class="highlight-comment">// if the changes made during the transaction do not result a valid model.</span>
               <span class="highlight-comment">// If committing a transaction fails or is canceled by the end user,</span>
               <span class="highlight-comment">// the resulting status would be RolledBack instead of Committed.</span>
               <span class="highlight-keyword">if</span> (TransactionStatus.Committed != transaction.Commit())
               {
                  TaskDialog.Show(<span class="highlight-literal">"Failure"</span>, <span class="highlight-literal">"Transaction could not be committed"</span>);
               }
           }
           <span class="highlight-keyword">else</span>
           {
               transaction.RollBack();
           }
       }
    }
}</pre></div><div id="IDACC_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="highlight-keyword">Public</span> <span class="highlight-keyword">Sub</span> CreatingSketch(uiApplication <span class="highlight-keyword">As</span> UIApplication)
    <span class="highlight-keyword">Dim</span> document <span class="highlight-keyword">As</span> Autodesk.Revit.DB.Document = uiApplication.ActiveUIDocument.Document
    <span class="highlight-keyword">Dim</span> application <span class="highlight-keyword">As</span> Autodesk.Revit.ApplicationServices.Application = uiApplication.Application

    <span class="highlight-comment">' Create a few geometry lines. These lines are transaction (not in the model),</span>
    <span class="highlight-comment">' therefore they do not need to be created inside a document transaction.</span>
    <span class="highlight-keyword">Dim</span> Point1 <span class="highlight-keyword">As</span> XYZ = XYZ.Zero
    <span class="highlight-keyword">Dim</span> Point2 <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> XYZ(<span class="highlight-number">10</span>, <span class="highlight-number">0</span>, <span class="highlight-number">0</span>)
    <span class="highlight-keyword">Dim</span> Point3 <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> XYZ(<span class="highlight-number">10</span>, <span class="highlight-number">10</span>, <span class="highlight-number">0</span>)
    <span class="highlight-keyword">Dim</span> Point4 <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> XYZ(<span class="highlight-number">0</span>, <span class="highlight-number">10</span>, <span class="highlight-number">0</span>)

    <span class="highlight-keyword">Dim</span> geomLine1 <span class="highlight-keyword">As</span> Line = Line.CreateBound(Point1, Point2)
    <span class="highlight-keyword">Dim</span> geomLine2 <span class="highlight-keyword">As</span> Line = Line.CreateBound(Point4, Point3)
    <span class="highlight-keyword">Dim</span> geomLine3 <span class="highlight-keyword">As</span> Line = Line.CreateBound(Point1, Point4)

    <span class="highlight-comment">' This geometry plane is also transaction and does not need a transaction</span>
    <span class="highlight-keyword">Dim</span> origin <span class="highlight-keyword">As</span> XYZ = XYZ.Zero
    <span class="highlight-keyword">Dim</span> normal <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> XYZ(<span class="highlight-number">0</span>, <span class="highlight-number">0</span>, <span class="highlight-number">1</span>)
 <span class="highlight-keyword">Dim</span> geomPlane <span class="highlight-keyword">As</span> Plane = Plane.CreateByNormalAndOrigin(normal, origin)

    <span class="highlight-comment">' In order to a sketch plane with model curves in it, we need</span>
    <span class="highlight-comment">' to start a transaction because such operations modify the model.</span>

    <span class="highlight-comment">' All and any transaction should be enclosed in a 'using'</span>
    <span class="highlight-comment">' block or guarded within a try-catch-finally blocks</span>
    <span class="highlight-comment">' to guarantee that a transaction does not out-live its scope.</span>
    <span class="highlight-keyword">Using</span> transaction <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> Transaction(document)
        <span class="highlight-keyword">If</span> transaction.Start(<span class="highlight-literal">"Create model curves"</span>) = TransactionStatus.Started <span class="highlight-keyword">Then</span>
            <span class="highlight-comment">' Create a sketch plane in current document</span>
            <span class="highlight-keyword">Dim</span> sketch <span class="highlight-keyword">As</span> SketchPlane = SketchPlane.Create(document, geomPlane)

            <span class="highlight-comment">' Create a ModelLine elements using the geometry lines and sketch plane</span>
            <span class="highlight-keyword">Dim</span> line1 <span class="highlight-keyword">As</span> ModelLine = <span class="highlight-keyword">TryCast</span>(document.Create.NewModelCurve(geomLine1, sketch), ModelLine)
            <span class="highlight-keyword">Dim</span> line2 <span class="highlight-keyword">As</span> ModelLine = <span class="highlight-keyword">TryCast</span>(document.Create.NewModelCurve(geomLine2, sketch), ModelLine)
            <span class="highlight-keyword">Dim</span> line3 <span class="highlight-keyword">As</span> ModelLine = <span class="highlight-keyword">TryCast</span>(document.Create.NewModelCurve(geomLine3, sketch), ModelLine)

            <span class="highlight-comment">' Ask the end user whether the changes are to be committed or not</span>
            <span class="highlight-keyword">Dim</span> taskDialog__1 <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> TaskDialog(<span class="highlight-literal">"Revit"</span>)
            taskDialog__1.MainContent = <span class="highlight-literal">"Click either [OK] to Commit, or [Cancel] to Roll back the transaction."</span>
            <span class="highlight-keyword">Dim</span> buttons <span class="highlight-keyword">As</span> TaskDialogCommonButtons = TaskDialogCommonButtons.Ok <span class="highlight-keyword">Or</span> TaskDialogCommonButtons.Cancel
            taskDialog__1.CommonButtons = buttons

            <span class="highlight-keyword">If</span> TaskDialogResult.Ok = taskDialog__1.Show() <span class="highlight-keyword">Then</span>
                <span class="highlight-comment">' For many various reasons, a transaction may not be committed</span>
                <span class="highlight-comment">' if the changes made during the transaction do not result a valid model.</span>
                <span class="highlight-comment">' If committing a transaction fails or is canceled by the end user,</span>
                <span class="highlight-comment">' the resulting status would be RolledBack instead of Committed.</span>
                <span class="highlight-keyword">If</span> TransactionStatus.Committed &lt;&gt; transaction.Commit() <span class="highlight-keyword">Then</span>
                    TaskDialog.Show(<span class="highlight-literal">"Failure"</span>, <span class="highlight-literal">"Transaction could not be committed"</span>)
                <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
            <span class="highlight-keyword">Else</span>
                transaction.RollBack()
            <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
        <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">Using</span>
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span></pre></div><div id="IDACC_code_Div3" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div><div id="IDACC_code_Div4" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div></div></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Reference</h4><div><a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB Namespace</a></div></div></div></div>
        </div></body></html>