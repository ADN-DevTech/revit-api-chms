<html><head><title>AssemblyViewUtils Class</title><meta name="Title" content="AssemblyViewUtils Class" /><meta name="Microsoft.Help.Id" content="T:Autodesk.Revit.DB.AssemblyViewUtils" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="System.Keywords" content="Autodesk.Revit.DB.AssemblyViewUtils class" /><meta name="System.Keywords" content="AssemblyViewUtils class" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.DB.AssemblyViewUtils" /><meta name="Microsoft.Help.F1" content="AssemblyViewUtils" /><meta name="container" content="Autodesk.Revit.DB" /><meta name="file" content="4c839bed-9f56-c255-afba-8152c9171a22" /><meta name="guid" content="4c839bed-9f56-c255-afba-8152c9171a22" /><meta name="Microsoft.Help.Category" content="CSharp" /><meta name="Microsoft.Help.Category" content="VB" /><meta name="Description" content="Utilities that provide capabilities related to assembly view creation and validation." /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /></head><body onload="SetDefaultLanguage('cs');"><div class="pageBody"><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Assembly<wbr />View<wbr />Utils Class</h1></td></tr></table><div class="summary">
   Utilities that provide capabilities related to assembly view creation and validation.
</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDDA')" onkeypress="SectionExpandCollapse_CheckKey('IDDA', event)" tabindex="0"><img id="IDDAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Inheritance Hierarchy</span></div><div id="IDDASection" class="collapsibleSection"><a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">System<span id="LSTA5F541C6_0" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>Object</a><br />  <span class="selflink">Autodesk.Revit.DB<span id="LSTA5F541C6_1" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>AssemblyViewUtils</span><br /></div><br /><strong>Namespace:</strong> <a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB</a><br /><strong>Assembly:</strong> RevitAPI (in RevitAPI.dll) Version: 25.0.0.0 (25.0.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDB')" onkeypress="SectionExpandCollapse_CheckKey('IDB', event)" tabindex="0"><img id="IDBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="IDBSection" class="collapsibleSection"><div id="IDAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAB_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cs','1','4');return false;">C#</a></div><div id="IDAB_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','vb','2','4');return false;">VB</a></div><div id="IDAB_tab3" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cpp','3','4');return false;">C++</a></div><div id="IDAB_tab4" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAB');return false;" title="Copy">Copy</a></div></div><div id="IDAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="identifier">AssemblyViewUtils</span></pre></div><div id="IDAB_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">NotInheritable</span> <span class="keyword">Class</span> <span class="identifier">AssemblyViewUtils</span></pre></div><div id="IDAB_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">ref class</span> <span class="identifier">AssemblyViewUtils</span> <span class="keyword">abstract</span> <span class="keyword">sealed</span></pre></div><div id="IDAB_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve">[&lt;<span class="identifier">AbstractClassAttribute</span>&gt;]
[&lt;<span class="identifier">SealedAttribute</span>&gt;]
<span class="keyword">type</span> <span class="identifier">AssemblyViewUtils</span> = <span class="keyword">class</span> <span class="keyword">end</span></pre></div></div></div></div><p>The <span class="selflink">AssemblyViewUtils</span> type exposes the following members.</p><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDAEA')" onkeypress="SectionExpandCollapse_CheckKey('IDAEA', event)" tabindex="0"><img id="IDAEAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Methods</span></div><div id="IDAEASection" class="collapsibleSection"><table id="MethodList" class="members"><tr><th class="iconColumn"> </th><th>Name</th><th>Description</th></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /></td><td><a href="9d899efa-112e-b169-fde8-303f0967593d.htm">AcquireAssemblyViews</a></td><td>
   Transfers the assembly views owned by a source assembly instance to a target sibling assembly instance of the same assembly type.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /></td><td><a href="d1d13c59-ed2a-844a-5ad0-f195ee2d4a2f.htm">Create3DOrthographic(Document, ElementId)</a></td><td>
   Creates a new orthographic 3D assembly view for the assembly instance.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /></td><td><a href="f87603e2-81cb-34d0-0f57-b80e392ebee8.htm">Create3DOrthographic(Document, ElementId, ElementId, Boolean)</a></td><td>
   Creates a new orthographic 3D assembly view for the assembly instance.
   The view will have the same orientation as the Default 3D view.
   The document must be regenerated before using the 3D view.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /></td><td><a href="784df7d5-3da2-9a3d-fc5f-8b97ce019b23.htm">CreateDetailSection(Document, ElementId, AssemblyDetailViewOrientation)</a></td><td>
   Creates a new detail section assembly view for the assembly instance.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /></td><td><a href="d1dbb597-be46-0e7d-f173-af2e270831b9.htm">CreateDetailSection(Document, ElementId, AssemblyDetailViewOrientation, ElementId, Boolean)</a></td><td>
   Creates a new detail section assembly view for the assembly instance.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /></td><td><a href="6fbfacef-91b9-6ca3-9531-e3aa1ae9f834.htm">CreateMaterialTakeoff(Document, ElementId)</a></td><td>
   Creates a new material takeoff multicategory schedule assembly view for the assembly instance.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /></td><td><a href="4e0033ee-64ac-a6ab-71ce-4b58de63ffdc.htm">CreateMaterialTakeoff(Document, ElementId, ElementId, Boolean)</a></td><td>
   Creates a new material takeoff multicategory schedule assembly view for the assembly instance.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /></td><td><a href="a9c1ec3a-ceeb-a203-8c1d-9700b5aa9881.htm">CreatePartList(Document, ElementId)</a></td><td>
   Creates a new part list multicategory schedule assembly view for the assembly instance.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /></td><td><a href="c211c569-f7bc-8869-ea4d-71bbb4034748.htm">CreatePartList(Document, ElementId, ElementId, Boolean)</a></td><td>
   Creates a new part list multicategory schedule assembly view for the assembly instance.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /></td><td><a href="afd8688c-80d3-8c70-804c-0eed87eab8f3.htm">CreateSheet</a></td><td>
   Creates a new sheet assembly view for the assembly instance.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /></td><td><a href="32780a72-3d3a-10d2-fece-c7016a21b79b.htm">CreateSingleCategorySchedule(Document, ElementId, ElementId)</a></td><td>
   Creates a new single-category schedule assembly view for the assembly instance.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /></td><td><a href="935a90c4-80e7-7dd7-7f78-592e4f458d5e.htm">CreateSingleCategorySchedule(Document, ElementId, ElementId, ElementId, Boolean)</a></td><td>
   Creates a new single-category schedule assembly view for the assembly instance.
</td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDCC')" onkeypress="SectionExpandCollapse_CheckKey('IDCC', event)" tabindex="0"><img id="IDCCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Example</span></div><div id="IDCCSection" class="collapsibleSection"><div id="IDACC" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDACC_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDACC','cs','1','4');return false;">C#</a></div><div id="IDACC_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDACC','vb','2','4');return false;">VB</a></div><div id="IDACC_tab3" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDACC','cpp','3','4');return false;">C++</a></div><div id="IDACC_tab4" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDACC','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDACC_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDACC');return false;" title="Copy">Copy</a></div></div><div id="IDACC_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">private</span> ViewSchedule CreateScheduleForAssembly(Document doc, AssemblyInstance assemblyInstance, ElementId viewTemplateId)
{
    ViewSchedule schedule = <span class="highlight-keyword">null</span>;
    <span class="highlight-keyword">if</span> (assemblyInstance.AllowsAssemblyViewCreation()) <span class="highlight-comment">// create assembly views for this assembly instance</span>
    {
        <span class="highlight-keyword">using</span> (Transaction transaction = <span class="highlight-keyword">new</span> Transaction(doc))
        {
            transaction.Start(<span class="highlight-literal">"Create Schedule"</span>);

            <span class="highlight-comment">// use naming category for the schedule</span>
            <span class="highlight-keyword">if</span> (ViewSchedule.IsValidCategoryForSchedule(assemblyInstance.NamingCategoryId))
            {
                schedule = AssemblyViewUtils.CreateSingleCategorySchedule(doc, assemblyInstance.Id, assemblyInstance.NamingCategoryId, viewTemplateId, <span class="highlight-keyword">false</span>);
            }
            transaction.Commit();

            <span class="highlight-keyword">if</span> (schedule != <span class="highlight-keyword">null</span> &amp;&amp; transaction.GetStatus() == TransactionStatus.Committed)
            {
                transaction.Start(<span class="highlight-literal">"Edit Schedule"</span>);
                schedule.Name = <span class="highlight-literal">"AssemblyViewSchedule"</span>;
                transaction.Commit();
            }
        }
    }

    <span class="highlight-keyword">return</span> schedule;
}</pre></div><div id="IDACC_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="highlight-keyword">Private</span> <span class="highlight-keyword">Function</span> CreateScheduleForAssembly(doc <span class="highlight-keyword">As</span> Document, assemblyInstance <span class="highlight-keyword">As</span> AssemblyInstance, viewTemplateId <span class="highlight-keyword">As</span> ElementId) <span class="highlight-keyword">As</span> ViewSchedule
    <span class="highlight-keyword">Dim</span> schedule <span class="highlight-keyword">As</span> ViewSchedule = <span class="highlight-keyword">Nothing</span>
    <span class="highlight-keyword">If</span> assemblyInstance.AllowsAssemblyViewCreation() <span class="highlight-keyword">Then</span>
        <span class="highlight-comment">' create assembly views for this assembly instance</span>
        <span class="highlight-keyword">Using</span> transaction <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> Transaction(doc)
            transaction.Start(<span class="highlight-literal">"Create Schedule"</span>)

            <span class="highlight-comment">' use naming category for the schedule</span>
            <span class="highlight-keyword">If</span> ViewSchedule.IsValidCategoryForSchedule(assemblyInstance.NamingCategoryId) <span class="highlight-keyword">Then</span>
                schedule = AssemblyViewUtils.CreateSingleCategorySchedule(doc, assemblyInstance.Id, assemblyInstance.NamingCategoryId, viewTemplateId, <span class="highlight-keyword">False</span>)
            <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
            transaction.Commit()

            <span class="highlight-keyword">If</span> schedule <span class="highlight-keyword">IsNot</span> <span class="highlight-keyword">Nothing</span> <span class="highlight-keyword">AndAlso</span> transaction.GetStatus() = TransactionStatus.Committed <span class="highlight-keyword">Then</span>
                transaction.Start(<span class="highlight-literal">"Edit Schedule"</span>)
                schedule.Name = <span class="highlight-literal">"AssemblyViewSchedule"</span>
                transaction.Commit()
            <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
        <span class="highlight-keyword">End</span> <span class="highlight-keyword">Using</span>
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>

    <span class="highlight-keyword">Return</span> schedule
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Function</span>

<span class="highlight-keyword">Private</span> <span class="highlight-keyword">Function</span> IExternalCommand_Execute(commandData <span class="highlight-keyword">As</span> ExternalCommandData, <span class="highlight-keyword">ByRef</span> message <span class="highlight-keyword">As</span> <span class="highlight-keyword">String</span>, elements <span class="highlight-keyword">As</span> ElementSet) <span class="highlight-keyword">As</span> Result <span class="highlight-keyword">Implements</span> IExternalCommand.Execute
    <span class="highlight-keyword">Throw</span> <span class="highlight-keyword">New</span> NotImplementedException()
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Function</span></pre></div><div id="IDACC_code_Div3" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div><div id="IDACC_code_Div4" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div></div></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Reference</h4><div><a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB Namespace</a></div></div></div></div>
        </div></body></html>