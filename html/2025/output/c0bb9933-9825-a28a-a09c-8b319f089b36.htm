<html><head><title>FormattedText.SetListType Method</title><meta name="Title" content="SetListType Method" /><meta name="Microsoft.Help.Id" content="M:Autodesk.Revit.DB.FormattedText.SetListType(Autodesk.Revit.DB.TextRange,Autodesk.Revit.DB.ListType)" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="System.Keywords" content="FormattedText.SetListType method" /><meta name="System.Keywords" content="SetListType method" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.DB.FormattedText.SetListType" /><meta name="Microsoft.Help.F1" content="FormattedText.SetListType" /><meta name="Microsoft.Help.F1" content="SetListType" /><meta name="container" content="Autodesk.Revit.DB" /><meta name="file" content="c0bb9933-9825-a28a-a09c-8b319f089b36" /><meta name="guid" content="c0bb9933-9825-a28a-a09c-8b319f089b36" /><meta name="Microsoft.Help.Category" content="CSharp" /><meta name="Microsoft.Help.Category" content="VB" /><meta name="Description" content="Sets the of a paragraph." /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /></head><body onload="SetDefaultLanguage('cs');"><div class="pageBody"><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Formatted<wbr />Text<span id="LST7BC9D8_0" data-languageSpecificText="cpp=::|nu=."></span>Set<wbr />List<wbr />Type Method</h1></td></tr></table><div class="summary">
   Sets the <a href="7163554f-3446-22eb-afa4-5490d5df29c8.htm">ListType</a> of a paragraph.
</div><br /><strong>Namespace:</strong> <a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB</a><br /><strong>Assembly:</strong> RevitAPI (in RevitAPI.dll) Version: 25.0.0.0 (25.0.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDB')" onkeypress="SectionExpandCollapse_CheckKey('IDB', event)" tabindex="0"><img id="IDBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="IDBSection" class="collapsibleSection"><div id="IDAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAB_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cs','1','4');return false;">C#</a></div><div id="IDAB_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','vb','2','4');return false;">VB</a></div><div id="IDAB_tab3" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cpp','3','4');return false;">C++</a></div><div id="IDAB_tab4" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAB');return false;" title="Copy">Copy</a></div></div><div id="IDAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">void</span> <span class="identifier">SetListType</span>(
	<span class="identifier">TextRange</span> <span class="parameter">textRange</span>,
	<span class="identifier">ListType</span> <span class="parameter">listType</span>
)</pre></div><div id="IDAB_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Sub</span> <span class="identifier">SetListType</span> ( 
	<span class="parameter">textRange</span> <span class="keyword">As</span> <span class="identifier">TextRange</span>,
	<span class="parameter">listType</span> <span class="keyword">As</span> <span class="identifier">ListType</span>
)</pre></div><div id="IDAB_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="keyword">void</span> <span class="identifier">SetListType</span>(
	<span class="identifier">TextRange</span>^ <span class="parameter">textRange</span>, 
	<span class="identifier">ListType</span> <span class="parameter">listType</span>
)</pre></div><div id="IDAB_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">member</span> <span class="identifier">SetListType</span> : 
        <span class="parameter">textRange</span> : <span class="identifier">TextRange</span> * 
        <span class="parameter">listType</span> : <span class="identifier">ListType</span> <span class="keyword">-&gt;</span> <span class="keyword">unit</span> </pre></div></div></div><h4>Parameters</h4><dl><dt class="has-text-weight-normal"><span class="parameter">textRange</span>  <a href="8a00baaf-8cb8-d9f0-e0a0-eaa5aa16e55e.htm">TextRange</a></dt><dd>
   The given text range.
</dd><dt class="has-text-weight-normal"><span class="parameter">listType</span>  <a href="7163554f-3446-22eb-afa4-5490d5df29c8.htm">ListType</a></dt><dd>
   The <a href="7163554f-3446-22eb-afa4-5490d5df29c8.htm">ListType</a> to set on the paragraph.
</dd></dl></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDEC')" onkeypress="SectionExpandCollapse_CheckKey('IDEC', event)" tabindex="0"><img id="IDECToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Exceptions</span></div><div id="IDECSection" class="collapsibleSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="2e6e4206-97a8-dd4b-df5d-4269f4bb6088.htm">ArgumentException</a></td><td>
   This text range is empty.
   -or-
   This start index of this text range is not within the text range identifying the entire text.
   -or-
   The end of this text range is not within the text range identifying the entire text.
   -or-
   This list type is not valid to set on a paragraph.
</td></tr><tr><td><a href="631e1424-60f4-929b-4e52-dda9dcd26316.htm">ArgumentNullException</a></td><td>
   A non-optional argument was null
</td></tr><tr><td><a href="60f148c9-ece0-a6bb-4e12-bb4a9c8c8a24.htm">ArgumentOutOfRangeException</a></td><td>
   A value passed for an enumeration argument is not a member of that enumeration
</td></tr></table></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDBC')" onkeypress="SectionExpandCollapse_CheckKey('IDBC', event)" tabindex="0"><img id="IDBCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="IDBCSection" class="collapsibleSection"><p>
   This function applies the <a href="7163554f-3446-22eb-afa4-5490d5df29c8.htm">ListType</a>
   to all paragraphs contained in the given range.
   </p><p>
   The following <a href="7163554f-3446-22eb-afa4-5490d5df29c8.htm">ListType</a> options are available:
   <ul><li><a href="7163554f-3446-22eb-afa4-5490d5df29c8.htm">Bullet</a></li><li><a href="7163554f-3446-22eb-afa4-5490d5df29c8.htm">ArabicNumbers</a></li><li><a href="7163554f-3446-22eb-afa4-5490d5df29c8.htm">LowerCaseLetters</a></li><li><a href="7163554f-3446-22eb-afa4-5490d5df29c8.htm">UpperCaseLetters</a></li></ul></p><p>
   Set the list type to <a href="7163554f-3446-22eb-afa4-5490d5df29c8.htm">None</a>
   if the paragraph should not be in a list.
   </p><p>
   The list type cannot be set to <a href="7163554f-3446-22eb-afa4-5490d5df29c8.htm">Mixed</a>.
   </p><p>
   Paragraphs with a <a href="7163554f-3446-22eb-afa4-5490d5df29c8.htm">ListType</a> other than <a href="7163554f-3446-22eb-afa4-5490d5df29c8.htm">None</a> are considered
   to be 'list' paragraphs.
   </p><p>
   Consecutive list paragraphs with the same indentation level are treated as part of the same list.
   A list ends when a list paragraph is followed by
   <ul><li>a paragraph that has <a href="7163554f-3446-22eb-afa4-5490d5df29c8.htm">None</a></li><li>or a list paragraph that has a lower indentation level, (i.e. is indented less)</li></ul>
   Note that a list will continue uninterrupted after list paragraphs that have higher indentation level.
   These paragraphs are considered a 'sub-list'.
   Using <a href="a2e6561d-da40-b701-967f-aadbe6b153f5.htm">SetIndentLevel(TextRange, Int32)</a> it is therefore possible to create multi-level lists.
   Note that sub-lists can have their own sub-sub-lists.
   The nesting level is only limited by the maximum indent level.
   </p><p>
   FormattedText will keep lists consistent.
   That means that numbered paragraphs will automatically get sequential numbers or letters.
   It also means that if the list type of one paragraphs in the list
   is changed then that change is propagated to all the paragraphs in that list.
   Even if those paragraphs were not in the input text range.
   Note that this will not affect the list type of any nested sub-lists.
   </p><p>
   Use a vertical tab character ('\v') to insert a line without a bullet or number.
   Since this does not end the paragraph this will allow the list to continue to the next paragraph.
   </p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDIC')" onkeypress="SectionExpandCollapse_CheckKey('IDIC', event)" tabindex="0"><img id="IDICToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Example</span></div><div id="IDICSection" class="collapsibleSection"><div id="IDAIC" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAIC_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAIC','cs','1','4');return false;">C#</a></div><div id="IDAIC_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAIC','vb','2','4');return false;">VB</a></div><div id="IDAIC_tab3" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDAIC','cpp','3','4');return false;">C++</a></div><div id="IDAIC_tab4" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDAIC','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAIC_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAIC');return false;" title="Copy">Copy</a></div></div><div id="IDAIC_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-preprocessor">#region</span> Autodesk.Revit.DB.FormattedText.AsTextRange()
<span class="highlight-keyword">public</span> <span class="highlight-keyword">void</span> AppendText(TextNote textNote)
{
    FormattedText formatText = textNote.GetFormattedText();

    TextRange range = formatText.AsTextRange();

    range.Start = range.End - <span class="highlight-number">1</span>;
    <span class="highlight-comment">// set Length to 0 to insert</span>
    range.Length = <span class="highlight-number">0</span>;
    <span class="highlight-keyword">string</span> someNewText = <span class="highlight-literal">"\rThis is a new paragraph\vThis is a new line without a paragraph break\r"</span>;
    formatText.SetPlainText(range, someNewText);

    <span class="highlight-comment">// get range for entire text</span>
    range = formatText.AsTextRange();
    range.Start = range.End - <span class="highlight-number">1</span>;
    range.Length = <span class="highlight-number">0</span>;
    <span class="highlight-keyword">string</span> someListText = <span class="highlight-literal">"\rBulleted List item 1\rItem 2\vSecond line for Item 2\rThird bullet point"</span>;
    formatText.SetPlainText(range, someListText);
    range.Start++;
    range.Length = someListText.Length;
    formatText.SetListType(range, ListType.Bullet);

    <span class="highlight-keyword">if</span> (formatText.GetAllCapsStatus(range) != FormatStatus.None)
    {
        formatText.SetAllCapsStatus(range, <span class="highlight-keyword">false</span>);
    }

    textNote.SetFormattedText(formatText);
}
<span class="highlight-preprocessor">#endregion</span></pre></div><div id="IDAIC_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="highlight-preprocessor">#Region</span> <span class="highlight-literal">"Autodesk.Revit.DB.FormattedText.AsTextRange()"</span>
        <span class="highlight-keyword">Public</span> <span class="highlight-keyword">Sub</span> AppendText(textNote <span class="highlight-keyword">As</span> TextNote)
            <span class="highlight-keyword">Dim</span> formatText <span class="highlight-keyword">As</span> FormattedText = textNote.GetFormattedText()

            <span class="highlight-keyword">Dim</span> range <span class="highlight-keyword">As</span> TextRange = formatText.AsTextRange()

            range.Start = range.[<span class="highlight-keyword">End</span>] - <span class="highlight-number">1</span>
            <span class="highlight-comment">' set Length to 0 to insert</span>
            range.Length = <span class="highlight-number">0</span>
            <span class="highlight-keyword">Dim</span> someNewText <span class="highlight-keyword">As</span> <span class="highlight-keyword">String</span> = vbCr &amp; <span class="highlight-literal">"This is a new paragraph"</span> &amp; vbVerticalTab &amp; <span class="highlight-literal">"This is a new line without a paragraph break"</span> &amp; vbCr
            formatText.SetPlainText(range, someNewText)

            <span class="highlight-comment">' get range for entire text</span>
            range = formatText.AsTextRange()
            range.Start = range.[<span class="highlight-keyword">End</span>] - <span class="highlight-number">1</span>
            range.Length = <span class="highlight-number">0</span>
            <span class="highlight-keyword">Dim</span> someListText <span class="highlight-keyword">As</span> <span class="highlight-keyword">String</span> = vbCr &amp; <span class="highlight-literal">"Bulleted List item 1"</span> &amp; vbCr &amp; <span class="highlight-literal">"Item 2"</span> &amp; vbVerticalTab &amp; <span class="highlight-literal">"Second line for Item 2"</span> &amp; vbCr &amp; <span class="highlight-literal">"Third bullet point"</span>
            formatText.SetPlainText(range, someListText)
            range.Start += <span class="highlight-number">1</span>
            range.Length = someListText.Length
            formatText.SetListType(range, ListType.Bullet)

            <span class="highlight-keyword">If</span> formatText.GetAllCapsStatus(range) &lt;&gt; FormatStatus.None <span class="highlight-keyword">Then</span>
                formatText.SetAllCapsStatus(range, <span class="highlight-keyword">False</span>)
            <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>

            textNote.SetFormattedText(formatText)
        <span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span>
<span class="highlight-preprocessor">#End Region</span></pre></div><div id="IDAIC_code_Div3" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div><div id="IDAIC_code_Div4" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div></div></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Reference</h4><div><a href="79a92343-2342-8325-1b51-f12c4fb05481.htm">FormattedText Class</a></div><div><a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB Namespace</a></div></div></div></div>
        </div></body></html>