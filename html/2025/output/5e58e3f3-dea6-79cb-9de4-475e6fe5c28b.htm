<html><head><title>Rebar.CreateFromRebarShape Method</title><meta name="Title" content="CreateFromRebarShape Method" /><meta name="Microsoft.Help.Id" content="M:Autodesk.Revit.DB.Structure.Rebar.CreateFromRebarShape(Autodesk.Revit.DB.Document,Autodesk.Revit.DB.Structure.RebarShape,Autodesk.Revit.DB.Structure.RebarBarType,Autodesk.Revit.DB.Element,Autodesk.Revit.DB.XYZ,Autodesk.Revit.DB.XYZ,Autodesk.Revit.DB.XYZ)" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="System.Keywords" content="Rebar.CreateFromRebarShape method" /><meta name="System.Keywords" content="CreateFromRebarShape method" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.DB.Structure.Rebar.CreateFromRebarShape" /><meta name="Microsoft.Help.F1" content="Rebar.CreateFromRebarShape" /><meta name="Microsoft.Help.F1" content="CreateFromRebarShape" /><meta name="container" content="Autodesk.Revit.DB.Structure" /><meta name="file" content="5e58e3f3-dea6-79cb-9de4-475e6fe5c28b" /><meta name="guid" content="5e58e3f3-dea6-79cb-9de4-475e6fe5c28b" /><meta name="Microsoft.Help.Category" content="CSharp" /><meta name="Microsoft.Help.Category" content="VB" /><meta name="Description" content="Creates a new shape driven Rebar, as an instance of a RebarShape. The instance will have the default shape parameters from the RebarShape, and its location is based on the bounding box of the shape in the shape definition." /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /></head><body onload="SetDefaultLanguage('cs');"><div class="pageBody"><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Rebar<span id="LSTF4865420_0" data-languageSpecificText="cpp=::|nu=."></span>Create<wbr />From<wbr />Rebar<wbr />Shape Method</h1></td></tr></table><div class="summary">
   Creates a new shape driven Rebar, as an instance of a RebarShape.
   The instance will have the default shape parameters from the RebarShape,
   and its location is based on the bounding box of the shape in the shape definition.
   Hooks are removed from the shape before computing its bounding box.
   If appropriate hooks can be found in the document, they will be assigned arbitrarily.
</div><br /><strong>Namespace:</strong> <a href="d586b341-f687-9d90-e96d-255806b7d4fc.htm">Autodesk.Revit.DB.Structure</a><br /><strong>Assembly:</strong> RevitAPI (in RevitAPI.dll) Version: 25.0.0.0 (25.0.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDB')" onkeypress="SectionExpandCollapse_CheckKey('IDB', event)" tabindex="0"><img id="IDBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="IDBSection" class="collapsibleSection"><div id="IDAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAB_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cs','1','4');return false;">C#</a></div><div id="IDAB_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','vb','2','4');return false;">VB</a></div><div id="IDAB_tab3" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cpp','3','4');return false;">C++</a></div><div id="IDAB_tab4" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAB');return false;" title="Copy">Copy</a></div></div><div id="IDAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">Rebar</span> <span class="identifier">CreateFromRebarShape</span>(
	<span class="identifier">Document</span> <span class="parameter">doc</span>,
	<span class="identifier">RebarShape</span> <span class="parameter">rebarShape</span>,
	<span class="identifier">RebarBarType</span> <span class="parameter">barType</span>,
	<span class="identifier">Element</span> <span class="parameter">host</span>,
	<span class="identifier">XYZ</span> <span class="parameter">origin</span>,
	<span class="identifier">XYZ</span> <span class="parameter">xVec</span>,
	<span class="identifier">XYZ</span> <span class="parameter">yVec</span>
)</pre></div><div id="IDAB_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">CreateFromRebarShape</span> ( 
	<span class="parameter">doc</span> <span class="keyword">As</span> <span class="identifier">Document</span>,
	<span class="parameter">rebarShape</span> <span class="keyword">As</span> <span class="identifier">RebarShape</span>,
	<span class="parameter">barType</span> <span class="keyword">As</span> <span class="identifier">RebarBarType</span>,
	<span class="parameter">host</span> <span class="keyword">As</span> <span class="identifier">Element</span>,
	<span class="parameter">origin</span> <span class="keyword">As</span> <span class="identifier">XYZ</span>,
	<span class="parameter">xVec</span> <span class="keyword">As</span> <span class="identifier">XYZ</span>,
	<span class="parameter">yVec</span> <span class="keyword">As</span> <span class="identifier">XYZ</span>
) <span class="keyword">As</span> <span class="identifier">Rebar</span></pre></div><div id="IDAB_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="keyword">static</span> <span class="identifier">Rebar</span>^ <span class="identifier">CreateFromRebarShape</span>(
	<span class="identifier">Document</span>^ <span class="parameter">doc</span>, 
	<span class="identifier">RebarShape</span>^ <span class="parameter">rebarShape</span>, 
	<span class="identifier">RebarBarType</span>^ <span class="parameter">barType</span>, 
	<span class="identifier">Element</span>^ <span class="parameter">host</span>, 
	<span class="identifier">XYZ</span>^ <span class="parameter">origin</span>, 
	<span class="identifier">XYZ</span>^ <span class="parameter">xVec</span>, 
	<span class="identifier">XYZ</span>^ <span class="parameter">yVec</span>
)</pre></div><div id="IDAB_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">static</span> <span class="keyword">member</span> <span class="identifier">CreateFromRebarShape</span> : 
        <span class="parameter">doc</span> : <span class="identifier">Document</span> * 
        <span class="parameter">rebarShape</span> : <span class="identifier">RebarShape</span> * 
        <span class="parameter">barType</span> : <span class="identifier">RebarBarType</span> * 
        <span class="parameter">host</span> : <span class="identifier">Element</span> * 
        <span class="parameter">origin</span> : <span class="identifier">XYZ</span> * 
        <span class="parameter">xVec</span> : <span class="identifier">XYZ</span> * 
        <span class="parameter">yVec</span> : <span class="identifier">XYZ</span> <span class="keyword">-&gt;</span> <span class="identifier">Rebar</span> </pre></div></div></div><h4>Parameters</h4><dl><dt class="has-text-weight-normal"><span class="parameter">doc</span>  <a href="db03274b-a107-aa32-9034-f3e0df4bb1ec.htm">Document</a></dt><dd>
   A document.
</dd><dt class="has-text-weight-normal"><span class="parameter">rebarShape</span>  <a href="0a370e32-eaba-785e-7e1f-9330929525fc.htm">RebarShape</a></dt><dd>
   A RebarShape element that defines the shape of the rebar.
</dd><dt class="has-text-weight-normal"><span class="parameter">barType</span>  <a href="467b44cc-54e7-3ecf-07e1-ad15d05fe800.htm">RebarBarType</a></dt><dd>
   A RebarBarType element that defines bar diameter, bend radius and material of the rebar.
</dd><dt class="has-text-weight-normal"><span class="parameter">host</span>  <a href="eb16114f-69ea-f4de-0d0d-f7388b105a16.htm">Element</a></dt><dd>
   The element to which the rebar belongs. The element must support rebar hosting;
   <span class="noLink">[!:Autodesk::Revit::DB::Structure::RebarHostData]</span>.
</dd><dt class="has-text-weight-normal"><span class="parameter">origin</span>  <a href="c2fd995c-95c0-58fb-f5de-f3246cbc5600.htm">XYZ</a></dt><dd>
   The lower-left corner of the shape's bounding box will be placed at this point in the project.
</dd><dt class="has-text-weight-normal"><span class="parameter">xVec</span>  <a href="c2fd995c-95c0-58fb-f5de-f3246cbc5600.htm">XYZ</a></dt><dd>
   The x-axis in the shape definition will be mapped to this direction in the project.
</dd><dt class="has-text-weight-normal"><span class="parameter">yVec</span>  <a href="c2fd995c-95c0-58fb-f5de-f3246cbc5600.htm">XYZ</a></dt><dd>
   The y-axis in the shape definition will be mapped to this direction in the project.
</dd></dl><h4>Return Value</h4><a href="70fd7426-f4a4-591c-8c06-3c18dda45e7d.htm">Rebar</a><br />
   The newly created Rebar instance, or <span class="keyword"><span id="LSTF4865420_1" data-languageSpecificText="cpp=nullptr|vb=Nothing|nu=null"></span></span> if the operation fails.
</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDJC')" onkeypress="SectionExpandCollapse_CheckKey('IDJC', event)" tabindex="0"><img id="IDJCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Exceptions</span></div><div id="IDJCSection" class="collapsibleSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="2e6e4206-97a8-dd4b-df5d-4269f4bb6088.htm">ArgumentException</a></td><td>
   The element host was not found in the given document.
   -or-
   host is not a valid rebar host.
</td></tr><tr><td><a href="631e1424-60f4-929b-4e52-dda9dcd26316.htm">ArgumentNullException</a></td><td>
   A non-optional argument was null
</td></tr><tr><td><a href="60f148c9-ece0-a6bb-4e12-bb4a9c8c8a24.htm">ArgumentOutOfRangeException</a></td><td>
   xVec has zero length.
   -or-
   yVec has zero length.
</td></tr></table></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDNC')" onkeypress="SectionExpandCollapse_CheckKey('IDNC', event)" tabindex="0"><img id="IDNCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Example</span></div><div id="IDNCSection" class="collapsibleSection"><div id="IDANC" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDANC_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDANC','cs','1','4');return false;">C#</a></div><div id="IDANC_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDANC','vb','2','4');return false;">VB</a></div><div id="IDANC_tab3" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDANC','cpp','3','4');return false;">C++</a></div><div id="IDANC_tab4" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDANC','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDANC_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDANC');return false;" title="Copy">Copy</a></div></div><div id="IDANC_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-comment">// Create 2 adjacent rebars with the given RebarShape and RebarBarType</span>
<span class="highlight-keyword">private</span> List&lt;Rebar&gt; CreateRebar(Document doc, Wall wall, RebarShape barShape, RebarBarType barType)
{
    List&lt;Rebar&gt; newRebars = <span class="highlight-keyword">new</span> List&lt;Rebar&gt;();

    Rebar bar = Rebar.CreateFromRebarShape(doc, barShape, barType, wall, <span class="highlight-keyword">new</span> XYZ(<span class="highlight-number">2</span>, <span class="highlight-number">0</span>, <span class="highlight-number">2</span>), <span class="highlight-keyword">new</span> XYZ(<span class="highlight-number">1</span>, <span class="highlight-number">0</span>, <span class="highlight-number">0</span>), <span class="highlight-keyword">new</span> XYZ(<span class="highlight-number">0</span>, <span class="highlight-number">0</span>, <span class="highlight-number">1</span>));
    <span class="highlight-comment">// call regenerate so that the TotalLength will be calculated before the transaction is committed</span>
    doc.Regenerate();
    newRebars.Add(bar);

    <span class="highlight-comment">// add a second bar adjacent to the first one</span>
    <span class="highlight-keyword">double</span> barLength = bar.TotalLength;
    bar = Rebar.CreateFromRebarShape(doc, barShape, barType, wall, <span class="highlight-keyword">new</span> XYZ(<span class="highlight-number">2</span> + barLength, <span class="highlight-number">0</span>, <span class="highlight-number">2</span>), <span class="highlight-keyword">new</span> XYZ(<span class="highlight-number">1</span>, <span class="highlight-number">0</span>, <span class="highlight-number">0</span>), <span class="highlight-keyword">new</span> XYZ(<span class="highlight-number">0</span>, <span class="highlight-number">0</span>, <span class="highlight-number">1</span>));
    newRebars.Add(bar);

    <span class="highlight-keyword">return</span> newRebars;
}</pre></div><div id="IDANC_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="highlight-comment">' Create 2 adjacent rebars with the given RebarShape and RebarBarType</span>
<span class="highlight-keyword">Private</span> <span class="highlight-keyword">Function</span> CreateRebar(doc <span class="highlight-keyword">As</span> Document, wall <span class="highlight-keyword">As</span> Wall, barShape <span class="highlight-keyword">As</span> RebarShape, barType <span class="highlight-keyword">As</span> RebarBarType) <span class="highlight-keyword">As</span> List(<span class="highlight-keyword">Of</span> Rebar)
    <span class="highlight-keyword">Dim</span> newRebars <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> List(<span class="highlight-keyword">Of</span> Rebar)()

    <span class="highlight-keyword">Dim</span> bar <span class="highlight-keyword">As</span> Rebar = Rebar.CreateFromRebarShape(doc, barShape, barType, wall, <span class="highlight-keyword">New</span> XYZ(<span class="highlight-number">2</span>, <span class="highlight-number">0</span>, <span class="highlight-number">2</span>), <span class="highlight-keyword">New</span> XYZ(<span class="highlight-number">1</span>, <span class="highlight-number">0</span>, <span class="highlight-number">0</span>), _
        <span class="highlight-keyword">New</span> XYZ(<span class="highlight-number">0</span>, <span class="highlight-number">0</span>, <span class="highlight-number">1</span>))
    <span class="highlight-comment">' call regenerate so that the TotalLength will be calculated before the transaction is committed</span>
    doc.Regenerate()
    newRebars.Add(bar)

    <span class="highlight-comment">' add a second bar adjacent to the first one</span>
    <span class="highlight-keyword">Dim</span> barLength <span class="highlight-keyword">As</span> <span class="highlight-keyword">Double</span> = bar.TotalLength
    bar = Rebar.CreateFromRebarShape(doc, barShape, barType, wall, <span class="highlight-keyword">New</span> XYZ(<span class="highlight-number">2</span> + barLength, <span class="highlight-number">0</span>, <span class="highlight-number">2</span>), <span class="highlight-keyword">New</span> XYZ(<span class="highlight-number">1</span>, <span class="highlight-number">0</span>, <span class="highlight-number">0</span>), _
        <span class="highlight-keyword">New</span> XYZ(<span class="highlight-number">0</span>, <span class="highlight-number">0</span>, <span class="highlight-number">1</span>))
    newRebars.Add(bar)

    <span class="highlight-keyword">Return</span> newRebars
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Function</span></pre></div><div id="IDANC_code_Div3" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div><div id="IDANC_code_Div4" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div></div></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Reference</h4><div><a href="70fd7426-f4a4-591c-8c06-3c18dda45e7d.htm">Rebar Class</a></div><div><a href="d586b341-f687-9d90-e96d-255806b7d4fc.htm">Autodesk.Revit.DB.Structure Namespace</a></div></div></div></div>
        </div></body></html>