<html><head><title>SpatialFieldManager.AddSpatialFieldPrimitive(Face, Transform) Method</title><meta name="Title" content="AddSpatialFieldPrimitive(Face, Transform) Method" /><meta name="Microsoft.Help.Id" content="M:Autodesk.Revit.DB.Analysis.SpatialFieldManager.AddSpatialFieldPrimitive(Autodesk.Revit.DB.Face,Autodesk.Revit.DB.Transform)" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="container" content="Autodesk.Revit.DB.Analysis" /><meta name="file" content="df9a1bc5-a719-e714-1ecd-0d88d6216000" /><meta name="guid" content="df9a1bc5-a719-e714-1ecd-0d88d6216000" /><meta name="Microsoft.Help.Category" content="CSharp" /><meta name="Microsoft.Help.Category" content="VB" /><meta name="Description" content="Creates empty analysis results primitive associated with a face and a transform." /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /></head><body onload="SetDefaultLanguage('cs');"><div class="pageBody"><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Spatial<wbr />Field<wbr />Manager<span id="LSTF2866E77_0" data-languageSpecificText="cpp=::|nu=."></span>Add<wbr />Spatial<wbr />Field<wbr />Primitive(Face, Transform) Method</h1></td></tr></table><div class="summary">
   Creates empty analysis results primitive associated with a face and a transform.
</div><br /><strong>Namespace:</strong> <a href="958e2e12-587d-f188-5d7b-f13d7dbfdf48.htm">Autodesk.Revit.DB.Analysis</a><br /><strong>Assembly:</strong> RevitAPI (in RevitAPI.dll) Version: 25.0.0.0 (25.0.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDB')" onkeypress="SectionExpandCollapse_CheckKey('IDB', event)" tabindex="0"><img id="IDBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="IDBSection" class="collapsibleSection"><div id="IDAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAB_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cs','1','4');return false;">C#</a></div><div id="IDAB_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','vb','2','4');return false;">VB</a></div><div id="IDAB_tab3" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cpp','3','4');return false;">C++</a></div><div id="IDAB_tab4" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAB');return false;" title="Copy">Copy</a></div></div><div id="IDAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="identifier">int</span> <span class="identifier">AddSpatialFieldPrimitive</span>(
	<span class="identifier">Face</span> <span class="parameter">face</span>,
	<span class="identifier">Transform</span> <span class="parameter">trf</span>
)</pre></div><div id="IDAB_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Function</span> <span class="identifier">AddSpatialFieldPrimitive</span> ( 
	<span class="parameter">face</span> <span class="keyword">As</span> <span class="identifier">Face</span>,
	<span class="parameter">trf</span> <span class="keyword">As</span> <span class="identifier">Transform</span>
) <span class="keyword">As</span> <span class="identifier">Integer</span></pre></div><div id="IDAB_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="identifier">int</span> <span class="identifier">AddSpatialFieldPrimitive</span>(
	<span class="identifier">Face</span>^ <span class="parameter">face</span>, 
	<span class="identifier">Transform</span>^ <span class="parameter">trf</span>
)</pre></div><div id="IDAB_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">member</span> <span class="identifier">AddSpatialFieldPrimitive</span> : 
        <span class="parameter">face</span> : <span class="identifier">Face</span> * 
        <span class="parameter">trf</span> : <span class="identifier">Transform</span> <span class="keyword">-&gt;</span> <span class="identifier">int</span> </pre></div></div></div><h4>Parameters</h4><dl><dt class="has-text-weight-normal"><span class="parameter">face</span>  <a href="e32b3b1f-66fc-57cb-6e1c-aa81d1bf3e63.htm">Face</a></dt><dd>
   Face to be associated with the primitive
</dd><dt class="has-text-weight-normal"><span class="parameter">trf</span>  <a href="58dd01c8-b3fc-7142-e4f3-c524079a282d.htm">Transform</a></dt><dd>
   Conformal Transform to be applied to %face%
</dd></dl><h4>Return Value</h4><a href="https://learn.microsoft.com/dotnet/api/system.int32" target="_blank" rel="noopener noreferrer">Int32</a><br />
   Unique index of primitive for future references
</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDFC')" onkeypress="SectionExpandCollapse_CheckKey('IDFC', event)" tabindex="0"><img id="IDFCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Exceptions</span></div><div id="IDFCSection" class="collapsibleSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="631e1424-60f4-929b-4e52-dda9dcd26316.htm">ArgumentNullException</a></td><td>
   A non-optional argument was null
</td></tr><tr><td><a href="60f148c9-ece0-a6bb-4e12-bb4a9c8c8a24.htm">ArgumentOutOfRangeException</a></td><td>
   trf is not conformal.
</td></tr></table></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDBC')" onkeypress="SectionExpandCollapse_CheckKey('IDBC', event)" tabindex="0"><img id="IDBCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="IDBCSection" class="collapsibleSection"><p> This method accepts a reference to a model face, and a transform to be applied to
   that face, allowing the display of analytical results on faces which are not
   strictly a part of the Revit model. </p><p>This method should not be used if the transform is the identity transform,
   i.e. the intent is to display results on a face which is part of the Revit model.
   In that case, use the overload of this method which accepts
   a reference.</p><p> If the input face is from the geometry of a symbol, the face will be considered to be
   in the location specified by its symbol geometry. If your intention is to transform the face
   relative to its location in the instance, your input transform must consist of the instance's
   transform left multiplied by the extra transform to get the results you expect.</p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDIC')" onkeypress="SectionExpandCollapse_CheckKey('IDIC', event)" tabindex="0"><img id="IDICToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Example</span></div><div id="IDICSection" class="collapsibleSection"><div id="IDAIC" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAIC_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAIC','cs','1','4');return false;">C#</a></div><div id="IDAIC_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAIC','vb','2','4');return false;">VB</a></div><div id="IDAIC_tab3" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDAIC','cpp','3','4');return false;">C++</a></div><div id="IDAIC_tab4" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDAIC','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAIC_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAIC');return false;" title="Copy">Copy</a></div></div><div id="IDAIC_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-comment">// Create SpatialFieldPrimitive to display results offset from a face</span>
BoundingBoxUV bb = face.GetBoundingBox();
UV min = bb.Min;
UV max = bb.Max;

<span class="highlight-comment">// Find the face normal at the center of the face's bounding box</span>
UV faceCenter = <span class="highlight-keyword">new</span> UV((max.U + min.U) / <span class="highlight-number">2</span>, (max.V + min.V) / <span class="highlight-number">2</span>);
Transform computeDerivatives = face.ComputeDerivatives(faceCenter);
XYZ faceCenterNormal = computeDerivatives.BasisZ;

<span class="highlight-comment">// Normalize the normal vector and multiply by 2.5 </span>
XYZ faceCenterNormalMultiplied = faceCenterNormal.Normalize().Multiply(<span class="highlight-number">2.5</span>);
Transform transform = Transform.CreateTranslation(faceCenterNormalMultiplied);

<span class="highlight-comment">// Use face and transform when adding the SpatialFieldPrimitive</span>
SpatialFieldManager sfm = SpatialFieldManager.CreateSpatialFieldManager(doc.ActiveView, <span class="highlight-number">3</span>);
<span class="highlight-keyword">int</span> idx = sfm.AddSpatialFieldPrimitive(face, transform);</pre></div><div id="IDAIC_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="highlight-comment">' Create SpatialFieldPrimitive to display results offset from a face</span>
<span class="highlight-keyword">Dim</span> bb <span class="highlight-keyword">As</span> BoundingBoxUV = face.GetBoundingBox()
<span class="highlight-keyword">Dim</span> min <span class="highlight-keyword">As</span> UV = bb.Min
<span class="highlight-keyword">Dim</span> max <span class="highlight-keyword">As</span> UV = bb.Max

<span class="highlight-comment">' Find the face normal at the center of the face's bounding box</span>
<span class="highlight-keyword">Dim</span> faceCenter <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> UV((max.U + min.U) / <span class="highlight-number">2</span>, (max.V + min.V) / <span class="highlight-number">2</span>)
<span class="highlight-keyword">Dim</span> computeDerivatives <span class="highlight-keyword">As</span> Transform = face.ComputeDerivatives(faceCenter)
<span class="highlight-keyword">Dim</span> faceCenterNormal <span class="highlight-keyword">As</span> XYZ = computeDerivatives.BasisZ

<span class="highlight-comment">' Normalize the normal vector and multiply by 2.5 </span>
<span class="highlight-keyword">Dim</span> faceCenterNormalMultiplied <span class="highlight-keyword">As</span> XYZ = faceCenterNormal.Normalize().Multiply(<span class="highlight-number">2.5</span>)
<span class="highlight-keyword">Dim</span> transform__1 <span class="highlight-keyword">As</span> Transform = Transform.CreateTranslation(faceCenterNormalMultiplied)

<span class="highlight-comment">' Use face and transform when adding the SpatialFieldPrimitive</span>
<span class="highlight-keyword">Dim</span> sfm <span class="highlight-keyword">As</span> SpatialFieldManager = SpatialFieldManager.CreateSpatialFieldManager(doc.ActiveView, <span class="highlight-number">3</span>)
<span class="highlight-keyword">Dim</span> idx <span class="highlight-keyword">As</span> <span class="highlight-keyword">Integer</span> = sfm.AddSpatialFieldPrimitive(face, transform__1)</pre></div><div id="IDAIC_code_Div3" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div><div id="IDAIC_code_Div4" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div></div></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Reference</h4><div><a href="0a6d155e-6ef1-7215-f8f1-c1d8203797ee.htm">SpatialFieldManager Class</a></div><div><a href="125b85d3-9b44-c90d-2eab-7334be74117f.htm">AddSpatialFieldPrimitive Overload</a></div><div><a href="958e2e12-587d-f188-5d7b-f13d7dbfdf48.htm">Autodesk.Revit.DB.Analysis Namespace</a></div></div></div></div>
        </div></body></html>