<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="Microsoft.Help.SelfBranded" content="true" /><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Locale" content="en-us" /><meta name="Microsoft.Help.TopicLocale" content="en-us" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"></script><title>ExternalService.AddServer Method</title><meta name="Title" content="AddServer Method" /><meta name="Microsoft.Help.Id" content="M:Autodesk.Revit.DB.ExternalService.ExternalService.AddServer(Autodesk.Revit.DB.ExternalService.IExternalServer)" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="System.Keywords" content="ExternalService.AddServer method" /><meta name="System.Keywords" content="AddServer method" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.DB.ExternalService.ExternalService.AddServer" /><meta name="Microsoft.Help.F1" content="ExternalService.AddServer" /><meta name="Microsoft.Help.F1" content="AddServer" /><meta name="container" content="Autodesk.Revit.DB.ExternalService" /><meta name="file" content="6e60c7f3-83f3-dca5-745c-efd995421369" /><meta name="guid" content="6e60c7f3-83f3-dca5-745c-efd995421369" /><meta name="Description" content="Registers a server with its service." /><link rel="stylesheet" type="text/css" href="../styles/branding-Help1.css" /></head><body onload="SetDefaultLanguage('cs');"><input type="hidden" id="userDataCache" class="userDataStyle" /><div id="PageHeader" class="pageHeader">Revit 2025 API</div><div class="pageBody"><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>External<wbr />Service<span id="LST74C83780_0" data-languageSpecificText="cpp=::|nu=."></span>Add<wbr />Server Method</h1></td></tr></table><div class="summary">
   Registers a server with its service.
</div><br /><strong>Namespace:</strong> <a href="a88f2d1d-c02f-a901-9543-44e4b5dd5fc9.htm">Autodesk.Revit.DB.ExternalService</a><br /><strong>Assembly:</strong> RevitAPI (in RevitAPI.dll) Version: 25.0.0.0 (25.0.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDB')" onkeypress="SectionExpandCollapse_CheckKey('IDB', event)" tabindex="0"><img id="IDBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="IDBSection" class="collapsibleSection"><div id="IDAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAB_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cs','1','4');return false;">C#</a></div><div id="IDAB_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','vb','2','4');return false;">VB</a></div><div id="IDAB_tab3" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cpp','3','4');return false;">C++</a></div><div id="IDAB_tab4" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAB');return false;" title="Copy">Copy</a></div></div><div id="IDAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">void</span> <span class="identifier">AddServer</span>(
	<span class="identifier">IExternalServer</span> <span class="parameter">server</span>
)</pre></div><div id="IDAB_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Sub</span> <span class="identifier">AddServer</span> ( 
	<span class="parameter">server</span> <span class="keyword">As</span> <span class="identifier">IExternalServer</span>
)</pre></div><div id="IDAB_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="keyword">void</span> <span class="identifier">AddServer</span>(
	<span class="identifier">IExternalServer</span>^ <span class="parameter">server</span>
)</pre></div><div id="IDAB_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">member</span> <span class="identifier">AddServer</span> : 
        <span class="parameter">server</span> : <span class="identifier">IExternalServer</span> <span class="keyword">-&gt;</span> <span class="keyword">unit</span> </pre></div></div></div><h4>Parameters</h4><dl><dt class="has-text-weight-normal"><span class="parameter">server</span>  <a href="91e4af0b-59c0-d640-107a-eebc4d99fa76.htm">IExternalServer</a></dt><dd>
   The instance of the server. The server must implement the interface provided by the service.
</dd></dl></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDDC')" onkeypress="SectionExpandCollapse_CheckKey('IDDC', event)" tabindex="0"><img id="IDDCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Exceptions</span></div><div id="IDDCSection" class="collapsibleSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="2e6e4206-97a8-dd4b-df5d-4269f4bb6088.htm">ArgumentException</a></td><td>
   The Server object is not valid or its service Id does not match the service.
   -or-
   A server with the same Id has already been registered with the service.
   -or-
   The given server does not return valid values from the interface methods.
   At least one of the Name, VendorId, Description, and ServerId is empty or invalid.
   -or-
   The server does not represent a server of a valid type to be used with the service.
</td></tr><tr><td><a href="631e1424-60f4-929b-4e52-dda9dcd26316.htm">ArgumentNullException</a></td><td>
   A non-optional argument was null
</td></tr><tr><td><a href="9e715f03-3884-e539-4dd6-8d7545733adc.htm">InvalidOperationException</a></td><td>
   The operation is not allowed because the service is being executed.
   -or-
   The service provider is not valid.
   -or-
   Only one server can be added for a single-server service.
</td></tr></table></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDBC')" onkeypress="SectionExpandCollapse_CheckKey('IDBC', event)" tabindex="0"><img id="IDBCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="IDBCSection" class="collapsibleSection"><p>
   Servers must be registered with their services. There has to be at least one server
   registered for a service in order to be able to execute the service.
   </p><p>
   A server can be added only once. An attempt to add a server again will lead to an exception.
   A server cannot be removed during the service's execution or when another server is just being
   added or removed (e.g. during OnServersChanged call-back to the service).
   </p><p>
   When <a href="fd61e375-683b-57e1-c902-29a5fe74e7d5.htm">SupportActivation</a>
   is set to true adding a server to a service does not make the server active yet. It is the developer's
   responsibility to change its activation state.
   </p><p>
   When <a href="fd61e375-683b-57e1-c902-29a5fe74e7d5.htm">SupportActivation</a>
   is set to false, for a single-server service there can be added only one server, and this will be
   considered active. An attempt to add another one will lead to an exception. For a multi-server service
   there can be added multiple servers and all of them will be considered activated.
   </p><p>
   Servers can be registered at any time; registering does not need to happen during an application's
   start-up, but it must happen - naturally - after the respective service has been registered.
   Since all built-in services are automatically registered during initialization of Revit, their servers
   can be added as early as during the OnStartup method. Third-party services, on the other hand, get
   registered during the OnStartup method, therefore their servers need to be added later. The next
   earliest opportunity for adding servers to a third-party service is on the ApplicationInitialized event.
   </p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Reference</h4><div><a href="0408e6d9-12d3-20e4-911e-6d299fe31b81.htm">ExternalService Class</a></div><div><a href="a88f2d1d-c02f-a901-9543-44e4b5dd5fc9.htm">Autodesk.Revit.DB.ExternalService Namespace</a></div></div></div></div><div id="PageFooter" class="pageFooter"><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:revitapifeedback%40autodesk.com?Subject=Revit%202025%20API">Autodesk</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        </script></div></body></html>