<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="Microsoft.Help.SelfBranded" content="true" /><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Locale" content="en-us" /><meta name="Microsoft.Help.TopicLocale" content="en-us" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"></script><title>Selection.PickObjects(ObjectType, ISelectionFilter, String) Method</title><meta name="Title" content="PickObjects(ObjectType, ISelectionFilter, String) Method" /><meta name="Microsoft.Help.Id" content="M:Autodesk.Revit.UI.Selection.Selection.PickObjects(Autodesk.Revit.UI.Selection.ObjectType,Autodesk.Revit.UI.Selection.ISelectionFilter,System.String)" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="container" content="Autodesk.Revit.UI.Selection" /><meta name="file" content="25aad159-e19d-82d9-f02d-043cc9905163" /><meta name="guid" content="25aad159-e19d-82d9-f02d-043cc9905163" /><meta name="Microsoft.Help.Category" content="CSharp" /><meta name="Microsoft.Help.Category" content="VB" /><meta name="Description" content="Prompts the user to select multiple objects which pass a custom filter while showing a custom status prompt string." /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Help1.css" /></head><body onload="SetDefaultLanguage('cs');"><input type="hidden" id="userDataCache" class="userDataStyle" /><div id="PageHeader" class="pageHeader">Revit 2025 API</div><div class="pageBody"><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Selection<span id="LST365B000B_0" data-languageSpecificText="cpp=::|nu=."></span>Pick<wbr />Objects(Object<wbr />Type, ISelection<wbr />Filter, String) Method</h1></td></tr></table><div class="summary">Prompts the user to select multiple objects which pass a custom filter while showing a custom status prompt string.</div><br /><strong>Namespace:</strong> <a href="11785869-cc9e-03fc-97db-767a59af10a1.htm">Autodesk.Revit.UI.Selection</a><br /><strong>Assembly:</strong> RevitAPIUI (in RevitAPIUI.dll) Version: 25.0.0.0 (25.0.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDB')" onkeypress="SectionExpandCollapse_CheckKey('IDB', event)" tabindex="0"><img id="IDBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="IDBSection" class="collapsibleSection"><div id="IDAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAB_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cs','1','4');return false;">C#</a></div><div id="IDAB_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','vb','2','4');return false;">VB</a></div><div id="IDAB_tab3" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cpp','3','4');return false;">C++</a></div><div id="IDAB_tab4" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAB');return false;" title="Copy">Copy</a></div></div><div id="IDAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="identifier">IList</span>&lt;<span class="identifier">Reference</span>&gt; <span class="identifier">PickObjects</span>(
	<span class="identifier">ObjectType</span> <span class="parameter">objectType</span>,
	<span class="identifier">ISelectionFilter</span> <span class="parameter">selectionFilter</span>,
	<span class="identifier">string</span> <span class="parameter">statusPrompt</span>
)</pre></div><div id="IDAB_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Function</span> <span class="identifier">PickObjects</span> ( 
	<span class="parameter">objectType</span> <span class="keyword">As</span> <span class="identifier">ObjectType</span>,
	<span class="parameter">selectionFilter</span> <span class="keyword">As</span> <span class="identifier">ISelectionFilter</span>,
	<span class="parameter">statusPrompt</span> <span class="keyword">As</span> <span class="identifier">String</span>
) <span class="keyword">As</span> <span class="identifier">IList</span>(<span class="keyword">Of</span> <span class="identifier">Reference</span>)</pre></div><div id="IDAB_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="identifier">IList</span>&lt;<span class="identifier">Reference</span>^&gt;^ <span class="identifier">PickObjects</span>(
	<span class="identifier">ObjectType</span> <span class="parameter">objectType</span>, 
	<span class="identifier">ISelectionFilter</span>^ <span class="parameter">selectionFilter</span>, 
	<span class="identifier">String</span>^ <span class="parameter">statusPrompt</span>
)</pre></div><div id="IDAB_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">member</span> <span class="identifier">PickObjects</span> : 
        <span class="parameter">objectType</span> : <span class="identifier">ObjectType</span> * 
        <span class="parameter">selectionFilter</span> : <span class="identifier">ISelectionFilter</span> * 
        <span class="parameter">statusPrompt</span> : <span class="identifier">string</span> <span class="keyword">-&gt;</span> <span class="identifier">IList</span>&lt;<span class="identifier">Reference</span>&gt; </pre></div></div></div><h4>Parameters</h4><dl><dt class="has-text-weight-normal"><span class="parameter">objectType</span>  <a href="2d0cbbba-d4ab-84b7-b081-36c14769d82c.htm">ObjectType</a></dt><dd>Specifies the type of object to be selected.</dd><dt class="has-text-weight-normal"><span class="parameter">selectionFilter</span>  <a href="d552f44b-221c-0ecd-d001-41a5099b2f9f.htm">ISelectionFilter</a></dt><dd>The selection filter.</dd><dt class="has-text-weight-normal"><span class="parameter">statusPrompt</span>  <a href="https://learn.microsoft.com/dotnet/api/system.string" target="_blank" rel="noopener noreferrer">String</a></dt><dd>The message shown on the status bar.</dd></dl><h4>Return Value</h4><a href="https://learn.microsoft.com/dotnet/api/system.collections.generic.ilist-1" target="_blank" rel="noopener noreferrer">IList</a><span id="LST365B000B_1" data-languageSpecificText="cpp=&lt;|cs=&lt;|fs=&lt;|vb=(Of |nu=("></span><a href="d28155ae-817b-1f31-9c3f-c9c6a28acc0d.htm">Reference</a><span id="LST365B000B_2" data-languageSpecificText="cpp=&gt;|cs=&gt;|fs=&gt;|vb=)|nu=)"></span><br /><p>A collection of references selected by the user.</p><p>Note: if the user cancels the operation (for example, through ESC), the method will throw an OperationCanceledException instance. </p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDFC')" onkeypress="SectionExpandCollapse_CheckKey('IDFC', event)" tabindex="0"><img id="IDFCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Exceptions</span></div><div id="IDFCSection" class="collapsibleSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="60f148c9-ece0-a6bb-4e12-bb4a9c8c8a24.htm">ArgumentOutOfRangeException</a></td><td>Thrown when the objectType is not a recognized value.</td></tr><tr><td><a href="631e1424-60f4-929b-4e52-dda9dcd26316.htm">ArgumentNullException</a></td><td>Thrown when the selectionFilter is <span class="keyword"><span id="LST365B000B_3" data-languageSpecificText="cpp=nullptr|vb=Nothing|nu=null"></span></span> or statusPrompt is <span class="keyword"><span id="LST365B000B_4" data-languageSpecificText="cpp=nullptr|vb=Nothing|nu=null"></span></span>.</td></tr><tr><td><a href="aea34480-ceb5-b49f-129d-0799e7bb1c21.htm">OperationCanceledException</a></td><td>Thrown when the Revit user cancelled this operation. 
Thrown when the Revit user tried to switch the active view, close the active document or Revit application when responding to this mode.</td></tr><tr><td><a href="c5b911f6-1e8f-2cd4-6965-286f41221fe0.htm">ForbiddenForDynamicUpdateException</a></td><td>Thrown if this method is called during dynamic update.</td></tr></table></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDEC')" onkeypress="SectionExpandCollapse_CheckKey('IDEC', event)" tabindex="0"><img id="IDECToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="IDECSection" class="collapsibleSection"><p>The user will be shown "Finish" and "Cancel" buttons on the dialog bar to complete the selection operation. 
Uncheck the "Multiple" check-box to select single object and it will return the selected object directly.</p><p>Revit users will be permitted to manipulate the Revit view (zooming, panning, and rotating the view), 
but will not be permitted to click other items in the Revit user interface. 
Users are not permitted to switch the active view, close the active document or Revit application in the pick session, otherwise an exception will be thrown.</p><p>The selection will not be automatically added to the active selection buffer.</p><p>Note: this method must not be called during dynamic update, otherwise ForbiddenForDynamicUpdateException will be thrown.</p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDKC')" onkeypress="SectionExpandCollapse_CheckKey('IDKC', event)" tabindex="0"><img id="IDKCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Example</span></div><div id="IDKCSection" class="collapsibleSection"><div id="IDAKC" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAKC_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAKC','cs','1','4');return false;">C#</a></div><div id="IDAKC_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAKC','vb','2','4');return false;">VB</a></div><div id="IDAKC_tab3" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDAKC','cpp','3','4');return false;">C++</a></div><div id="IDAKC_tab4" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDAKC','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAKC_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAKC');return false;" title="Copy">Copy</a></div></div><div id="IDAKC_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">public</span> <span class="highlight-keyword">void</span> SelectPlanarFaces(Autodesk.Revit.DB.Document document)
{
    UIDocument uidoc = <span class="highlight-keyword">new</span> UIDocument(document);
    ISelectionFilter selFilter = <span class="highlight-keyword">new</span> PlanarFacesSelectionFilter(document);
    IList&lt;Reference&gt; faces = uidoc.Selection.PickObjects(ObjectType.Face, selFilter, <span class="highlight-literal">"Select multiple planar faces"</span>);
}

<span class="highlight-keyword">public</span> <span class="highlight-keyword">class</span> PlanarFacesSelectionFilter : ISelectionFilter
{
    Document doc = <span class="highlight-keyword">null</span>;
    <span class="highlight-keyword">public</span> PlanarFacesSelectionFilter(Document document)
    {
        doc = document;
    }

    <span class="highlight-keyword">public</span> <span class="highlight-keyword">bool</span> AllowElement(Element element)
    {
        <span class="highlight-keyword">return</span> <span class="highlight-keyword">true</span>;
    }

    <span class="highlight-keyword">public</span> <span class="highlight-keyword">bool</span> AllowReference(Reference refer, XYZ point)
    {   
        <span class="highlight-keyword">if</span> (doc.GetElement(refer).GetGeometryObjectFromReference(refer) <span class="highlight-keyword">is</span> PlanarFace)
        {
            <span class="highlight-keyword">return</span> <span class="highlight-keyword">true</span>; <span class="highlight-comment">// Only return true for planar faces. Non-planar faces will not be selectable</span>
        }
        <span class="highlight-keyword">return</span> <span class="highlight-keyword">false</span>;
    }
}</pre></div><div id="IDAKC_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="highlight-keyword">Public</span> <span class="highlight-keyword">Sub</span> SelectPlanarFaces(document <span class="highlight-keyword">As</span> Autodesk.Revit.DB.Document)
    <span class="highlight-keyword">Dim</span> uidoc <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> UIDocument(document)
    <span class="highlight-keyword">Dim</span> selFilter <span class="highlight-keyword">As</span> ISelectionFilter = <span class="highlight-keyword">New</span> PlanarFacesSelectionFilter(document)
    <span class="highlight-keyword">Dim</span> faces <span class="highlight-keyword">As</span> IList(<span class="highlight-keyword">Of</span> Reference) = uidoc.Selection.PickObjects(ObjectType.Face, selFilter, <span class="highlight-literal">"Select multiple planar faces"</span>)
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span>

<span class="highlight-keyword">Public</span> <span class="highlight-keyword">Class</span> PlanarFacesSelectionFilter
    <span class="highlight-keyword">Implements</span> ISelectionFilter
    <span class="highlight-keyword">Private</span> doc <span class="highlight-keyword">As</span> Document = <span class="highlight-keyword">Nothing</span>
    <span class="highlight-keyword">Public</span> <span class="highlight-keyword">Sub</span> <span class="highlight-keyword">New</span>(document <span class="highlight-keyword">As</span> Document)
        doc = document
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span>

    <span class="highlight-keyword">Public</span> <span class="highlight-keyword">Function</span> AllowElement(element <span class="highlight-keyword">As</span> Element) <span class="highlight-keyword">As</span> <span class="highlight-keyword">Boolean</span> <span class="highlight-keyword">Implements</span> ISelectionFilter.AllowElement
        <span class="highlight-keyword">Return</span> <span class="highlight-keyword">True</span>
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">Function</span>

    <span class="highlight-keyword">Public</span> <span class="highlight-keyword">Function</span> AllowReference(refer <span class="highlight-keyword">As</span> Reference, point <span class="highlight-keyword">As</span> XYZ) <span class="highlight-keyword">As</span> <span class="highlight-keyword">Boolean</span> <span class="highlight-keyword">Implements</span> ISelectionFilter.AllowReference
        <span class="highlight-keyword">If</span> <span class="highlight-keyword">TypeOf</span> doc.GetElement(refer).GetGeometryObjectFromReference(refer) <span class="highlight-keyword">Is</span> PlanarFace <span class="highlight-keyword">Then</span>
            <span class="highlight-comment">' Only return true for planar faces. Non-planar faces will not be selectable</span>
            <span class="highlight-keyword">Return</span> <span class="highlight-keyword">True</span>
        <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
        <span class="highlight-keyword">Return</span> <span class="highlight-keyword">False</span>
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">Function</span>
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Class</span></pre></div><div id="IDAKC_code_Div3" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div><div id="IDAKC_code_Div4" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div></div></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Reference</h4><div><a href="31b73d46-7d67-5dbb-4dad-80aa597c9afc.htm">Selection Class</a></div><div><a href="e5a547a2-3cf5-7638-2daa-ea85b4d3de2d.htm">PickObjects Overload</a></div><div><a href="11785869-cc9e-03fc-97db-767a59af10a1.htm">Autodesk.Revit.UI.Selection Namespace</a></div></div></div></div><div id="PageFooter" class="pageFooter"><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:revitapifeedback%40autodesk.com?Subject=Revit%202025%20API">Autodesk</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        </script></div></body></html>