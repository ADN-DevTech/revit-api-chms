<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="Microsoft.Help.SelfBranded" content="true" /><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Locale" content="en-us" /><meta name="Microsoft.Help.TopicLocale" content="en-us" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"></script><title>ControlledApplication.DocumentOpened Event</title><meta name="Title" content="DocumentOpened Event" /><meta name="Microsoft.Help.Id" content="E:Autodesk.Revit.ApplicationServices.ControlledApplication.DocumentOpened" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="System.Keywords" content="ControlledApplication.DocumentOpened event" /><meta name="System.Keywords" content="DocumentOpened event" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.ApplicationServices.ControlledApplication.DocumentOpened" /><meta name="Microsoft.Help.F1" content="ControlledApplication.DocumentOpened" /><meta name="Microsoft.Help.F1" content="DocumentOpened" /><meta name="container" content="Autodesk.Revit.ApplicationServices" /><meta name="file" content="7e5bc7a1-0475-b2ec-0aec-c410015737fe" /><meta name="guid" content="7e5bc7a1-0475-b2ec-0aec-c410015737fe" /><meta name="Microsoft.Help.Category" content="CSharp" /><meta name="Microsoft.Help.Category" content="VB" /><meta name="Description" content="Subscribe to the DocumentOpened event to be notified immediately after Revit has finished opening a document." /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Help1.css" /></head><body onload="SetDefaultLanguage('cs');"><input type="hidden" id="userDataCache" class="userDataStyle" /><div id="PageHeader" class="pageHeader">Revit 2025 API</div><div class="pageBody"><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Controlled<wbr />Application<span id="LST705B4A6C_0" data-languageSpecificText="cpp=::|nu=."></span>Document<wbr />Opened Event</h1></td></tr></table><div class="summary">
   Subscribe to the DocumentOpened event to be notified immediately after Revit has finished opening a document.
</div><br /><strong>Namespace:</strong> <a href="91957e18-2935-006c-83ab-3b5b9dbb5928.htm">Autodesk.Revit.ApplicationServices</a><br /><strong>Assembly:</strong> RevitAPI (in RevitAPI.dll) Version: 25.0.0.0 (25.0.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDB')" onkeypress="SectionExpandCollapse_CheckKey('IDB', event)" tabindex="0"><img id="IDBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="IDBSection" class="collapsibleSection"><div id="IDAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAB_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cs','1','4');return false;">C#</a></div><div id="IDAB_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','vb','2','4');return false;">VB</a></div><div id="IDAB_tab3" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cpp','3','4');return false;">C++</a></div><div id="IDAB_tab4" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAB');return false;" title="Copy">Copy</a></div></div><div id="IDAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> event <span class="identifier">EventHandler</span>&lt;<span class="identifier">DocumentOpenedEventArgs</span>&gt; <span class="identifier">DocumentOpened</span></pre></div><div id="IDAB_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> Event <span class="identifier">DocumentOpened</span> <span class="keyword">As</span> <span class="identifier">EventHandler</span>(<span class="keyword">Of</span> <span class="identifier">DocumentOpenedEventArgs</span>)</pre></div><div id="IDAB_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span>:
 <span class="keyword">event</span> <span class="identifier">EventHandler</span>&lt;<span class="identifier">DocumentOpenedEventArgs</span>^&gt;^ <span class="identifier">DocumentOpened</span> {
	<span class="keyword">void</span> <span class="keyword">add</span> (<span class="identifier">EventHandler</span>&lt;<span class="identifier">DocumentOpenedEventArgs</span>^&gt;^ <span class="parameter">value</span>);
	<span class="keyword">void</span> <span class="keyword">remove</span> (<span class="identifier">EventHandler</span>&lt;<span class="identifier">DocumentOpenedEventArgs</span>^&gt;^ <span class="parameter">value</span>);
}</pre></div><div id="IDAB_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">member</span> <span class="identifier">DocumentOpened</span> : <span class="identifier">IEvent</span>&lt;<span class="identifier">EventHandler</span>&lt;<span class="identifier">DocumentOpenedEventArgs</span>&gt;,
    <span class="identifier">DocumentOpenedEventArgs</span>&gt;</pre></div></div></div><h4>Value</h4><a href="https://learn.microsoft.com/dotnet/api/system.eventhandler-1" target="_blank" rel="noopener noreferrer">EventHandler</a><span id="LST705B4A6C_1" data-languageSpecificText="cpp=&lt;|cs=&lt;|fs=&lt;|vb=(Of |nu=("></span><a href="0c6c3227-ecad-6a5f-c1b1-d08745360637.htm">DocumentOpenedEventArgs</a><span id="LST705B4A6C_2" data-languageSpecificText="cpp=&gt;|cs=&gt;|fs=&gt;|vb=)|nu=)"></span></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDBC')" onkeypress="SectionExpandCollapse_CheckKey('IDBC', event)" tabindex="0"><img id="IDBCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="IDBCSection" class="collapsibleSection"><p>This event is raised immediately after Revit has finished opening a document.
   It is raised even when document opening failed or was cancelled (during DocumentOpening event).</p><p>
   Handlers of this event are permitted to make modifications to any document (including the active document),
   except for documents that are currently in read-only mode.
   </p><p>Check the 'Status' field in event's argument to see whether the action itself was successful or not.</p><p>This event is not cancellable, for the process of opening document has already been finished.</p><p>If the action was not successful, the document may not be modified and new transactions may not be started.</p><p>The following API functions are not available for the current document during this event:
   <ul><li><span class="noLink">[!:Autodesk::Revit::DB::Document::Close()]</span> and similar overloads.</li></ul></p><p>Exception <a href="9e715f03-3884-e539-4dd6-8d7545733adc.htm">InvalidOperationException</a> will be thrown if any of the above methods is called during this event.</p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDDC')" onkeypress="SectionExpandCollapse_CheckKey('IDDC', event)" tabindex="0"><img id="IDDCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Example</span></div><div id="IDDCSection" class="collapsibleSection"><div id="IDADC" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDADC_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDADC','cs','1','4');return false;">C#</a></div><div id="IDADC_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDADC','vb','2','4');return false;">VB</a></div><div id="IDADC_tab3" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDADC','cpp','3','4');return false;">C++</a></div><div id="IDADC_tab4" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDADC','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDADC_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDADC');return false;" title="Copy">Copy</a></div></div><div id="IDADC_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">public</span> <span class="highlight-keyword">class</span> Application_DocumentOpened : IExternalApplication
{
    <span class="highlight-comment">/// &lt;ExampleMethod&gt;</span>
    <span class="highlight-comment">/// &lt;summary&gt;</span>
    <span class="highlight-comment">/// Implement this method to subscribe to event.</span>
    <span class="highlight-comment">/// &lt;/summary&gt;</span>
    <span class="highlight-keyword">public</span> Result OnStartup(UIControlledApplication application)
    {
        <span class="highlight-keyword">try</span>
        {
            <span class="highlight-comment">// Register event. </span>
           application.ControlledApplication.DocumentOpened += <span class="highlight-keyword">new</span> EventHandler
                &lt;Autodesk.Revit.DB.Events.DocumentOpenedEventArgs&gt;(application_DocumentOpened);
        }
        <span class="highlight-keyword">catch</span> (Exception)
        {
            <span class="highlight-keyword">return</span> Result.Failed;
        }

        <span class="highlight-keyword">return</span> Result.Succeeded;
    }

    <span class="highlight-comment">/// &lt;summary&gt;</span>
    <span class="highlight-comment">/// Implement OnShutdown method of IExternalApplication interface to unregister subscribed event</span>
    <span class="highlight-comment">/// &lt;/summary&gt;</span>
    <span class="highlight-keyword">public</span> Result OnShutdown(UIControlledApplication application)
    {
        <span class="highlight-comment">// remove the event.</span>
       application.ControlledApplication.DocumentOpened -= application_DocumentOpened;
        <span class="highlight-keyword">return</span> Result.Succeeded;
    }

    <span class="highlight-comment">/// &lt;TrivialCode&gt;</span>
    <span class="highlight-comment">/// Code ID: 501</span>
    <span class="highlight-comment">/// For DocumentOpened class description</span>
    <span class="highlight-comment">/// &lt;/TrivialCode&gt;</span>

    <span class="highlight-comment">/// &lt;description&gt;</span>
    <span class="highlight-comment">/// This sample demonstrates how to subscribe to the DocumentOpened event and modify the model in the event handler method. </span>
    <span class="highlight-comment">/// &lt;/description&gt;</span>
    <span class="highlight-comment">/// &lt;summary&gt;</span>
    <span class="highlight-comment">/// This is the event handler. We modify the model.</span>
    <span class="highlight-comment">/// &lt;/summary&gt;</span>
    <span class="highlight-comment">/// &lt;param name="sender"&gt;Event sender.&lt;/param&gt;</span>
    <span class="highlight-comment">/// &lt;param name="args"&gt;&lt;/param&gt;</span>
    <span class="highlight-keyword">public</span> <span class="highlight-keyword">void</span> application_DocumentOpened(<span class="highlight-keyword">object</span> sender, DocumentOpenedEventArgs args)
    {
        <span class="highlight-comment">// get document from event args.</span>
        Document doc = args.Document;

        <span class="highlight-comment">// Following code snippet demonstrates support of DocumentOpened event to modify the model.</span>
        <span class="highlight-comment">// Because DocumentOpened supports model changes, it allows user to update document data.</span>
        <span class="highlight-comment">// Here, this sample assigns a specified value to ProjectInformation.Address property. </span>
        <span class="highlight-comment">// User can change other properties of document or create(delete) something as he likes.</span>
        <span class="highlight-comment">// </span>
        <span class="highlight-comment">// Please note that ProjectInformation property is empty for family document.</span>
        <span class="highlight-comment">// So please don't run this sample on family document.</span>
        <span class="highlight-keyword">using</span> (Transaction transaction = <span class="highlight-keyword">new</span> Transaction(doc, <span class="highlight-literal">"Edit Address"</span>))
        {
           <span class="highlight-keyword">if</span> (transaction.Start() == TransactionStatus.Started)
           {
              doc.ProjectInformation.Address =
                  <span class="highlight-literal">"United States - Massachusetts - Waltham - 1560 Trapelo Road"</span>;
              transaction.Commit();
           }
        }
    }

    <span class="highlight-comment">/// &lt;/ExampleMethod&gt;</span>
}</pre></div><div id="IDADC_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="highlight-keyword">Public</span> <span class="highlight-keyword">Class</span> Application_DocumentOpened
    <span class="highlight-keyword">Implements</span> IExternalApplication
    <span class="highlight-comment">' &lt;ExampleMethod&gt;</span>
    <span class="highlight-comment">' &lt;summary&gt;</span>
    <span class="highlight-comment">' Implement this method to subscribe to event.</span>
    <span class="highlight-comment">' &lt;/summary&gt;</span>
    <span class="highlight-keyword">Public</span> <span class="highlight-keyword">Function</span> OnStartup(application <span class="highlight-keyword">As</span> UIControlledApplication) <span class="highlight-keyword">As</span> Autodesk.Revit.UI.Result <span class="highlight-keyword">Implements</span> IExternalApplication.OnStartup
        <span class="highlight-keyword">Try</span>
            <span class="highlight-comment">' Register event. </span>
            <span class="highlight-keyword">AddHandler</span> application.ControlledApplication.DocumentOpened, <span class="highlight-keyword">AddressOf</span> application_DocumentOpened
        <span class="highlight-keyword">Catch</span> generatedExceptionName <span class="highlight-keyword">As</span> Exception
            <span class="highlight-keyword">Return</span> Result.Failed
        <span class="highlight-keyword">End</span> <span class="highlight-keyword">Try</span>

        <span class="highlight-keyword">Return</span> Result.Succeeded
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">Function</span>

    <span class="highlight-comment">' &lt;summary&gt;</span>
    <span class="highlight-comment">' Implement OnShutdown method of IExternalApplication interface to unregister subscribed event</span>
    <span class="highlight-comment">' &lt;/summary&gt;</span>
    <span class="highlight-keyword">Public</span> <span class="highlight-keyword">Function</span> OnShutdown(application <span class="highlight-keyword">As</span> UIControlledApplication) <span class="highlight-keyword">As</span> Autodesk.Revit.UI.Result <span class="highlight-keyword">Implements</span> IExternalApplication.OnShutdown
        <span class="highlight-comment">' remove the event.</span>
        <span class="highlight-keyword">RemoveHandler</span> application.ControlledApplication.DocumentOpened, <span class="highlight-keyword">AddressOf</span> application_DocumentOpened
        <span class="highlight-keyword">Return</span> Result.Succeeded
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">Function</span>

    <span class="highlight-comment">' &lt;TrivialCode&gt;</span>
    <span class="highlight-comment">' Code ID: 501</span>
    <span class="highlight-comment">' For DocumentOpened class description</span>
    <span class="highlight-comment">' &lt;/TrivialCode&gt;</span>

    <span class="highlight-comment">' &lt;description&gt;</span>
    <span class="highlight-comment">' This sample demonstrates how to subscribe to the DocumentOpened event and modify the model in the event handler method. </span>
    <span class="highlight-comment">' &lt;/description&gt;</span>
    <span class="highlight-comment">' &lt;summary&gt;</span>
    <span class="highlight-comment">' This is the event handler. We modify the model.</span>
    <span class="highlight-comment">' &lt;/summary&gt;</span>
    <span class="highlight-comment">' &lt;param name="sender"&gt;Event sender.&lt;/param&gt;</span>
    <span class="highlight-comment">' &lt;param name="args"&gt;&lt;/param&gt;</span>
    <span class="highlight-keyword">Public</span> <span class="highlight-keyword">Sub</span> application_DocumentOpened(sender <span class="highlight-keyword">As</span> <span class="highlight-keyword">Object</span>, args <span class="highlight-keyword">As</span> DocumentOpenedEventArgs)
        <span class="highlight-comment">' get document from event args.</span>
        <span class="highlight-keyword">Dim</span> doc <span class="highlight-keyword">As</span> Document = args.Document

        <span class="highlight-comment">' Following code snippet demonstrates support of DocumentOpened event to modify the model.</span>
        <span class="highlight-comment">' Because DocumentOpened supports model changes, it allows user to update document data.</span>
        <span class="highlight-comment">' Here, this sample assigns a specified value to ProjectInformation.Address property. </span>
        <span class="highlight-comment">' User can change other properties of document or create(delete) something as he likes.</span>
        <span class="highlight-comment">'</span>
        <span class="highlight-comment">' Please note that ProjectInformation property is empty for family document.</span>
        <span class="highlight-comment">' So please don't run this sample on family document.</span>
        <span class="highlight-keyword">Using</span> transaction <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> Transaction(doc, <span class="highlight-literal">"Edit Address"</span>)
            <span class="highlight-keyword">If</span> transaction.Start() = TransactionStatus.Started <span class="highlight-keyword">Then</span>
                doc.ProjectInformation.Address = <span class="highlight-literal">"United States - Massachusetts - Waltham - 1560 Trapelo Road"</span>
                transaction.Commit()
            <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
        <span class="highlight-keyword">End</span> <span class="highlight-keyword">Using</span>
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span>

    <span class="highlight-comment">' &lt;/ExampleMethod&gt;</span>
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Class</span></pre></div><div id="IDADC_code_Div3" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div><div id="IDADC_code_Div4" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div></div></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Reference</h4><div><a href="35859972-2407-3910-cb07-bbb337e307e6.htm">ControlledApplication Class</a></div><div><a href="91957e18-2935-006c-83ab-3b5b9dbb5928.htm">Autodesk.Revit.ApplicationServices Namespace</a></div></div></div></div><div id="PageFooter" class="pageFooter"><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:revitapifeedback%40autodesk.com?Subject=Revit%202025%20API">Autodesk</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        </script></div></body></html>