<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="Microsoft.Help.SelfBranded" content="true" /><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Locale" content="en-us" /><meta name="Microsoft.Help.TopicLocale" content="en-us" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"></script><title>Selection Class</title><meta name="Title" content="Selection Class" /><meta name="Microsoft.Help.Id" content="T:Autodesk.Revit.UI.Selection.Selection" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="System.Keywords" content="Autodesk.Revit.UI.Selection.Selection class" /><meta name="System.Keywords" content="Selection class" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.UI.Selection.Selection" /><meta name="Microsoft.Help.F1" content="Selection" /><meta name="container" content="Autodesk.Revit.UI.Selection" /><meta name="file" content="31b73d46-7d67-5dbb-4dad-80aa597c9afc" /><meta name="guid" content="31b73d46-7d67-5dbb-4dad-80aa597c9afc" /><meta name="Microsoft.Help.Category" content="CSharp" /><meta name="Microsoft.Help.Category" content="VB" /><meta name="Description" content="Contains the current user selection of elements within the project." /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Help1.css" /></head><body onload="SetDefaultLanguage('cs');"><input type="hidden" id="userDataCache" class="userDataStyle" /><div id="PageHeader" class="pageHeader">Revit 2025 API</div><div class="pageBody"><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Selection Class</h1></td></tr></table><div class="summary">
   Contains the current user selection of elements within the project.
</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDDA')" onkeypress="SectionExpandCollapse_CheckKey('IDDA', event)" tabindex="0"><img id="IDDAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Inheritance Hierarchy</span></div><div id="IDDASection" class="collapsibleSection"><a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">System<span id="LST77435A24_0" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>Object</a><br />  <span class="selflink">Autodesk.Revit.UI.Selection<span id="LST77435A24_1" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>Selection</span><br /></div><br /><strong>Namespace:</strong> <a href="11785869-cc9e-03fc-97db-767a59af10a1.htm">Autodesk.Revit.UI.Selection</a><br /><strong>Assembly:</strong> RevitAPIUI (in RevitAPIUI.dll) Version: 25.0.0.0 (25.0.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDB')" onkeypress="SectionExpandCollapse_CheckKey('IDB', event)" tabindex="0"><img id="IDBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="IDBSection" class="collapsibleSection"><div id="IDAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAB_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cs','1','4');return false;">C#</a></div><div id="IDAB_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','vb','2','4');return false;">VB</a></div><div id="IDAB_tab3" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cpp','3','4');return false;">C++</a></div><div id="IDAB_tab4" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAB');return false;" title="Copy">Copy</a></div></div><div id="IDAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">class</span> <span class="identifier">Selection</span> : <span class="identifier">IDisposable</span></pre></div><div id="IDAB_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Class</span> <span class="identifier">Selection</span>
	<span class="keyword">Implements</span> <span class="identifier">IDisposable</span></pre></div><div id="IDAB_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">ref class</span> <span class="identifier">Selection</span> : <span class="identifier">IDisposable</span></pre></div><div id="IDAB_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">type</span> <span class="identifier">Selection</span> = 
    <span class="keyword">class</span>
        <span class="keyword">interface</span> <span class="identifier">IDisposable</span>
    <span class="keyword">end</span></pre></div></div></div></div><p>The <span class="selflink">Selection</span> type exposes the following members.</p><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDOFA')" onkeypress="SectionExpandCollapse_CheckKey('IDOFA', event)" tabindex="0"><img id="IDOFAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Properties</span></div><div id="IDOFASection" class="collapsibleSection"><table id="PropertyList" class="members"><tr><th class="iconColumn"> </th><th>Name</th><th>Description</th></tr><tr><td><img src="../icons/pubProperty.gif" alt="Public property" title="Public property" /></td><td><a href="cd25e5c2-e087-07dc-6444-288b0e86479f.htm">IsValidObject</a></td><td>
   Specifies whether the .NET object represents a valid Revit entity.
</td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDAFA')" onkeypress="SectionExpandCollapse_CheckKey('IDAFA', event)" tabindex="0"><img id="IDAFAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Methods</span></div><div id="IDAFASection" class="collapsibleSection"><table id="MethodList" class="members"><tr><th class="iconColumn"> </th><th>Name</th><th>Description</th></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="4c6eef15-6691-4675-600c-7a12a09738f9.htm">Dispose</a></td><td>Releases all resources used by the <span class="selflink">Selection</span></td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)" target="_blank" rel="noopener noreferrer">Equals</a></td><td>Determines whether the specified object is equal to the current object.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="4af3bdc7-e69c-8aa6-406d-865d7f036927.htm">GetElementIds</a></td><td>
   Returns the ids of the elements that are currently selected within the project.
   The selection may not be complete. See <a href="4d55d8e8-20fd-e19f-060b-0f5a439f71f5.htm">GetReferences</a> for more options.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode#system-object-gethashcode" target="_blank" rel="noopener noreferrer">GetHashCode</a></td><td>Serves as the default hash function.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="4d55d8e8-20fd-e19f-060b-0f5a439f71f5.htm">GetReferences</a></td><td>
   Returns the references that are currently selected.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.gettype#system-object-gettype" target="_blank" rel="noopener noreferrer">GetType</a></td><td>Gets the <a href="https://learn.microsoft.com/dotnet/api/system.type" target="_blank" rel="noopener noreferrer">Type</a> of the current instance.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="0df6000f-3639-5e7b-1c43-9ec40938b9c4.htm">PickBox(PickBoxStyle)</a></td><td>
Invokes a general purpose two-click editor that lets the user to specify a rectangular area on the screen.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="3e7cb75e-73ad-d381-1f89-3dab63463c7e.htm">PickBox(PickBoxStyle, String)</a></td><td>
Invokes a general purpose two-click editor that lets the user to specify a rectangular area on the screen.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="2be6b3b7-2cec-1d8a-76fb-afcd618fcae6.htm">PickElementsByRectangle<span id="LST77435A24_2" data-languageSpecificText="cs=()|vb=|cpp=()|nu=()|fs=()"></span></a></td><td>Prompts the user to select multiple elements by drawing a rectangle.</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="c925f50a-2453-89f7-fd2e-bda44479718d.htm">PickElementsByRectangle(ISelectionFilter)</a></td><td>Prompts the user to select multiple elements by drawing a rectangle which pass a customer filter.</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="ff8f9e7f-cc92-fe92-6ea4-9f1b581f2bac.htm">PickElementsByRectangle(String)</a></td><td>Prompts the user to select multiple elements by drawing a rectangle while showing a custom status prompt string.</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="54dc3e0a-9b47-94e9-c14f-0e749b4388b0.htm">PickElementsByRectangle(ISelectionFilter, String)</a></td><td>Prompts the user to select multiple elements by drawing a rectangle which pass a customer filter while showing a custom status prompt string.</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="0315fd62-b533-1817-2f2d-d9ebd4bc8e33.htm">PickObject(ObjectType)</a></td><td>Prompts the user to select one object.</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="8038c1e1-262e-5d25-c065-b75b9ba98603.htm">PickObject(ObjectType, ISelectionFilter)</a></td><td>Prompts the user to select one object which passes a custom filter.</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="40d583f4-f74a-917d-ff6e-e197eef76e53.htm">PickObject(ObjectType, String)</a></td><td>Prompts the user to select one object while showing a custom status prompt string.</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="e55e4998-ef65-6021-f448-6046be134533.htm">PickObject(ObjectType, ISelectionFilter, String)</a></td><td>Prompts the user to select one object which passes a custom filter while showing a custom status prompt string.</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="577ac5d0-8a6d-8e73-9d0d-259ed0ac6024.htm">PickObjects(ObjectType)</a></td><td>Prompts the user to select multiple objects.</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="3ac1a2c4-9afc-98cf-d5b8-c0c6a15fb4e8.htm">PickObjects(ObjectType, ISelectionFilter)</a></td><td>Prompts the user to select multiple objects which pass a customer filter.</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="ee21d076-057b-f334-70a6-e0dab1d2ac4e.htm">PickObjects(ObjectType, String)</a></td><td>Prompts the user to select multiple objects while showing a custom status prompt string.</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="25aad159-e19d-82d9-f02d-043cc9905163.htm">PickObjects(ObjectType, ISelectionFilter, String)</a></td><td>Prompts the user to select multiple objects which pass a custom filter while showing a custom status prompt string.</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="eac2b67c-28ae-f057-501e-bff28ea4dcfe.htm">PickObjects(ObjectType, ISelectionFilter, String, IList<span id="LST77435A24_3" data-languageSpecificText="cs=&lt;|vb=(Of |cpp=&lt;|fs=&lt;'|nu=("></span>Reference<span id="LST77435A24_4" data-languageSpecificText="cs=&gt;|vb=)|cpp=&gt;|fs=&gt;|nu=)"></span>)</a></td><td>Prompts the user to select multiple objects which pass a custom filter while showing a custom status prompt string. A preselected set of objects may be supplied and will be selected at the start of the selection.</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="e35b0233-64b5-d0c0-713a-292f62942769.htm">PickPoint<span id="LST77435A24_5" data-languageSpecificText="cs=()|vb=|cpp=()|nu=()|fs=()"></span></a></td><td>Prompts the user to pick a point on the active work plane.</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="7b0edd8c-ea51-0b19-7455-21d3bf3152e8.htm">PickPoint(ObjectSnapTypes)</a></td><td>Prompts the user to pick a point on the active work plane using specified snap settings.</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="80e5e8e6-42af-c1b8-6ce1-db598ea166fb.htm">PickPoint(String)</a></td><td>Prompts the user to pick a point on the active work plane while showing a custom status prompt string.</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="af8ad302-7196-8e2f-f1eb-e5929cda30d9.htm">PickPoint(ObjectSnapTypes, String)</a></td><td>Prompts the user to pick a point on the active work plane using specified snap settings while showing a custom status prompt string.</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="cf8c11bb-f0c7-6d50-cbdf-41d0a010d9d6.htm">SetElementIds</a></td><td>
   Selects the elements.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="813a9d31-bc4f-1ebc-9a7b-69a2a99d22ac.htm">SetReferences</a></td><td>
   Selects the references. The references can be an element or a subelement in the host or a linked document.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.tostring#system-object-tostring" target="_blank" rel="noopener noreferrer">ToString</a></td><td>Returns a string that represents the current object.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDBC')" onkeypress="SectionExpandCollapse_CheckKey('IDBC', event)" tabindex="0"><img id="IDBCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="IDBCSection" class="collapsibleSection">
   The Selection object is used to retrieve the current user selected elements when an external API command is executed.
</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDCC')" onkeypress="SectionExpandCollapse_CheckKey('IDCC', event)" tabindex="0"><img id="IDCCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Example</span></div><div id="IDCCSection" class="collapsibleSection"><div id="IDACC" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDACC_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDACC','cs','1','4');return false;">C#</a></div><div id="IDACC_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDACC','vb','2','4');return false;">VB</a></div><div id="IDACC_tab3" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDACC','cpp','3','4');return false;">C++</a></div><div id="IDACC_tab4" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDACC','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDACC_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDACC');return false;" title="Copy">Copy</a></div></div><div id="IDACC_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">[Autodesk.Revit.Attributes.Transaction(Autodesk.Revit.Attributes.TransactionMode.ReadOnly)]
<span class="highlight-keyword">public</span> <span class="highlight-keyword">class</span> Document_Selection : IExternalCommand
{
    <span class="highlight-keyword">public</span> Autodesk.Revit.UI.Result Execute(ExternalCommandData commandData,
        <span class="highlight-keyword">ref</span> <span class="highlight-keyword">string</span> message, ElementSet elements)
    {
        <span class="highlight-keyword">try</span>
        {
            <span class="highlight-comment">// Select some elements in Revit before invoking this command</span>

            <span class="highlight-comment">// Get the handle of current document.</span>
            UIDocument uidoc = commandData.Application.ActiveUIDocument;

            <span class="highlight-comment">// Get the element selection of current document.</span>
            Selection selection = uidoc.Selection;
            ICollection&lt;ElementId&gt; selectedIds = uidoc.Selection.GetElementIds();

            <span class="highlight-keyword">if</span> (<span class="highlight-number">0</span> == selectedIds.Count)
            {
                <span class="highlight-comment">// If no elements selected.</span>
                TaskDialog.Show(<span class="highlight-literal">"Revit"</span>,<span class="highlight-literal">"You haven't selected any elements."</span>);
            }
            <span class="highlight-keyword">else</span>
            {
                String info = <span class="highlight-literal">"Ids of selected elements in the document are: "</span>;
                <span class="highlight-keyword">foreach</span> (ElementId id <span class="highlight-keyword">in</span> selectedIds)
                {
                   info += <span class="highlight-literal">"\n\t"</span> + id.ToString();
                }

                TaskDialog.Show(<span class="highlight-literal">"Revit"</span>,info);
            }
        }
        <span class="highlight-keyword">catch</span> (Exception e)
        {
            message = e.Message;
            <span class="highlight-keyword">return</span> Autodesk.Revit.UI.Result.Failed;
        }

        <span class="highlight-keyword">return</span> Autodesk.Revit.UI.Result.Succeeded;
    }
    <span class="highlight-comment">/// &lt;/ExampleMethod&gt;</span>
}</pre></div><div id="IDACC_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve">&lt;Autodesk.Revit.Attributes.Transaction(Autodesk.Revit.Attributes.TransactionMode.[<span class="highlight-keyword">ReadOnly</span>])&gt; _
<span class="highlight-keyword">Public</span> <span class="highlight-keyword">Class</span> Document_Selection
    <span class="highlight-keyword">Implements</span> IExternalCommand
    <span class="highlight-keyword">Public</span> <span class="highlight-keyword">Function</span> Execute(commandData <span class="highlight-keyword">As</span> ExternalCommandData, <span class="highlight-keyword">ByRef</span> message <span class="highlight-keyword">As</span> <span class="highlight-keyword">String</span>, elements <span class="highlight-keyword">As</span> ElementSet) <span class="highlight-keyword">As</span> Autodesk.Revit.UI.Result <span class="highlight-keyword">Implements</span> IExternalCommand.Execute
        <span class="highlight-keyword">Try</span>
            <span class="highlight-comment">' Select some elements in Revit before invoking this command</span>

            <span class="highlight-comment">' Get the handle of current document.</span>
            <span class="highlight-keyword">Dim</span> uidoc <span class="highlight-keyword">As</span> UIDocument = commandData.Application.ActiveUIDocument

            <span class="highlight-comment">' Get the element selection of current document.</span>
            <span class="highlight-keyword">Dim</span> selection <span class="highlight-keyword">As</span> Selection = uidoc.Selection
            <span class="highlight-keyword">Dim</span> selectedIds <span class="highlight-keyword">As</span> ICollection(<span class="highlight-keyword">Of</span> ElementId) = uidoc.Selection.GetElementIds()

            <span class="highlight-keyword">If</span> <span class="highlight-number">0</span> = selectedIds.Count <span class="highlight-keyword">Then</span>
                <span class="highlight-comment">' If no elements selected.</span>
                TaskDialog.Show(<span class="highlight-literal">"Revit"</span>, <span class="highlight-literal">"You haven't selected any elements."</span>)
            <span class="highlight-keyword">Else</span>
                <span class="highlight-keyword">Dim</span> info <span class="highlight-keyword">As</span> [<span class="highlight-keyword">String</span>] = <span class="highlight-literal">"Ids of selected elements in the document are: "</span>
                <span class="highlight-keyword">For</span> <span class="highlight-keyword">Each</span> id <span class="highlight-keyword">As</span> ElementId <span class="highlight-keyword">In</span> selectedIds
                    info += vbLf &amp; vbTab + id.ToString()
                <span class="highlight-keyword">Next</span>

                TaskDialog.Show(<span class="highlight-literal">"Revit"</span>, info)
            <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
        <span class="highlight-keyword">Catch</span> e <span class="highlight-keyword">As</span> Exception
            message = e.Message
            <span class="highlight-keyword">Return</span> Autodesk.Revit.UI.Result.Failed
        <span class="highlight-keyword">End</span> <span class="highlight-keyword">Try</span>

        <span class="highlight-keyword">Return</span> Autodesk.Revit.UI.Result.Succeeded
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">Function</span>
    <span class="highlight-comment">' &lt;/ExampleMethod&gt;</span>
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Class</span></pre></div><div id="IDACC_code_Div3" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div><div id="IDACC_code_Div4" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div></div></div><div id="IDBCC" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDBCC_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDBCC','cs','1','4');return false;">C#</a></div><div id="IDBCC_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDBCC','vb','2','4');return false;">VB</a></div><div id="IDBCC_tab3" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDBCC','cpp','3','4');return false;">C++</a></div><div id="IDBCC_tab4" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDBCC','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDBCC_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDBCC');return false;" title="Copy">Copy</a></div></div><div id="IDBCC_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">private</span> <span class="highlight-keyword">void</span> ChangeSelection(UIDocument uidoc)
{
    <span class="highlight-comment">// Get selected elements from current document.</span>
    ICollection&lt;ElementId&gt; selectedIds = uidoc.Selection.GetElementIds();

    <span class="highlight-comment">// Display current number of selected elements</span>
    TaskDialog.Show(<span class="highlight-literal">"Revit"</span>, <span class="highlight-literal">"Number of selected elements: "</span> + selectedIds.Count.ToString());

    <span class="highlight-comment">// Go through the selected items and filter out walls only.</span>
    ICollection&lt;ElementId&gt; selectedWallIds = <span class="highlight-keyword">new</span> List&lt;ElementId&gt;();

    <span class="highlight-keyword">foreach</span> (ElementId id <span class="highlight-keyword">in</span> selectedIds)
    {
        Element elements = uidoc.Document.GetElement(id);
        <span class="highlight-keyword">if</span> (elements <span class="highlight-keyword">is</span> Wall)
        {
            selectedWallIds.Add(id);
        }
    }

    <span class="highlight-comment">// Set the created element set as current select element set.</span>
    uidoc.Selection.SetElementIds(selectedWallIds);

    <span class="highlight-comment">// Give the user some information.</span>
    <span class="highlight-keyword">if</span> (<span class="highlight-number">0</span> != selectedWallIds.Count)
    {
        TaskDialog.Show(<span class="highlight-literal">"Revit"</span>, selectedWallIds.Count.ToString() + <span class="highlight-literal">" Walls are selected!"</span>);
    }
    <span class="highlight-keyword">else</span>
    {
        TaskDialog.Show(<span class="highlight-literal">"Revit"</span>,<span class="highlight-literal">"No Walls have been selected!"</span>);
    }
}</pre></div><div id="IDBCC_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="highlight-keyword">Private</span> <span class="highlight-keyword">Sub</span> ChangeSelection(uidoc <span class="highlight-keyword">As</span> UIDocument)
    <span class="highlight-comment">' Get selected elements from current document.</span>
    <span class="highlight-keyword">Dim</span> selectedIds <span class="highlight-keyword">As</span> ICollection(<span class="highlight-keyword">Of</span> ElementId) = uidoc.Selection.GetElementIds()

    <span class="highlight-comment">' Display current number of selected elements</span>
    TaskDialog.Show(<span class="highlight-literal">"Revit"</span>, <span class="highlight-literal">"Number of selected elements: "</span> + selectedIds.Count.ToString())

    <span class="highlight-comment">' Go through the selected items and filter out walls only.</span>
    <span class="highlight-keyword">Dim</span> selectedWallIds <span class="highlight-keyword">As</span> ICollection(<span class="highlight-keyword">Of</span> ElementId) = <span class="highlight-keyword">New</span> List(<span class="highlight-keyword">Of</span> ElementId)()

    <span class="highlight-keyword">For</span> <span class="highlight-keyword">Each</span> id <span class="highlight-keyword">As</span> ElementId <span class="highlight-keyword">In</span> selectedIds
        <span class="highlight-keyword">Dim</span> elements <span class="highlight-keyword">As</span> Element = uidoc.Document.GetElement(id)
        <span class="highlight-keyword">If</span> <span class="highlight-keyword">TypeOf</span> elements <span class="highlight-keyword">Is</span> Wall <span class="highlight-keyword">Then</span>
            selectedWallIds.Add(id)
        <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
    <span class="highlight-keyword">Next</span>

    <span class="highlight-comment">' Set the created element set as current select element set.</span>
    uidoc.Selection.SetElementIds(selectedWallIds)

    <span class="highlight-comment">' Give the user some information.</span>
    <span class="highlight-keyword">If</span> <span class="highlight-number">0</span> &lt;&gt; selectedWallIds.Count <span class="highlight-keyword">Then</span>
        TaskDialog.Show(<span class="highlight-literal">"Revit"</span>, selectedWallIds.Count.ToString() + <span class="highlight-literal">" Walls are selected!"</span>)
    <span class="highlight-keyword">Else</span>
        TaskDialog.Show(<span class="highlight-literal">"Revit"</span>, <span class="highlight-literal">"No Walls have been selected!"</span>)
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span></pre></div><div id="IDBCC_code_Div3" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div><div id="IDBCC_code_Div4" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div></div></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Reference</h4><div><a href="11785869-cc9e-03fc-97db-767a59af10a1.htm">Autodesk.Revit.UI.Selection Namespace</a></div></div></div></div><div id="PageFooter" class="pageFooter"><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:revitapifeedback%40autodesk.com?Subject=Revit%202025%20API">Autodesk</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        </script></div></body></html>