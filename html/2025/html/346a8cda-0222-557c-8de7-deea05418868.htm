<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="Microsoft.Help.SelfBranded" content="true" /><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Locale" content="en-us" /><meta name="Microsoft.Help.TopicLocale" content="en-us" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"></script><title>WorksharingUtils.GetModelUpdatesStatus Method</title><meta name="Title" content="GetModelUpdatesStatus Method" /><meta name="Microsoft.Help.Id" content="M:Autodesk.Revit.DB.WorksharingUtils.GetModelUpdatesStatus(Autodesk.Revit.DB.Document,Autodesk.Revit.DB.ElementId)" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="System.Keywords" content="WorksharingUtils.GetModelUpdatesStatus method" /><meta name="System.Keywords" content="GetModelUpdatesStatus method" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.DB.WorksharingUtils.GetModelUpdatesStatus" /><meta name="Microsoft.Help.F1" content="WorksharingUtils.GetModelUpdatesStatus" /><meta name="Microsoft.Help.F1" content="GetModelUpdatesStatus" /><meta name="container" content="Autodesk.Revit.DB" /><meta name="file" content="346a8cda-0222-557c-8de7-deea05418868" /><meta name="guid" content="346a8cda-0222-557c-8de7-deea05418868" /><meta name="Microsoft.Help.Category" content="CSharp" /><meta name="Microsoft.Help.Category" content="VB" /><meta name="Description" content="Gets the status of a single element in the central model." /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Help1.css" /></head><body onload="SetDefaultLanguage('cs');"><input type="hidden" id="userDataCache" class="userDataStyle" /><div id="PageHeader" class="pageHeader">Revit 2025 API</div><div class="pageBody"><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Worksharing<wbr />Utils<span id="LST4D401320_0" data-languageSpecificText="cpp=::|nu=."></span>Get<wbr />Model<wbr />Updates<wbr />Status Method</h1></td></tr></table><div class="summary">
   Gets the status of a single element in the central model.
</div><br /><strong>Namespace:</strong> <a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB</a><br /><strong>Assembly:</strong> RevitAPI (in RevitAPI.dll) Version: 25.0.0.0 (25.0.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDB')" onkeypress="SectionExpandCollapse_CheckKey('IDB', event)" tabindex="0"><img id="IDBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="IDBSection" class="collapsibleSection"><div id="IDAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAB_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cs','1','4');return false;">C#</a></div><div id="IDAB_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','vb','2','4');return false;">VB</a></div><div id="IDAB_tab3" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cpp','3','4');return false;">C++</a></div><div id="IDAB_tab4" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAB');return false;" title="Copy">Copy</a></div></div><div id="IDAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <span class="identifier">ModelUpdatesStatus</span> <span class="identifier">GetModelUpdatesStatus</span>(
	<span class="identifier">Document</span> <span class="parameter">document</span>,
	<span class="identifier">ElementId</span> <span class="parameter">elementId</span>
)</pre></div><div id="IDAB_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">GetModelUpdatesStatus</span> ( 
	<span class="parameter">document</span> <span class="keyword">As</span> <span class="identifier">Document</span>,
	<span class="parameter">elementId</span> <span class="keyword">As</span> <span class="identifier">ElementId</span>
) <span class="keyword">As</span> <span class="identifier">ModelUpdatesStatus</span></pre></div><div id="IDAB_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="keyword">static</span> <span class="identifier">ModelUpdatesStatus</span> <span class="identifier">GetModelUpdatesStatus</span>(
	<span class="identifier">Document</span>^ <span class="parameter">document</span>, 
	<span class="identifier">ElementId</span>^ <span class="parameter">elementId</span>
)</pre></div><div id="IDAB_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">static</span> <span class="keyword">member</span> <span class="identifier">GetModelUpdatesStatus</span> : 
        <span class="parameter">document</span> : <span class="identifier">Document</span> * 
        <span class="parameter">elementId</span> : <span class="identifier">ElementId</span> <span class="keyword">-&gt;</span> <span class="identifier">ModelUpdatesStatus</span> </pre></div></div></div><h4>Parameters</h4><dl><dt class="has-text-weight-normal"><span class="parameter">document</span>  <a href="db03274b-a107-aa32-9034-f3e0df4bb1ec.htm">Document</a></dt><dd>
   The document containing the element.
</dd><dt class="has-text-weight-normal"><span class="parameter">elementId</span>  <a href="44f3f7b1-3229-3404-93c9-dc5e70337dd6.htm">ElementId</a></dt><dd>
   The id of the element.
</dd></dl><h4>Return Value</h4><a href="2fc35e00-cdf2-8368-e6a6-032725492cbe.htm">ModelUpdatesStatus</a><br />
   The status of the element in the local session versus the central model.
</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDFC')" onkeypress="SectionExpandCollapse_CheckKey('IDFC', event)" tabindex="0"><img id="IDFCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Exceptions</span></div><div id="IDFCSection" class="collapsibleSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="631e1424-60f4-929b-4e52-dda9dcd26316.htm">ArgumentNullException</a></td><td>
   A non-optional argument was null
</td></tr></table></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDBC')" onkeypress="SectionExpandCollapse_CheckKey('IDBC', event)" tabindex="0"><img id="IDBCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="IDBCSection" class="collapsibleSection"><p> This method returns a locally cached value which may not be up to date with the current state
   of the element in the central.  Because of this, the return value is suitable for reporting to an
   interactive user (e.g. via a mechanism similar to Worksharing display mode), but cannot be considered
   a reliable indication of whether the element can be immediately edited by the application.  Also, the return value
   may not be dependable in the middle of a local transaction.  See the remarks
   on <a href="ae7857a0-4e9b-f9c1-84c7-8b250af68068.htm">WorksharingUtils</a> for more details. </p><p> For performance reasons, the model is not validated to be workshared,
   and the element id is also not validated; the element will not be expanded.</p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDHC')" onkeypress="SectionExpandCollapse_CheckKey('IDHC', event)" tabindex="0"><img id="IDHCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Example</span></div><div id="IDHCSection" class="collapsibleSection"><div id="IDAHC" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAHC_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAHC','cs','1','4');return false;">C#</a></div><div id="IDAHC_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAHC','vb','2','4');return false;">VB</a></div><div id="IDAHC_tab3" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDAHC','cpp','3','4');return false;">C++</a></div><div id="IDAHC_tab4" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDAHC','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAHC_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAHC');return false;" title="Copy">Copy</a></div></div><div id="IDAHC_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">public</span> <span class="highlight-keyword">static</span> <span class="highlight-keyword">bool</span> AttemptToCheckoutInAdvance(Element element)
{
    Document doc = element.Document;
    String categoryName = element.Category.Name;

    <span class="highlight-comment">// Checkout attempt</span>
    ICollection&lt;ElementId&gt; checkedOutIds = WorksharingUtils.CheckoutElements(doc, <span class="highlight-keyword">new</span> ElementId[] { element.Id });

    <span class="highlight-comment">// Confirm checkout</span>
    <span class="highlight-keyword">bool</span> checkedOutSuccessfully = checkedOutIds.Contains(element.Id);

    <span class="highlight-keyword">if</span> (!checkedOutSuccessfully)
    {
        TaskDialog.Show(<span class="highlight-literal">"Element is not checked out"</span>, <span class="highlight-literal">"Cannot edit the "</span> + categoryName + <span class="highlight-literal">" element - "</span> +
                        <span class="highlight-literal">"it was not checked out successfully and may be checked out to another."</span>);
        <span class="highlight-keyword">return</span> <span class="highlight-keyword">false</span>;
    }

    <span class="highlight-comment">// If element is updated in central or deleted in central, it is not editable</span>
    ModelUpdatesStatus updatesStatus = WorksharingUtils.GetModelUpdatesStatus(doc, element.Id);
    <span class="highlight-keyword">if</span> (updatesStatus == ModelUpdatesStatus.DeletedInCentral || updatesStatus == ModelUpdatesStatus.UpdatedInCentral)
    {
        TaskDialog.Show(<span class="highlight-literal">"Element is not up to date"</span>, <span class="highlight-literal">"Cannot edit the "</span> + categoryName + <span class="highlight-literal">" element - "</span> +
                        <span class="highlight-literal">"it is not up to date with central, but it is checked out."</span>);
        <span class="highlight-keyword">return</span> <span class="highlight-keyword">false</span>;
    }

    <span class="highlight-keyword">return</span> <span class="highlight-keyword">true</span>;
}</pre></div><div id="IDAHC_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="highlight-keyword">Public</span> <span class="highlight-keyword">Shared</span> <span class="highlight-keyword">Function</span> AttemptToCheckoutInAdvance(element <span class="highlight-keyword">As</span> Element) <span class="highlight-keyword">As</span> <span class="highlight-keyword">Boolean</span>
    <span class="highlight-keyword">Dim</span> doc <span class="highlight-keyword">As</span> Document = element.Document
    <span class="highlight-keyword">Dim</span> categoryName <span class="highlight-keyword">As</span> [<span class="highlight-keyword">String</span>] = element.Category.Name

    <span class="highlight-comment">' Checkout attempt</span>
    <span class="highlight-keyword">Dim</span> checkedOutIds <span class="highlight-keyword">As</span> ICollection(<span class="highlight-keyword">Of</span> ElementId) = WorksharingUtils.CheckoutElements(doc, <span class="highlight-keyword">New</span> ElementId() {element.Id})

    <span class="highlight-comment">' Confirm checkout</span>
    <span class="highlight-keyword">Dim</span> checkedOutSuccessfully <span class="highlight-keyword">As</span> <span class="highlight-keyword">Boolean</span> = checkedOutIds.Contains(element.Id)

    <span class="highlight-keyword">If</span> <span class="highlight-keyword">Not</span> checkedOutSuccessfully <span class="highlight-keyword">Then</span>
        TaskDialog.Show(<span class="highlight-literal">"Element is not checked out"</span>, <span class="highlight-literal">"Cannot edit the "</span> + categoryName + <span class="highlight-literal">" element - "</span> + <span class="highlight-literal">"it was not checked out successfully and may be checked out to another."</span>)
        <span class="highlight-keyword">Return</span> <span class="highlight-keyword">False</span>
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>

    <span class="highlight-comment">' If element is updated in central or deleted in central, it is not editable</span>
    <span class="highlight-keyword">Dim</span> updatesStatus <span class="highlight-keyword">As</span> ModelUpdatesStatus = WorksharingUtils.GetModelUpdatesStatus(doc, element.Id)
    <span class="highlight-keyword">If</span> updatesStatus = ModelUpdatesStatus.DeletedInCentral <span class="highlight-keyword">OrElse</span> updatesStatus = ModelUpdatesStatus.UpdatedInCentral <span class="highlight-keyword">Then</span>
        TaskDialog.Show(<span class="highlight-literal">"Element is not up to date"</span>, <span class="highlight-literal">"Cannot edit the "</span> + categoryName + <span class="highlight-literal">" element - "</span> + <span class="highlight-literal">"it is not up to date with central, but it is checked out."</span>)
        <span class="highlight-keyword">Return</span> <span class="highlight-keyword">False</span>
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>

    <span class="highlight-keyword">Return</span> <span class="highlight-keyword">True</span>
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Function</span></pre></div><div id="IDAHC_code_Div3" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div><div id="IDAHC_code_Div4" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div></div></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Reference</h4><div><a href="ae7857a0-4e9b-f9c1-84c7-8b250af68068.htm">WorksharingUtils Class</a></div><div><a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB Namespace</a></div></div></div></div><div id="PageFooter" class="pageFooter"><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:revitapifeedback%40autodesk.com?Subject=Revit%202025%20API">Autodesk</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        </script></div></body></html>