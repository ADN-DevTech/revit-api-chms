<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="Microsoft.Help.SelfBranded" content="true" /><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Locale" content="en-us" /><meta name="Microsoft.Help.TopicLocale" content="en-us" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"></script><title>Curve.ComputeClosestPoints Method</title><meta name="Title" content="ComputeClosestPoints Method" /><meta name="Microsoft.Help.Id" content="M:Autodesk.Revit.DB.Curve.ComputeClosestPoints(Autodesk.Revit.DB.Curve,System.Boolean,System.Boolean,System.Boolean,System.Collections.Generic.IList{Autodesk.Revit.DB.ClosestPointsPairBetweenTwoCurves}@)" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="System.Keywords" content="Curve.ComputeClosestPoints method" /><meta name="System.Keywords" content="ComputeClosestPoints method" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.DB.Curve.ComputeClosestPoints" /><meta name="Microsoft.Help.F1" content="Curve.ComputeClosestPoints" /><meta name="Microsoft.Help.F1" content="ComputeClosestPoints" /><meta name="container" content="Autodesk.Revit.DB" /><meta name="file" content="04ab73d1-bc85-9b87-aace-4272a0c7c3e4" /><meta name="guid" content="04ab73d1-bc85-9b87-aace-4272a0c7c3e4" /><meta name="Description" content="Find the closest points between two curves. Closest points mean closest pairs of points, each pair consisting of a point on this, say P1, and a point on other curve, say P2. P1 and P2 are closest locally." /><link rel="stylesheet" type="text/css" href="../styles/branding-Help1.css" /></head><body onload="SetDefaultLanguage('cs');"><input type="hidden" id="userDataCache" class="userDataStyle" /><div id="PageHeader" class="pageHeader">Revit 2025 API</div><div class="pageBody"><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Curve<span id="LSTF44EAEFF_0" data-languageSpecificText="cpp=::|nu=."></span>Compute<wbr />Closest<wbr />Points Method</h1></td></tr></table><div class="summary">
   Find the closest points between two curves. 
   Closest points mean closest pairs of points, each pair consisting of a point on this, say P1, and a point on other curve, say P2. 
   P1 and P2 are closest locally.
   Each pairs of closest points will be represented by the corresponding parameter values with respect to the two curves and the 3d points.
   A closest pair is also known as a pair of critical points of the distance function between points of the two curves.
   If the input parameter returnAllCriticalPoints is set to false, then the function will return only pairs with minimum distance.  
</div><br /><strong>Namespace:</strong> <a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB</a><br /><strong>Assembly:</strong> RevitAPI (in RevitAPI.dll) Version: 25.0.0.0 (25.0.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDB')" onkeypress="SectionExpandCollapse_CheckKey('IDB', event)" tabindex="0"><img id="IDBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="IDBSection" class="collapsibleSection"><div id="IDAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAB_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cs','1','4');return false;">C#</a></div><div id="IDAB_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','vb','2','4');return false;">VB</a></div><div id="IDAB_tab3" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cpp','3','4');return false;">C++</a></div><div id="IDAB_tab4" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAB');return false;" title="Copy">Copy</a></div></div><div id="IDAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">void</span> <span class="identifier">ComputeClosestPoints</span>(
	<span class="identifier">Curve</span> <span class="parameter">otherCurve</span>,
	<span class="identifier">bool</span> <span class="parameter">withinThisCurveBounds</span>,
	<span class="identifier">bool</span> <span class="parameter">withinOtherCurveBounds</span>,
	<span class="identifier">bool</span> <span class="parameter">returnAllCriticalPnts</span>,
	<span class="keyword">out</span> <span class="identifier">IList</span>&lt;<span class="identifier">ClosestPointsPairBetweenTwoCurves</span>&gt; <span class="parameter">resultList</span>
)</pre></div><div id="IDAB_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Sub</span> <span class="identifier">ComputeClosestPoints</span> ( 
	<span class="parameter">otherCurve</span> <span class="keyword">As</span> <span class="identifier">Curve</span>,
	<span class="parameter">withinThisCurveBounds</span> <span class="keyword">As</span> <span class="identifier">Boolean</span>,
	<span class="parameter">withinOtherCurveBounds</span> <span class="keyword">As</span> <span class="identifier">Boolean</span>,
	<span class="parameter">returnAllCriticalPnts</span> <span class="keyword">As</span> <span class="identifier">Boolean</span>,
	&lt;<span class="identifier">OutAttribute</span>&gt; <span class="keyword">ByRef</span> <span class="parameter">resultList</span> <span class="keyword">As</span> <span class="identifier">IList</span>(<span class="keyword">Of</span> <span class="identifier">ClosestPointsPairBetweenTwoCurves</span>)
)</pre></div><div id="IDAB_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="keyword">void</span> <span class="identifier">ComputeClosestPoints</span>(
	<span class="identifier">Curve</span>^ <span class="parameter">otherCurve</span>, 
	<span class="identifier">bool</span> <span class="parameter">withinThisCurveBounds</span>, 
	<span class="identifier">bool</span> <span class="parameter">withinOtherCurveBounds</span>, 
	<span class="identifier">bool</span> <span class="parameter">returnAllCriticalPnts</span>, 
	[<span class="identifier">OutAttribute</span>] <span class="identifier">IList</span>&lt;<span class="identifier">ClosestPointsPairBetweenTwoCurves</span>^&gt;^% <span class="parameter">resultList</span>
)</pre></div><div id="IDAB_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">member</span> <span class="identifier">ComputeClosestPoints</span> : 
        <span class="parameter">otherCurve</span> : <span class="identifier">Curve</span> * 
        <span class="parameter">withinThisCurveBounds</span> : <span class="identifier">bool</span> * 
        <span class="parameter">withinOtherCurveBounds</span> : <span class="identifier">bool</span> * 
        <span class="parameter">returnAllCriticalPnts</span> : <span class="identifier">bool</span> * 
        <span class="parameter">resultList</span> : <span class="identifier">IList</span>&lt;<span class="identifier">ClosestPointsPairBetweenTwoCurves</span>&gt; <span class="keyword">byref</span> <span class="keyword">-&gt;</span> <span class="keyword">unit</span> </pre></div></div></div><h4>Parameters</h4><dl><dt class="has-text-weight-normal"><span class="parameter">otherCurve</span>  <a href="400cc9b6-9ff7-de85-6fd8-c20002209d25.htm">Curve</a></dt><dd>
   The specified curve used to compute closest points to this curve.
</dd><dt class="has-text-weight-normal"><span class="parameter">withinThisCurveBounds</span>  <a href="https://learn.microsoft.com/dotnet/api/system.boolean" target="_blank" rel="noopener noreferrer">Boolean</a></dt><dd>
   If this parameter is true only the solutions that are between this curve bounds will be returned.
   This curve must be bound if this parameter is true.
</dd><dt class="has-text-weight-normal"><span class="parameter">withinOtherCurveBounds</span>  <a href="https://learn.microsoft.com/dotnet/api/system.boolean" target="_blank" rel="noopener noreferrer">Boolean</a></dt><dd>
   If this parameter is true only the solutions that are between other curve bounds will be returned.
   The other curve must be bound if this parameter is true.
</dd><dt class="has-text-weight-normal"><span class="parameter">returnAllCriticalPnts</span>  <a href="https://learn.microsoft.com/dotnet/api/system.boolean" target="_blank" rel="noopener noreferrer">Boolean</a></dt><dd>
   The input parameter returnAllCriticalPnts is used to tell if all the critical points of the
   distance function are to be returned.
</dd><dt class="has-text-weight-normal"><span class="parameter">resultList</span>  <a href="https://learn.microsoft.com/dotnet/api/system.collections.generic.ilist-1" target="_blank" rel="noopener noreferrer">IList</a><span id="LSTF44EAEFF_1" data-languageSpecificText="cpp=&lt;|cs=&lt;|fs=&lt;|vb=(Of |nu=("></span><a href="3af783ff-1aca-2c81-659d-edbaa72065d7.htm">ClosestPointsPairBetweenTwoCurves</a><span id="LSTF44EAEFF_2" data-languageSpecificText="cpp=&gt;|cs=&gt;|fs=&gt;|vb=)|nu=)"></span><span id="LSTF44EAEFF_3" data-languageSpecificText="cpp=%"></span></dt><dd>
   Output parameter that will contain the results collection.
</dd></dl></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDHC')" onkeypress="SectionExpandCollapse_CheckKey('IDHC', event)" tabindex="0"><img id="IDHCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Exceptions</span></div><div id="IDHCSection" class="collapsibleSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="631e1424-60f4-929b-4e52-dda9dcd26316.htm">ArgumentNullException</a></td><td>
   Thrown when otherCurve argument is null.
   Thrown when resultArray is null.
</td></tr><tr><td><a href="05972c68-fa6d-3a83-d720-ad84fbc4780f.htm">ArgumentsInconsistentException</a></td><td>
   Thrown when withinThisCurveBounds is true and this curve is unbounded.
   Thrown when withinOtherCurveBounds is true and other curve is unbounded.
</td></tr><tr><td><a href="9e715f03-3884-e539-4dd6-8d7545733adc.htm">InvalidOperationException</a></td><td>
   Thrown when the method failed. For example the problem has infinitely many solutions
   such as two parallel lines or two concentric circles, or in other singular cases that the method currently cannot handle, 
   such as evaluating the closest points between a spline and a line, and the spline contains
   a flat segment (all points on the segment have zero curvature), and the closest points 
   lie within that flat segment.
</td></tr></table></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDGC')" onkeypress="SectionExpandCollapse_CheckKey('IDGC', event)" tabindex="0"><img id="IDGCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="IDGCSection" class="collapsibleSection">
The output list of closest points contains one entry for each pair of closest points.
The following is the meaning of every ClosestPointsPairBetweenTwoCurves's members:
<ul><li>XYZPointOnFirstCurve is the closest point on the first curve;</li><li>XYZPointOnSecondCurve is the closest point on the second curve;</li><li>ParameterOnFirstCurve is the raw (not normalized) parameter on the first curve</li><li>ParameterOnSecondCurve is the raw (not normalized) parameter on the second curve</li><li>Distance is the distance from the closest point on the first curve to the closest point on the second curve.</li></ul></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Reference</h4><div><a href="400cc9b6-9ff7-de85-6fd8-c20002209d25.htm">Curve Class</a></div><div><a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB Namespace</a></div></div></div></div><div id="PageFooter" class="pageFooter"><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:revitapifeedback%40autodesk.com?Subject=Revit%202025%20API">Autodesk</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        </script></div></body></html>