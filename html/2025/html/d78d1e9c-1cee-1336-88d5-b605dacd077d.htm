<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="Microsoft.Help.SelfBranded" content="true" /><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Locale" content="en-us" /><meta name="Microsoft.Help.TopicLocale" content="en-us" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"></script><title>TransmissionData Class</title><meta name="Title" content="TransmissionData Class" /><meta name="Microsoft.Help.Id" content="T:Autodesk.Revit.DB.TransmissionData" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="System.Keywords" content="Autodesk.Revit.DB.TransmissionData class" /><meta name="System.Keywords" content="TransmissionData class" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.DB.TransmissionData" /><meta name="Microsoft.Help.F1" content="TransmissionData" /><meta name="container" content="Autodesk.Revit.DB" /><meta name="file" content="d78d1e9c-1cee-1336-88d5-b605dacd077d" /><meta name="guid" content="d78d1e9c-1cee-1336-88d5-b605dacd077d" /><meta name="Microsoft.Help.Category" content="CSharp" /><meta name="Microsoft.Help.Category" content="VB" /><meta name="Description" content="A class representing information on all external file references in a document." /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Help1.css" /></head><body onload="SetDefaultLanguage('cs');"><input type="hidden" id="userDataCache" class="userDataStyle" /><div id="PageHeader" class="pageHeader">Revit 2025 API</div><div class="pageBody"><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Transmission<wbr />Data Class</h1></td></tr></table><div class="summary">
   A class representing information on all external file references
   in a document.
</div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDDA')" onkeypress="SectionExpandCollapse_CheckKey('IDDA', event)" tabindex="0"><img id="IDDAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Inheritance Hierarchy</span></div><div id="IDDASection" class="collapsibleSection"><a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">System<span id="LST35F1B48B_0" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>Object</a><br />  <span class="selflink">Autodesk.Revit.DB<span id="LST35F1B48B_1" data-languageSpecificText="cs=.|vb=.|cpp=::|nu=.|fs=."></span>TransmissionData</span><br /></div><br /><strong>Namespace:</strong> <a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB</a><br /><strong>Assembly:</strong> RevitAPI (in RevitAPI.dll) Version: 25.0.0.0 (25.0.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDB')" onkeypress="SectionExpandCollapse_CheckKey('IDB', event)" tabindex="0"><img id="IDBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="IDBSection" class="collapsibleSection"><div id="IDAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAB_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cs','1','4');return false;">C#</a></div><div id="IDAB_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','vb','2','4');return false;">VB</a></div><div id="IDAB_tab3" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cpp','3','4');return false;">C++</a></div><div id="IDAB_tab4" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAB');return false;" title="Copy">Copy</a></div></div><div id="IDAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">class</span> <span class="identifier">TransmissionData</span> : <span class="identifier">IDisposable</span></pre></div><div id="IDAB_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Class</span> <span class="identifier">TransmissionData</span>
	<span class="keyword">Implements</span> <span class="identifier">IDisposable</span></pre></div><div id="IDAB_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">ref class</span> <span class="identifier">TransmissionData</span> : <span class="identifier">IDisposable</span></pre></div><div id="IDAB_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">type</span> <span class="identifier">TransmissionData</span> = 
    <span class="keyword">class</span>
        <span class="keyword">interface</span> <span class="identifier">IDisposable</span>
    <span class="keyword">end</span></pre></div></div></div></div><p>The <span class="selflink">TransmissionData</span> type exposes the following members.</p><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDAFA')" onkeypress="SectionExpandCollapse_CheckKey('IDAFA', event)" tabindex="0"><img id="IDAFAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Constructors</span></div><div id="IDAFASection" class="collapsibleSection"><table id="ConstructorList" class="members"><tr><th class="iconColumn"> </th><th>Name</th><th>Description</th></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="1c43043f-c6bf-1e6f-0947-d3001cfef9bd.htm">TransmissionData</a></td><td>
   Constructs a TransmissionData from another TransmissionData
</td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDOFA')" onkeypress="SectionExpandCollapse_CheckKey('IDOFA', event)" tabindex="0"><img id="IDOFAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Properties</span></div><div id="IDOFASection" class="collapsibleSection"><table id="PropertyList" class="members"><tr><th class="iconColumn"> </th><th>Name</th><th>Description</th></tr><tr><td><img src="../icons/pubProperty.gif" alt="Public property" title="Public property" /></td><td><a href="63f74ea4-079d-425a-cab6-427d7ea4f816.htm">IsTransmitted</a></td><td>
   Determines whether this file has been transmitted or not.
</td></tr><tr><td><img src="../icons/pubProperty.gif" alt="Public property" title="Public property" /></td><td><a href="2f060c6b-ec06-aced-2898-7fcd1bf2f522.htm">IsValidObject</a></td><td>
   Specifies whether the .NET object represents a valid Revit entity.
</td></tr><tr><td><img src="../icons/pubProperty.gif" alt="Public property" title="Public property" /></td><td><a href="226b59dd-7774-1d0e-62b5-8893ad2cf4a9.htm">UserData</a></td><td>
   A string which users can store notes in.
</td></tr><tr><td><img src="../icons/pubProperty.gif" alt="Public property" title="Public property" /></td><td><a href="d01d1bca-0cad-3484-378a-c8727d0abac2.htm">Version</a></td><td>
   The format version for TransmissionData
</td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDBFA')" onkeypress="SectionExpandCollapse_CheckKey('IDBFA', event)" tabindex="0"><img id="IDBFAToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Methods</span></div><div id="IDBFASection" class="collapsibleSection"><table id="MethodList" class="members"><tr><th class="iconColumn"> </th><th>Name</th><th>Description</th></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="13b9f9f6-0628-e4fa-04db-1da44408c910.htm">Dispose</a></td><td>Releases all resources used by the <span class="selflink">TransmissionData</span></td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /></td><td><a href="b64eb87e-2c2a-2510-ae8b-a3046e5ecf40.htm">DocumentIsNotTransmitted</a></td><td>
   Determines whether the document at a given file location
   is not transmitted.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)" target="_blank" rel="noopener noreferrer">Equals</a></td><td>Determines whether the specified object is equal to the current object.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="7df7afd5-8c73-30d9-0f01-0690a3861d1f.htm">GetAllExternalFileReferenceIds</a></td><td>
   Gets the ids of all ExternalFileReferences.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="c27ef733-3960-9710-64e9-aa42b01657dc.htm">GetDesiredReferenceData</a></td><td>
   Gets the ExternalFileReference representing path
   and load status information to be used the next time
   this TransmissionData's document is loaded.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode#system-object-gethashcode" target="_blank" rel="noopener noreferrer">GetHashCode</a></td><td>Serves as the default hash function.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="d5e70e0b-69f2-fcb4-0d91-4b184930b68d.htm">GetLastSavedReferenceData</a></td><td>
   Gets the ExternalFileReference representing path
   and load status information concerning the most
   recent time this TransmissionData's document was opened.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.gettype#system-object-gettype" target="_blank" rel="noopener noreferrer">GetType</a></td><td>Gets the <a href="https://learn.microsoft.com/dotnet/api/system.type" target="_blank" rel="noopener noreferrer">Type</a> of the current instance.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /></td><td><a href="3f9fd4b7-147e-a342-e257-394c0ea41de8.htm">IsDocumentTransmitted</a></td><td>
   Determines whether the document at a given file location
   is transmitted.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /></td><td><a href="5158f72e-6f8d-fa45-c7f6-349a86067b8e.htm">ReadTransmissionData</a></td><td>
   Reads the TransmissionData associated with the
   file at the given location.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="25aa4266-9f7f-0e5c-6cad-2e14eb00f984.htm">SetDesiredReferenceData</a></td><td>
   Sets the ExternalFileReference information which
   Revit should use the next time it opens the document
   which this TransmissionData belongs to.
</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /></td><td><a href="https://learn.microsoft.com/dotnet/api/system.object.tostring#system-object-tostring" target="_blank" rel="noopener noreferrer">ToString</a></td><td>Returns a string that represents the current object.<br />(Inherited from <a href="https://learn.microsoft.com/dotnet/api/system.object" target="_blank" rel="noopener noreferrer">Object</a>)</td></tr><tr><td><img src="../icons/pubMethod.gif" alt="Public method" title="Public method" /><img src="../icons/Static.gif" alt="Static member" title="Static member" /></td><td><a href="96561c21-134c-9744-45de-8c3f772f0676.htm">WriteTransmissionData</a></td><td>
   Writes the given TransmissionData into the Revit file at the
   given location.
</td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDBC')" onkeypress="SectionExpandCollapse_CheckKey('IDBC', event)" tabindex="0"><img id="IDBCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="IDBCSection" class="collapsibleSection"><p>TransmissionData stores information on both the previous state
   and requested state of an external file reference.
   This means that it stores the load state and path of the reference
   from the most recent time this TransmissionData's document was opened.
   It also stores load state and path information for what Revit should
   do the next time the document is opened. </p><p>As such, TransmissionData can be used to perform operations on external
   file references without having to open the entire associated Revit
   document. The methods ReadTransmissionData and WriteTransmissionData
   can be used to obtain information about external references, or to
   change that information. For example, calling WriteTransmissionData
   with a TransmissionData object which has had all references set to
   LinkedFileStatus.Unloaded would cause no references to be loaded
   upon next opening the document.</p><p>TransmissionData cannot add or remove references to
   external files. If, on file open, Revit discovers information
   in the TransmissionData which does not correspond to an
   existing external file reference,
   the information will be ignored on file load.</p><p>The TransmissionData for a document does not contain information
   about references which come from external servers. TransmissionData only
   contains references to local files or Revit links on Revit Server.
   TransmissionData cannot
   be used to change a reference from a local file reference to an external
   server reference.</p><p>Note that TransmissionData objects must be set to "transmitted" for
   the requested reference data to be meaningful. Revit ignores the
   TransmissionData for non-transmitted files. Marking a file as
   transmitted has other effects - workshared files are opened as
   detached from the central model, and creation of new local files
   is prohibited, until the file is in its final location and the
   file has been marked as no longer transmitted. </p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDDC')" onkeypress="SectionExpandCollapse_CheckKey('IDDC', event)" tabindex="0"><img id="IDDCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Example</span></div><div id="IDDCSection" class="collapsibleSection"><div id="IDADC" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDADC_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDADC','cs','1','4');return false;">C#</a></div><div id="IDADC_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDADC','vb','2','4');return false;">VB</a></div><div id="IDADC_tab3" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDADC','cpp','3','4');return false;">C++</a></div><div id="IDADC_tab4" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDADC','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDADC_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDADC');return false;" title="Copy">Copy</a></div></div><div id="IDADC_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">void</span> UnloadRevitLinks(ModelPath location)
<span class="highlight-comment">///  This method will set all Revit links to be unloaded the next time the document at the given location is opened. </span>
<span class="highlight-comment">///  The TransmissionData for a given document only contains top-level Revit links, not nested links.</span>
<span class="highlight-comment">///  However, nested links will be unloaded if their parent links are unloaded, so this function only needs to look at the document's immediate links. </span>
{
   <span class="highlight-comment">// access transmission data in the given Revit file</span>
   TransmissionData transData = TransmissionData.ReadTransmissionData(location);

   <span class="highlight-keyword">if</span> (transData != <span class="highlight-keyword">null</span>)
   {
      <span class="highlight-comment">// collect all (immediate) external references in the model</span>
      ICollection&lt;ElementId&gt; externalReferences = transData.GetAllExternalFileReferenceIds();

      <span class="highlight-comment">// find every reference that is a link</span>
      <span class="highlight-keyword">foreach</span> (ElementId refId <span class="highlight-keyword">in</span> externalReferences)
      {
         ExternalFileReference extRef = transData.GetLastSavedReferenceData(refId);

         <span class="highlight-keyword">if</span> (extRef.ExternalFileReferenceType == ExternalFileReferenceType.RevitLink)
         {
            <span class="highlight-comment">// we do not want to change neither the path nor the path-type</span>
            <span class="highlight-comment">// we only want the links to be unloaded (shouldLoad = false)</span>
            transData.SetDesiredReferenceData(refId, extRef.GetPath(), extRef.PathType, <span class="highlight-keyword">false</span>);
         }
      }

      <span class="highlight-comment">// make sure the IsTransmitted property is set </span>
      transData.IsTransmitted = <span class="highlight-keyword">true</span>;

      <span class="highlight-comment">// modified transmission data must be saved back to the model</span>
      TransmissionData.WriteTransmissionData(location, transData);
   }
   <span class="highlight-keyword">else</span>
   {
      Autodesk.Revit.UI.TaskDialog.Show(<span class="highlight-literal">"Unload Links"</span>, <span class="highlight-literal">"The document does not have any transmission data"</span>);
   }
}</pre></div><div id="IDADC_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="highlight-keyword">Private</span> <span class="highlight-keyword">Sub</span> UnloadRevitLinks(location <span class="highlight-keyword">As</span> ModelPath)
    <span class="highlight-comment">'  This method will set all Revit links to be unloaded the next time the document at the given location is opened. </span>
    <span class="highlight-comment">'  The TransmissionData for a given document only contains top-level Revit links, not nested links.</span>
    <span class="highlight-comment">'  However, nested links will be unloaded if their parent links are unloaded, so this function only needs to look at the document's immediate links. </span>
    <span class="highlight-comment">' access transmission data in the given Revit file</span>
    <span class="highlight-keyword">Dim</span> transData <span class="highlight-keyword">As</span> TransmissionData = TransmissionData.ReadTransmissionData(location)

    <span class="highlight-keyword">If</span> transData <span class="highlight-keyword">IsNot</span> <span class="highlight-keyword">Nothing</span> <span class="highlight-keyword">Then</span>
        <span class="highlight-comment">' collect all (immediate) external references in the model</span>
        <span class="highlight-keyword">Dim</span> externalReferences <span class="highlight-keyword">As</span> ICollection(<span class="highlight-keyword">Of</span> ElementId) = transData.GetAllExternalFileReferenceIds()

        <span class="highlight-comment">' find every reference that is a link</span>
        <span class="highlight-keyword">For</span> <span class="highlight-keyword">Each</span> refId <span class="highlight-keyword">As</span> ElementId <span class="highlight-keyword">In</span> externalReferences
            <span class="highlight-keyword">Dim</span> extRef <span class="highlight-keyword">As</span> ExternalFileReference = transData.GetLastSavedReferenceData(refId)

            <span class="highlight-keyword">If</span> extRef.ExternalFileReferenceType = ExternalFileReferenceType.RevitLink <span class="highlight-keyword">Then</span>
                <span class="highlight-comment">' we do not want to change neither the path nor the path-type</span>
                <span class="highlight-comment">' we only want the links to be unloaded (shouldLoad = false)</span>
                transData.SetDesiredReferenceData(refId, extRef.GetPath(), extRef.PathType, <span class="highlight-keyword">False</span>)
            <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
        <span class="highlight-keyword">Next</span>

        <span class="highlight-comment">' make sure the IsTransmitted property is set </span>
        transData.IsTransmitted = <span class="highlight-keyword">True</span>

        <span class="highlight-comment">' modified transmission data must be saved back to the model</span>
        TransmissionData.WriteTransmissionData(location, transData)
    <span class="highlight-keyword">Else</span>
        Autodesk.Revit.UI.TaskDialog.Show(<span class="highlight-literal">"Unload Links"</span>, <span class="highlight-literal">"The document does not have any transmission data"</span>)
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span></pre></div><div id="IDADC_code_Div3" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div><div id="IDADC_code_Div4" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div></div></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Reference</h4><div><a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB Namespace</a></div></div></div></div><div id="PageFooter" class="pageFooter"><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:revitapifeedback%40autodesk.com?Subject=Revit%202025%20API">Autodesk</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        </script></div></body></html>