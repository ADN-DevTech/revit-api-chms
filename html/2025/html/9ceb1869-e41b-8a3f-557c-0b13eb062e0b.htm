<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="Microsoft.Help.SelfBranded" content="true" /><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Locale" content="en-us" /><meta name="Microsoft.Help.TopicLocale" content="en-us" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"></script><title>Document.NewRoom(Room, PlanCircuit) Method</title><meta name="Title" content="NewRoom(Room, PlanCircuit) Method" /><meta name="Microsoft.Help.Id" content="M:Autodesk.Revit.Creation.Document.NewRoom(Autodesk.Revit.DB.Architecture.Room,Autodesk.Revit.DB.PlanCircuit)" /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="container" content="Autodesk.Revit.Creation" /><meta name="file" content="9ceb1869-e41b-8a3f-557c-0b13eb062e0b" /><meta name="guid" content="9ceb1869-e41b-8a3f-557c-0b13eb062e0b" /><meta name="Microsoft.Help.Category" content="CSharp" /><meta name="Microsoft.Help.Category" content="VB" /><meta name="Description" content="Creates a new room within the confines of a plan circuit, or places an unplaced room within the confines of the plan circuit." /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Help1.css" /></head><body onload="SetDefaultLanguage('cs');"><input type="hidden" id="userDataCache" class="userDataStyle" /><div id="PageHeader" class="pageHeader">Revit 2025 API</div><div class="pageBody"><div id="TopicContent" class="topicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Document<span id="LST89FE8A2A_0" data-languageSpecificText="cpp=::|nu=."></span>New<wbr />Room(Room, Plan<wbr />Circuit) Method</h1></td></tr></table><div class="summary"> Creates a new room within the confines of a plan circuit, or places an unplaced room within the confines of the plan circuit. </div><br /><strong>Namespace:</strong> <a href="ded320da-058a-4edd-0418-0582389559a7.htm">Autodesk.Revit.Creation</a><br /><strong>Assembly:</strong> RevitAPI (in RevitAPI.dll) Version: 25.0.0.0 (25.0.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDB')" onkeypress="SectionExpandCollapse_CheckKey('IDB', event)" tabindex="0"><img id="IDBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="IDBSection" class="collapsibleSection"><div id="IDAB" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAB_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cs','1','4');return false;">C#</a></div><div id="IDAB_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','vb','2','4');return false;">VB</a></div><div id="IDAB_tab3" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','cpp','3','4');return false;">C++</a></div><div id="IDAB_tab4" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAB','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAB_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAB');return false;" title="Copy">Copy</a></div></div><div id="IDAB_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="identifier">Room</span> <span class="identifier">NewRoom</span>(
	<span class="identifier">Room</span> <span class="parameter">room</span>,
	<span class="identifier">PlanCircuit</span> <span class="parameter">circuit</span>
)</pre></div><div id="IDAB_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Function</span> <span class="identifier">NewRoom</span> ( 
	<span class="parameter">room</span> <span class="keyword">As</span> <span class="identifier">Room</span>,
	<span class="parameter">circuit</span> <span class="keyword">As</span> <span class="identifier">PlanCircuit</span>
) <span class="keyword">As</span> <span class="identifier">Room</span></pre></div><div id="IDAB_code_Div3" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="identifier">Room</span>^ <span class="identifier">NewRoom</span>(
	<span class="identifier">Room</span>^ <span class="parameter">room</span>, 
	<span class="identifier">PlanCircuit</span>^ <span class="parameter">circuit</span>
)</pre></div><div id="IDAB_code_Div4" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="keyword">member</span> <span class="identifier">NewRoom</span> : 
        <span class="parameter">room</span> : <span class="identifier">Room</span> * 
        <span class="parameter">circuit</span> : <span class="identifier">PlanCircuit</span> <span class="keyword">-&gt;</span> <span class="identifier">Room</span> </pre></div></div></div><h4>Parameters</h4><dl><dt class="has-text-weight-normal"><span class="parameter">room</span>  <a href="75c9d2c7-a402-ea8b-9e7c-f8bc3510bbd5.htm">Room</a></dt><dd> The room which you want to locate in the circuit.  Pass <span class="keyword"><span id="LST89FE8A2A_1" data-languageSpecificText="cpp=nullptr|vb=Nothing|nu=null"></span></span> to create a new room. </dd><dt class="has-text-weight-normal"><span class="parameter">circuit</span>  <a href="9fdb77cb-c579-1cbd-71de-01f06a18ea3a.htm">PlanCircuit</a></dt><dd> The circuit in which you want to locate a room. </dd></dl><h4>Return Value</h4><a href="75c9d2c7-a402-ea8b-9e7c-f8bc3510bbd5.htm">Room</a><br /> If successful the room is returned, otherwise <span class="keyword"><span id="LST89FE8A2A_2" data-languageSpecificText="cpp=nullptr|vb=Nothing|nu=null"></span></span>. </div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDEC')" onkeypress="SectionExpandCollapse_CheckKey('IDEC', event)" tabindex="0"><img id="IDECToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Exceptions</span></div><div id="IDECSection" class="collapsibleSection"><table><tr><th>Exception</th><th>Condition</th></tr><tr><td><a href="9e715f03-3884-e539-4dd6-8d7545733adc.htm">InvalidOperationException</a></td><td>If the existing room is already placed.</td></tr><tr><td><a href="2e6e4206-97a8-dd4b-df5d-4269f4bb6088.htm">ArgumentException</a></td><td>Thrown if the room does not exist in the given document.</td></tr><tr><td><a href="2e6e4206-97a8-dd4b-df5d-4269f4bb6088.htm">ArgumentException</a></td><td>Thrown if the circuit does not exist in the given document.</td></tr><tr><td><a href="9e715f03-3884-e539-4dd6-8d7545733adc.htm">InvalidOperationException</a></td><td>Thrown if the level obtained from the circuit has no associated view .</td></tr></table></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDFC')" onkeypress="SectionExpandCollapse_CheckKey('IDFC', event)" tabindex="0"><img id="IDFCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="IDFCSection" class="collapsibleSection"> This method will regenerate the document even in manual regeneration mode. </div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('IDJC')" onkeypress="SectionExpandCollapse_CheckKey('IDJC', event)" tabindex="0"><img id="IDJCToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Example</span></div><div id="IDJCSection" class="collapsibleSection"><div id="IDAJC" class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="IDAJC_tab1" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAJC','cs','1','4');return false;">C#</a></div><div id="IDAJC_tab2" class="codeSnippetContainerTab"><a href="#" onclick="ChangeTab('IDAJC','vb','2','4');return false;">VB</a></div><div id="IDAJC_tab3" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDAJC','cpp','3','4');return false;">C++</a></div><div id="IDAJC_tab4" class="codeSnippetContainerTabPhantom"><a href="#" onclick="ChangeTab('IDAJC','fs','4','4');return false;">F#</a></div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="IDAJC_copyCode" href="#" class="copyCodeSnippet" onclick="CopyToClipboard('IDAJC');return false;" title="Copy">Copy</a></div></div><div id="IDAJC_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">Room InsertNewRoomInPlanCircuit(Autodesk.Revit.DB.Document document, Level level, Phase newConstructionPhase)
{
    <span class="highlight-comment">// create room using Phase</span>
    Room newScheduleRoom = document.Create.NewRoom(newConstructionPhase);

    <span class="highlight-comment">// set the Room Number and Name</span>
    <span class="highlight-keyword">string</span> newRoomNumber = <span class="highlight-literal">"101"</span>;
    <span class="highlight-keyword">string</span> newRoomName = <span class="highlight-literal">"Class Room 1"</span>;
    newScheduleRoom.Name = newRoomName;
    newScheduleRoom.Number = newRoomNumber;

    <span class="highlight-comment">// Get a PlanCircuit</span>
    PlanCircuit planCircuit = <span class="highlight-keyword">null</span>;
    <span class="highlight-comment">// first get the plan topology for given level</span>
    PlanTopology planTopology = document.get_PlanTopology(level);

    <span class="highlight-comment">// Iterate circuits in this plan topology</span>
    <span class="highlight-keyword">foreach</span> (PlanCircuit circuit <span class="highlight-keyword">in</span> planTopology.Circuits)
    {
        <span class="highlight-comment">// get the first circuit we find</span>
        <span class="highlight-keyword">if</span> (<span class="highlight-keyword">null</span> != circuit)
        {
            planCircuit = circuit;
            <span class="highlight-keyword">break</span>;
        }
    }

    Room newRoom2 = <span class="highlight-keyword">null</span>;
    <span class="highlight-keyword">if</span> (<span class="highlight-keyword">null</span> != planCircuit)
    {
        <span class="highlight-keyword">using</span> (Transaction transaction = <span class="highlight-keyword">new</span> Transaction(document, <span class="highlight-literal">"Create Room"</span>))
        {
           <span class="highlight-keyword">if</span> (transaction.Start() == TransactionStatus.Started)
           {
               <span class="highlight-comment">// The input room must exist only in the room schedule, </span>
               <span class="highlight-comment">// meaning that it does not display in any plan view.</span>
               newRoom2 = document.Create.NewRoom(newScheduleRoom, planCircuit);
               <span class="highlight-comment">// a model room with the same name and number is created in the </span>
               <span class="highlight-comment">// view where the PlanCircuit is located</span>
               <span class="highlight-keyword">if</span> (<span class="highlight-keyword">null</span> != newRoom2)
               {
                   <span class="highlight-comment">// Give the user some information</span>
                   TaskDialog.Show(<span class="highlight-literal">"Revit"</span>, <span class="highlight-literal">"Room placed in Plan Circuit successfully."</span>);
               }
               transaction.Commit();
           }
        }
    }

    <span class="highlight-keyword">return</span> newRoom2;
}</pre></div><div id="IDAJC_code_Div2" class="codeSnippetContainerCode" style="display: none"><pre xml:space="preserve"><span class="highlight-keyword">Private</span> <span class="highlight-keyword">Function</span> InsertNewRoomInPlanCircuit(document <span class="highlight-keyword">As</span> Autodesk.Revit.DB.Document, level <span class="highlight-keyword">As</span> Level, newConstructionPhase <span class="highlight-keyword">As</span> Phase) <span class="highlight-keyword">As</span> Room
    <span class="highlight-comment">' create room using Phase</span>
    <span class="highlight-keyword">Dim</span> newScheduleRoom <span class="highlight-keyword">As</span> Room = document.Create.NewRoom(newConstructionPhase)

    <span class="highlight-comment">' set the Room Number and Name</span>
    <span class="highlight-keyword">Dim</span> newRoomNumber <span class="highlight-keyword">As</span> <span class="highlight-keyword">String</span> = <span class="highlight-literal">"101"</span>
    <span class="highlight-keyword">Dim</span> newRoomName <span class="highlight-keyword">As</span> <span class="highlight-keyword">String</span> = <span class="highlight-literal">"Class Room 1"</span>
    newScheduleRoom.Name = newRoomName
    newScheduleRoom.Number = newRoomNumber

    <span class="highlight-comment">' Get a PlanCircuit</span>
    <span class="highlight-keyword">Dim</span> planCircuit <span class="highlight-keyword">As</span> PlanCircuit = <span class="highlight-keyword">Nothing</span>
    <span class="highlight-comment">' first get the plan topology for given level</span>
    <span class="highlight-keyword">Dim</span> planTopology <span class="highlight-keyword">As</span> PlanTopology = document.PlanTopology(level)

    <span class="highlight-comment">' Iterate circuits in this plan topology</span>
    <span class="highlight-keyword">For</span> <span class="highlight-keyword">Each</span> circuit <span class="highlight-keyword">As</span> PlanCircuit <span class="highlight-keyword">In</span> planTopology.Circuits
        <span class="highlight-comment">' get the first circuit we find</span>
        <span class="highlight-keyword">If</span> circuit <span class="highlight-keyword">IsNot</span> <span class="highlight-keyword">Nothing</span> <span class="highlight-keyword">Then</span>
            planCircuit = circuit
            <span class="highlight-keyword">Exit</span> <span class="highlight-keyword">For</span>
        <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
    <span class="highlight-keyword">Next</span>

    <span class="highlight-keyword">Dim</span> newRoom2 <span class="highlight-keyword">As</span> Room = <span class="highlight-keyword">Nothing</span>
    <span class="highlight-keyword">If</span> planCircuit <span class="highlight-keyword">IsNot</span> <span class="highlight-keyword">Nothing</span> <span class="highlight-keyword">Then</span>
        <span class="highlight-keyword">Using</span> transaction <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> Transaction(document, <span class="highlight-literal">"Create Room"</span>)
            <span class="highlight-keyword">If</span> transaction.Start() = TransactionStatus.Started <span class="highlight-keyword">Then</span>
                <span class="highlight-comment">' The input room must exist only in the room schedule, </span>
                <span class="highlight-comment">' meaning that it does not display in any plan view.</span>
                newRoom2 = document.Create.NewRoom(newScheduleRoom, planCircuit)
                <span class="highlight-comment">' a model room with the same name and number is created in the </span>
                <span class="highlight-comment">' view where the PlanCircuit is located</span>
                <span class="highlight-keyword">If</span> newRoom2 <span class="highlight-keyword">IsNot</span> <span class="highlight-keyword">Nothing</span> <span class="highlight-keyword">Then</span>
                    <span class="highlight-comment">' Give the user some information</span>
                    TaskDialog.Show(<span class="highlight-literal">"Revit"</span>, <span class="highlight-literal">"Room placed in Plan Circuit successfully."</span>)
                <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
                transaction.Commit()
            <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
        <span class="highlight-keyword">End</span> <span class="highlight-keyword">Using</span>
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>

    <span class="highlight-keyword">Return</span> newRoom2
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Function</span></pre></div><div id="IDAJC_code_Div3" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div><div id="IDAJC_code_Div4" class="codeSnippetContainerCode" style="display: none"><p>No code example is currently available or this language may not be supported.</p></div></div></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('seeAlso')" onkeypress="SectionExpandCollapse_CheckKey('seeAlso', event)" tabindex="0"><img id="seeAlsoToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="seeAlsoSection" class="collapsibleSection"><h4>Reference</h4><div><a href="ab1718f9-45fb-b3d3-827e-32ff81cf929c.htm">Document Class</a></div><div><a href="f057ddd6-b007-0f98-5837-f16845e01e00.htm">NewRoom Overload</a></div><div><a href="ded320da-058a-4edd-0418-0582389559a7.htm">Autodesk.Revit.Creation Namespace</a></div></div></div></div><div id="PageFooter" class="pageFooter"><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:revitapifeedback%40autodesk.com?Subject=Revit%202025%20API">Autodesk</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        </script></div></body></html>