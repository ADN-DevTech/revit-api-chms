<html xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Geometry Property </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="Geometry property" /><meta name="System.Keywords" content="Element.Geometry property" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.DB.Element.Geometry" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.DB.Element.get_Geometry" /><meta name="Microsoft.Help.Id" content="P:Autodesk.Revit.DB.Element.Geometry(Autodesk.Revit.DB.Options)" /><meta name="Description" content="Retrieves the geometric representation of the element." /><meta name="Microsoft.Help.ContentType" content="Reference" /><link rel="stylesheet" type="text/css" href="../styles/Presentation.css" /><link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLink.css" /><script type="text/javascript" src="../scripts/EventUtilities.js"> </script><script type="text/javascript" src="../scripts/SplitScreen.js"> </script><script type="text/javascript" src="../scripts/Dropdown.js"> </script><script type="text/javascript" src="../scripts/script_manifold.js"> </script><script type="text/javascript" src="../scripts/script_feedBack.js"> </script><script type="text/javascript" src="../scripts/CheckboxMenu.js"> </script><script type="text/javascript" src="../scripts/CommonUtilities.js"> </script><meta name="container" content="Autodesk.Revit.DB" /><meta name="file" content="d8a55a5b-2a69-d5ab-3e1f-6cf1ee43c8ec" /><meta name="guid" content="d8a55a5b-2a69-d5ab-3e1f-6cf1ee43c8ec" /><xml><MSHelp:Attr Name="AssetID" Value="P:Autodesk.Revit.DB.Element.Geometry(Autodesk.Revit.DB.Options)" /><MSHelp:TOCTitle Title="Geometry Property " /><MSHelp:RLTitle Title="Element.Geometry Property  (Autodesk.Revit.DB)" /><MSHelp:Keyword Index="A" Term="P:Autodesk.Revit.DB.Element.Geometry(Autodesk.Revit.DB.Options)" /><MSHelp:Keyword Index="A" Term="frlrfAutodeskRevitDBElementClassGeometryTopic" /><MSHelp:Keyword Index="K" Term="Geometry property" /><MSHelp:Keyword Index="K" Term="Element.Geometry property" /><MSHelp:Keyword Index="F" Term="Autodesk.Revit.DB.Element.Geometry" /><MSHelp:Attr Name="APIType" Value="Managed" /><MSHelp:Attr Name="APILocation" Value="RevitAPI.dll" /><MSHelp:Attr Name="APIName" Value="Autodesk.Revit.DB.Element.Geometry" /><MSHelp:Attr Name="APIName" Value="Autodesk.Revit.DB.Element.get_Geometry" /><MSHelp:Attr Name="DevLang" Value="CSharp" /><MSHelp:Attr Name="DevLang" Value="VB" /><MSHelp:Attr Name="Locale" Value="en-us" /><MSHelp:Attr Name="TopicType" Value="kbSyntax" /><MSHelp:Attr Name="TopicType" Value="apiref" /><MSHelp:Attr Name="Abstract" Value="Retrieves the geometric representation of the element." /><MSHelp:Attr Name="AssemblyVersion" Value="23.0.0.0" /></xml><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script></head><body><input type="hidden" id="userDataCache" class="userDataStyle" /><input type="hidden" id="hiddenScrollOffset" /><img id="collapseImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" alt="Collapse image" title="Collapse image" /><img id="expandImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" alt="Expand Image" title="Expand Image" /><img id="collapseAllImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" /><img id="expandAllImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" /><img id="dropDownImage" style="display:none; height:0; width:0;" src="../icons/dropdown.gif" /><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../icons/dropdownHover.gif" /><img id="copyImage" style="display:none; height:0; width:0;" src="../icons/copycode.gif" alt="Copy image" title="Copy image" /><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../icons/copycodeHighlight.gif" alt="CopyHover image" title="CopyHover image" /><div id="header"><table id="topTable" cellspacing="0" cellpadding="0"><tr><td><span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage, event)" tabindex="0"><img ID="toggleAllImage" class="toggleAll" src="../icons/collapse_all.gif" /> <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">Collapse All</label><label id="expandAllLabel" for="toggleAllImage" style="display: none;">Expand All</label> </span><span>    </span><span id="devlangsDropdown" class="filter" tabindex="0"><img id="devlangsDropdownImage" src="../icons/dropdown.gif" /> <label id="devlangsMenuAllLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: All </nobr></label><label id="devlangsMenuMultipleLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Multiple </nobr></label><label id="devlangsMenuCSharpLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: C# </nobr></label><label id="devlangsMenuVisualBasicLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Visual Basic </nobr></label><label id="devlangsMenuManagedCPlusPlusLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Visual C++ </nobr></label></span></td></tr></table><div id="devlangsMenu"><input id="CSharpCheckbox" type="checkbox" data="CSharp,cs,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="CSharpCheckbox">C#</label><br /><input id="VisualBasicCheckbox" type="checkbox" data="VisualBasic,vb,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="VisualBasicCheckbox">Visual Basic</label><br /><input id="ManagedCPlusPlusCheckbox" type="checkbox" data="ManagedCPlusPlus,cpp,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="ManagedCPlusPlusCheckbox">Visual C++</label><br /></div><table id="bottomTable" cellpadding="0" cellspacing="0"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText">Revit 2023 API</span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Element<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>Geometry Property </span></td></tr><tr id="headerTableRow3"><td align="left"><a href="eb16114f-69ea-f4de-0d0d-f7388b105a16.htm">Element Class</a> <a href="#exampleToggle" onclick="OpenSection(exampleToggle)">Example</a> <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> <span id="headfeedbackarea" class="feedbackhead"><a href="javascript:SubmitFeedback('revitapifeedback@autodesk.com','Revit 2023 API','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback');">Send Feedback</a></span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()" /><span style="color: DarkGray"></span><div class="summary">Retrieves the geometric representation of the element.</div><p /><b>Namespace:</b> <a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB</a><br /><b>Assembly:</b> <span sdata="assembly">RevitAPI</span> (in RevitAPI.dll) Version: 23.0.0.0 (23.1.0.0)<h1 class="heading"><span onclick="ExpandCollapse(syntaxToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(syntaxToggle, event)" tabindex="0"><img id="syntaxToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Syntax</span></h1><div id="syntaxSection" class="section" name="collapseableSection" style=""><div id="syntaxCodeBlocks" class="code"><span codeLanguage="CSharp"><table><tr><th>C#</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> <a href="09eaeb08-58bb-8049-8925-f3a5aa846fdc.htm">GeometryElement</a> <span class="keyword">this</span>[
	<a href="aa41fc13-9f81-836c-4271-82568ba5d7e8.htm">Options</a> <span class="parameter">options</span>
] { <span class="keyword">get</span>; }</pre></td></tr></table></span><span codeLanguage="VisualBasicDeclaration"><table><tr><th>Visual Basic</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">ReadOnly</span> <span class="keyword">Property</span> <span class="identifier">Geometry</span> ( _
	<span class="parameter">options</span> <span class="keyword">As</span> <a href="aa41fc13-9f81-836c-4271-82568ba5d7e8.htm">Options</a> _
) <span class="keyword">As</span> <a href="09eaeb08-58bb-8049-8925-f3a5aa846fdc.htm">GeometryElement</a>
	<span class="keyword">Get</span></pre></td></tr></table></span><span codeLanguage="ManagedCPlusPlus"><table><tr><th>Visual C++</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="keyword">property</span> <a href="09eaeb08-58bb-8049-8925-f3a5aa846fdc.htm">GeometryElement</a>^ <span class="identifier">Geometry</span>[<a href="aa41fc13-9f81-836c-4271-82568ba5d7e8.htm">Options</a>^ <span class="parameter">options</span>] {
	<a href="09eaeb08-58bb-8049-8925-f3a5aa846fdc.htm">GeometryElement</a>^ <span class="keyword">get</span> (<a href="aa41fc13-9f81-836c-4271-82568ba5d7e8.htm">Options</a>^ <span class="parameter">options</span>);
}</pre></td></tr></table></span></div><div id="parameters"><h4 class="subHeading">Parameters</h4><dl paramName="options"><dt><span class="parameter">options</span></dt><dd>Type: <a href="aa41fc13-9f81-836c-4271-82568ba5d7e8.htm">Autodesk.Revit.DB<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>Options</a><br />User preferences for parsing of geometry.</dd></dl></div><h4 class="subHeading">Field Value</h4>An object that provides access to the geometry of the element.</div><h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle, event)" tabindex="0"><img id="remarksToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style=""><p>This call will retrieve 3d representation of the element. <span class="keyword"><span class="languageSpecificText"><span class="cs">null</span><span class="vb">Nothing</span><span class="cpp">nullptr</span></span></span><span class="nu">a null reference (<span class="keyword">Nothing</span> in Visual Basic)</span> will be returned
for symbols, annotations or details. This involves extensive parsing or Revit's data
structures, so try to minimize calls if performance is critical.</p><p>Geometry objects provided from this method are obtained directly from the element. When
the element is changed for any reason, the geometry will be recalculated by Revit and geometry
objects obtained before the change are likely to no longer be valid.  If you need to preserve
geometry information obtained an element even after changes to that element, you should copy
the geometry objects or save the properties independently.</p><p>Although the geometry obtained from this method comes directly from the element, any attempt to modify 
any of the geometry objects will operate only on a disconnected copy of the original geometry object from the element.  
The modification will not affect the geometry of the original element from which it was obtained - 
to change the geometry of the element you must use methods that directly affect the geometry calculated or 
stored by Revit for this element.</p><p>If you require that the geometry items obtained contain valid 
<a href="d28155ae-817b-1f31-9c3f-c9c6a28acc0d.htm">Reference objects</a>, be sure to set the ComputeReferences
property of the Options.</p></div><h1 class="heading"><span onclick="ExpandCollapse(exampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exampleToggle, event)" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Examples</span></h1><div id="exampleSection" class="section" name="collapseableSection" style=""><span id="cbc_1" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/CopyCode.gif" />Copy</span>C#</div><div class="code"><pre xml:space="preserve"><span class="highlight-keyword">public</span> <span class="highlight-keyword">void</span> GetCurvesFromABeam(Autodesk.Revit.DB.FamilyInstance beam,
                               Autodesk.Revit.DB.Options options)
{
    Autodesk.Revit.DB.GeometryElement geomElem = beam.get_Geometry(options);

    Autodesk.Revit.DB.CurveArray curves = <span class="highlight-keyword">new</span> CurveArray();
    System.Collections.Generic.List&lt;Autodesk.Revit.DB.Solid&gt; solids = <span class="highlight-keyword">new</span> System.Collections.Generic.List&lt;Autodesk.Revit.DB.Solid&gt;(); 

    <span class="highlight-comment">//Find all solids and insert them into solid array</span>
    AddCurvesAndSolids(geomElem, <span class="highlight-keyword">ref</span> curves, <span class="highlight-keyword">ref</span> solids);
}

<span class="highlight-keyword">private</span> <span class="highlight-keyword">void</span> AddCurvesAndSolids(Autodesk.Revit.DB.GeometryElement geomElem,
                                <span class="highlight-keyword">ref</span> Autodesk.Revit.DB.CurveArray curves,
                                <span class="highlight-keyword">ref</span> System.Collections.Generic.List&lt;Autodesk.Revit.DB.Solid&gt; solids)
{
    <span class="highlight-keyword">foreach</span> (Autodesk.Revit.DB.GeometryObject geomObj <span class="highlight-keyword">in</span> geomElem)
    {
        Autodesk.Revit.DB.Curve curve = geomObj <span class="highlight-keyword">as</span> Autodesk.Revit.DB.Curve;
        <span class="highlight-keyword">if</span> (<span class="highlight-keyword">null</span> != curve)
        {
            curves.Append(curve);
            <span class="highlight-keyword">continue</span>;
        }
        Autodesk.Revit.DB.Solid solid = geomObj <span class="highlight-keyword">as</span> Autodesk.Revit.DB.Solid;
        <span class="highlight-keyword">if</span> (<span class="highlight-keyword">null</span> != solid)
        {
            solids.Add(solid);
            <span class="highlight-keyword">continue</span>;
        }
        <span class="highlight-comment">//If this GeometryObject is Instance, call AddCurvesAndSolids</span>
        Autodesk.Revit.DB.GeometryInstance geomInst = geomObj <span class="highlight-keyword">as</span> Autodesk.Revit.DB.GeometryInstance;
        <span class="highlight-keyword">if</span> (<span class="highlight-keyword">null</span> != geomInst)
        {
            Autodesk.Revit.DB.GeometryElement transformedGeomElem
              = geomInst.GetInstanceGeometry(geomInst.Transform);
            AddCurvesAndSolids(transformedGeomElem, <span class="highlight-keyword">ref</span> curves, <span class="highlight-keyword">ref</span> solids);
        }
    }
}</pre></div></span><span id="cbc_2" x-lang="VisualBasic" codeLanguage="VisualBasic"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/CopyCode.gif" />Copy</span>VB.NET</div><div class="code"><pre xml:space="preserve">  <span class="highlight-keyword">Public</span> <span class="highlight-keyword">Sub</span> GetCurvesFromABeam(beam <span class="highlight-keyword">As</span> Autodesk.Revit.DB.FamilyInstance, options <span class="highlight-keyword">As</span> Autodesk.Revit.DB.Options)
      <span class="highlight-keyword">Dim</span> geomElem <span class="highlight-keyword">As</span> Autodesk.Revit.DB.GeometryElement = beam.Geometry(options)

      <span class="highlight-keyword">Dim</span> curves <span class="highlight-keyword">As</span> Autodesk.Revit.DB.CurveArray = <span class="highlight-keyword">New</span> CurveArray()
   <span class="highlight-keyword">Dim</span> solids <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> System.Collections.Generic.List(<span class="highlight-keyword">Of</span> Autodesk.Revit.DB.Solid)

      <span class="highlight-comment">'Find all solids and insert them into solid array</span>
      AddCurvesAndSolids(geomElem, curves, solids)
  <span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span>

<span class="highlight-keyword">Private</span> <span class="highlight-keyword">Sub</span> AddCurvesAndSolids(geomElem <span class="highlight-keyword">As</span> Autodesk.Revit.DB.GeometryElement, <span class="highlight-keyword">ByRef</span> curves <span class="highlight-keyword">As</span> Autodesk.Revit.DB.CurveArray, <span class="highlight-keyword">ByRef</span> solids <span class="highlight-keyword">As</span> System.Collections.Generic.List(<span class="highlight-keyword">Of</span> Autodesk.Revit.DB.Solid))
   <span class="highlight-keyword">For</span> <span class="highlight-keyword">Each</span> geomObj <span class="highlight-keyword">As</span> Autodesk.Revit.DB.GeometryObject <span class="highlight-keyword">In</span> geomElem
      <span class="highlight-keyword">Dim</span> curve <span class="highlight-keyword">As</span> Autodesk.Revit.DB.Curve = <span class="highlight-keyword">TryCast</span>(geomObj, Autodesk.Revit.DB.Curve)
      <span class="highlight-keyword">If</span> curve <span class="highlight-keyword">IsNot</span> <span class="highlight-keyword">Nothing</span> <span class="highlight-keyword">Then</span>
         curves.Append(curve)
         <span class="highlight-keyword">Continue</span> <span class="highlight-keyword">For</span>
      <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
      <span class="highlight-keyword">Dim</span> solid <span class="highlight-keyword">As</span> Autodesk.Revit.DB.Solid = <span class="highlight-keyword">TryCast</span>(geomObj, Autodesk.Revit.DB.Solid)
      <span class="highlight-keyword">If</span> solid <span class="highlight-keyword">IsNot</span> <span class="highlight-keyword">Nothing</span> <span class="highlight-keyword">Then</span>
         solids.Add(solid)
         <span class="highlight-keyword">Continue</span> <span class="highlight-keyword">For</span>
      <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
      <span class="highlight-comment">'If this GeometryObject is Instance, call AddCurvesAndSolids</span>
      <span class="highlight-keyword">Dim</span> geomInst <span class="highlight-keyword">As</span> Autodesk.Revit.DB.GeometryInstance = <span class="highlight-keyword">TryCast</span>(geomObj, Autodesk.Revit.DB.GeometryInstance)
      <span class="highlight-keyword">If</span> geomInst <span class="highlight-keyword">IsNot</span> <span class="highlight-keyword">Nothing</span> <span class="highlight-keyword">Then</span>
         <span class="highlight-keyword">Dim</span> transformedGeomElem <span class="highlight-keyword">As</span> Autodesk.Revit.DB.GeometryElement = geomInst.GetInstanceGeometry(geomInst.Transform)
         AddCurvesAndSolids(transformedGeomElem, curves, solids)
      <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
   <span class="highlight-keyword">Next</span>
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span></pre></div></span></div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle, event)" tabindex="0"><img id="seeAlsoToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><a href="eb16114f-69ea-f4de-0d0d-f7388b105a16.htm">Element Class</a></div><div class="seeAlsoStyle"><a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB Namespace</a></div></div></div><div id="footer"><div class="footerLine"><img width="100%" height="3px" src="../icons/footer.gif" alt="Footer image" title="Footer image" /></div><A NAME="feedback"></A><span id="fb" class="feedbackcss"></span><p />Send comments on this topic to
        <a id="HT_MailLink" href="mailto:revitapifeedback%40autodesk.com?Subject=Revit 2023 API">Autodesk</a><script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title;
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div></div></body></html>