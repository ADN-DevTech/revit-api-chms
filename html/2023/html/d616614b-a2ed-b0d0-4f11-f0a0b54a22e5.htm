<html xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>SunAndShadowSettings Class</title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="SunAndShadowSettings class" /><meta name="System.Keywords" content="Autodesk.Revit.DB.SunAndShadowSettings class" /><meta name="System.Keywords" content="SunAndShadowSettings class, about SunAndShadowSettings class" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.DB.SunAndShadowSettings" /><meta name="Microsoft.Help.Id" content="T:Autodesk.Revit.DB.SunAndShadowSettings" /><meta name="Description" content="The SunAndShadowSettings class represents the sun control." /><meta name="Microsoft.Help.ContentType" content="Reference" /><link rel="stylesheet" type="text/css" href="../styles/Presentation.css" /><link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLink.css" /><script type="text/javascript" src="../scripts/EventUtilities.js"> </script><script type="text/javascript" src="../scripts/SplitScreen.js"> </script><script type="text/javascript" src="../scripts/Dropdown.js"> </script><script type="text/javascript" src="../scripts/script_manifold.js"> </script><script type="text/javascript" src="../scripts/script_feedBack.js"> </script><script type="text/javascript" src="../scripts/CheckboxMenu.js"> </script><script type="text/javascript" src="../scripts/CommonUtilities.js"> </script><meta name="container" content="Autodesk.Revit.DB" /><meta name="file" content="d616614b-a2ed-b0d0-4f11-f0a0b54a22e5" /><meta name="guid" content="d616614b-a2ed-b0d0-4f11-f0a0b54a22e5" /><xml><MSHelp:Attr Name="AssetID" Value="T:Autodesk.Revit.DB.SunAndShadowSettings" /><MSHelp:TOCTitle Title="SunAndShadowSettings Class" /><MSHelp:RLTitle Title="SunAndShadowSettings Class (Autodesk.Revit.DB)" /><MSHelp:Keyword Index="A" Term="T:Autodesk.Revit.DB.SunAndShadowSettings" /><MSHelp:Keyword Index="A" Term="frlrfAutodeskRevitDBSunAndShadowSettingsClassTopic" /><MSHelp:Keyword Index="K" Term="SunAndShadowSettings class" /><MSHelp:Keyword Index="K" Term="Autodesk.Revit.DB.SunAndShadowSettings class" /><MSHelp:Keyword Index="K" Term="SunAndShadowSettings class, about SunAndShadowSettings class" /><MSHelp:Keyword Index="F" Term="Autodesk.Revit.DB.SunAndShadowSettings" /><MSHelp:Attr Name="HelpPriority" Value="2" /><MSHelp:Attr Name="APIType" Value="Managed" /><MSHelp:Attr Name="APILocation" Value="RevitAPI.dll" /><MSHelp:Attr Name="APIName" Value="Autodesk.Revit.DB.SunAndShadowSettings" /><MSHelp:Attr Name="DevLang" Value="CSharp" /><MSHelp:Attr Name="DevLang" Value="VB" /><MSHelp:Attr Name="Locale" Value="en-us" /><MSHelp:Attr Name="TopicType" Value="kbSyntax" /><MSHelp:Attr Name="TopicType" Value="apiref" /><MSHelp:Attr Name="Abstract" Value="The SunAndShadowSettings class represents the sun control." /><MSHelp:Attr Name="AssemblyVersion" Value="23.0.0.0" /></xml><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script></head><body><input type="hidden" id="userDataCache" class="userDataStyle" /><input type="hidden" id="hiddenScrollOffset" /><img id="collapseImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" alt="Collapse image" title="Collapse image" /><img id="expandImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" alt="Expand Image" title="Expand Image" /><img id="collapseAllImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" /><img id="expandAllImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" /><img id="dropDownImage" style="display:none; height:0; width:0;" src="../icons/dropdown.gif" /><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../icons/dropdownHover.gif" /><img id="copyImage" style="display:none; height:0; width:0;" src="../icons/copycode.gif" alt="Copy image" title="Copy image" /><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../icons/copycodeHighlight.gif" alt="CopyHover image" title="CopyHover image" /><div id="header"><table id="topTable" cellspacing="0" cellpadding="0"><tr><td><span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage, event)" tabindex="0"><img ID="toggleAllImage" class="toggleAll" src="../icons/collapse_all.gif" /> <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">Collapse All</label><label id="expandAllLabel" for="toggleAllImage" style="display: none;">Expand All</label> </span><span>    </span><span id="devlangsDropdown" class="filter" tabindex="0"><img id="devlangsDropdownImage" src="../icons/dropdown.gif" /> <label id="devlangsMenuAllLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: All </nobr></label><label id="devlangsMenuMultipleLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Multiple </nobr></label><label id="devlangsMenuCSharpLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: C# </nobr></label><label id="devlangsMenuVisualBasicLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Visual Basic </nobr></label><label id="devlangsMenuManagedCPlusPlusLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Visual C++ </nobr></label></span></td></tr></table><div id="devlangsMenu"><input id="CSharpCheckbox" type="checkbox" data="CSharp,cs,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="CSharpCheckbox">C#</label><br /><input id="VisualBasicCheckbox" type="checkbox" data="VisualBasic,vb,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="VisualBasicCheckbox">Visual Basic</label><br /><input id="ManagedCPlusPlusCheckbox" type="checkbox" data="ManagedCPlusPlus,cpp,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="ManagedCPlusPlusCheckbox">Visual C++</label><br /></div><table id="bottomTable" cellpadding="0" cellspacing="0"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText">Revit 2023 API</span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">SunAndShadowSettings Class</span></td></tr><tr id="headerTableRow3"><td align="left"><a href="53022ab0-6e4a-2e4e-1ed8-5eb896ab4091.htm">Members</a> <a href="#exampleToggle" onclick="OpenSection(exampleToggle)">Example</a> <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> <span id="headfeedbackarea" class="feedbackhead"><a href="javascript:SubmitFeedback('revitapifeedback@autodesk.com','Revit 2023 API','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback');">Send Feedback</a></span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()" /><span style="color: DarkGray"></span><div class="summary">
   The SunAndShadowSettings class represents the sun control.
</div><p /><b>Namespace:</b> <a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB</a><br /><b>Assembly:</b> <span sdata="assembly">RevitAPI</span> (in RevitAPI.dll) Version: 23.0.0.0 (23.1.0.0)<br /><b>Since:</b> 
   2011
<h1 class="heading"><span onclick="ExpandCollapse(syntaxToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(syntaxToggle, event)" tabindex="0"><img id="syntaxToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Syntax</span></h1><div id="syntaxSection" class="section" name="collapseableSection" style=""><div id="syntaxCodeBlocks" class="code"><span codeLanguage="CSharp"><table><tr><th>C#</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">class</span> <span class="identifier">SunAndShadowSettings</span> : <a href="eb16114f-69ea-f4de-0d0d-f7388b105a16.htm">Element</a></pre></td></tr></table></span><span codeLanguage="VisualBasicDeclaration"><table><tr><th>Visual Basic</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Class</span> <span class="identifier">SunAndShadowSettings</span> _
	<span class="keyword">Inherits</span> <a href="eb16114f-69ea-f4de-0d0d-f7388b105a16.htm">Element</a></pre></td></tr></table></span><span codeLanguage="ManagedCPlusPlus"><table><tr><th>Visual C++</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">ref class</span> <span class="identifier">SunAndShadowSettings</span> : <span class="keyword">public</span> <a href="eb16114f-69ea-f4de-0d0d-f7388b105a16.htm">Element</a></pre></td></tr></table></span></div></div><h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle, event)" tabindex="0"><img id="remarksToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style="">
   The SunAndShadowSettings element represents the settings applied to a project or view regarding
   the position, dates, time intervals and other options for the sun control and solar studies.
   To differentiate between the project and view settings, test the ViewSpecific or OwnerViewId property.
   If the element is not view-specific this element represents a project-wide setting.
   If the element is associated to a view, this element represents a per view SunAndShadowSettings.
   When you create a new view, a new view-specific SunAndShadowSettings element is automatically created
   for it.
</div><h1 class="heading"><span onclick="ExpandCollapse(exampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exampleToggle, event)" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Examples</span></h1><div id="exampleSection" class="section" name="collapseableSection" style=""><span id="cbc_1" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/CopyCode.gif" />Copy</span>C#</div><div class="code"><pre xml:space="preserve">SunAndShadowSettings sunSettings = view.SunAndShadowSettings; <span class="highlight-comment">// get current settings from view</span>

<span class="highlight-comment">// modify Sun and Shadow Settings</span>
DateTime sunrise = sunSettings.GetSunrise(DateTime.SpecifyKind(<span class="highlight-keyword">new</span> DateTime(<span class="highlight-number">2011</span>, <span class="highlight-number">4</span>, <span class="highlight-number">20</span>), DateTimeKind.Local)); <span class="highlight-comment">// sunrise on April 20, 2011</span>
DateTime sunset = sunSettings.GetSunset(DateTime.SpecifyKind(<span class="highlight-keyword">new</span> DateTime(<span class="highlight-number">2011</span>, <span class="highlight-number">4</span>, <span class="highlight-number">22</span>), DateTimeKind.Local)); <span class="highlight-comment">// sunset on April 22, 2011</span>
sunSettings.SunAndShadowType = SunAndShadowType.MultiDayStudy;
sunSettings.StartDateAndTime = sunrise.AddHours(<span class="highlight-number">2</span>); <span class="highlight-comment">// start 2 hours after sunrise on April 20, 2011</span>
sunSettings.EndDateAndTime = sunset.AddHours(<span class="highlight-number">-2</span>); <span class="highlight-comment">// end 2 hours before sunset on April 22, 2011</span>
<span class="highlight-keyword">if</span> (sunSettings.IsTimeIntervalValid(SunStudyTimeInterval.Hour)) <span class="highlight-comment">// check that this interval is valid for this SunAndShadowType</span>
    sunSettings.TimeInterval = SunStudyTimeInterval.Hour;

<span class="highlight-comment">// check for validity of start and end times</span>
<span class="highlight-keyword">if</span> (!(sunSettings.IsAfterStartDateAndTime(sunSettings.EndDateAndTime)
    &amp;&amp; sunSettings.IsBeforeEndDateAndTime(sunSettings.StartDateAndTime)))
    TaskDialog.Show(<span class="highlight-literal">"Error"</span>, <span class="highlight-literal">"Start and End dates are invalid"</span>);

view.get_Parameter(BuiltInParameter.VIEW_GRAPH_SUN_PATH).Set(<span class="highlight-number">1</span>); <span class="highlight-comment">// turn on display of the sun path</span></pre></div></span><span id="cbc_2" x-lang="VisualBasic" codeLanguage="VisualBasic"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/CopyCode.gif" />Copy</span>VB.NET</div><div class="code"><pre xml:space="preserve"><span class="highlight-keyword">Dim</span> sunSettings__1 <span class="highlight-keyword">As</span> SunAndShadowSettings = view.SunAndShadowSettings
<span class="highlight-comment">' get current settings from view</span>
<span class="highlight-comment">' modify Sun and Shadow Settings</span>
<span class="highlight-keyword">Dim</span> sunrise <span class="highlight-keyword">As</span> DateTime = sunSettings__1.GetSunrise(DateTime.SpecifyKind(<span class="highlight-keyword">New</span> DateTime(<span class="highlight-number">2011</span>, <span class="highlight-number">4</span>, <span class="highlight-number">20</span>), DateTimeKind.Local))
<span class="highlight-comment">' sunrise on April 20, 2011</span>
<span class="highlight-keyword">Dim</span> sunset <span class="highlight-keyword">As</span> DateTime = sunSettings__1.GetSunset(DateTime.SpecifyKind(<span class="highlight-keyword">New</span> DateTime(<span class="highlight-number">2011</span>, <span class="highlight-number">4</span>, <span class="highlight-number">22</span>), DateTimeKind.Local))
<span class="highlight-comment">' sunset on April 22, 2011</span>
sunSettings__1.SunAndShadowType = SunAndShadowType.MultiDayStudy
sunSettings__1.StartDateAndTime = sunrise.AddHours(<span class="highlight-number">2</span>)
<span class="highlight-comment">' start 2 hours after sunrise on April 20, 2011</span>
sunSettings__1.EndDateAndTime = sunset.AddHours(<span class="highlight-number">-2</span>)
<span class="highlight-comment">' end 2 hours before sunset on April 22, 2011</span>
<span class="highlight-keyword">If</span> sunSettings__1.IsTimeIntervalValid(SunStudyTimeInterval.Hour) <span class="highlight-keyword">Then</span>
    <span class="highlight-comment">' check that this interval is valid for this SunAndShadowType</span>
    sunSettings__1.TimeInterval = SunStudyTimeInterval.Hour
<span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>

<span class="highlight-comment">' check for validity of start and end times</span>
<span class="highlight-keyword">If</span> <span class="highlight-keyword">Not</span> (sunSettings__1.IsAfterStartDateAndTime(sunSettings__1.EndDateAndTime) <span class="highlight-keyword">AndAlso</span> sunSettings__1.IsBeforeEndDateAndTime(sunSettings__1.StartDateAndTime)) <span class="highlight-keyword">Then</span>
    TaskDialog.Show(<span class="highlight-literal">"Error"</span>, <span class="highlight-literal">"Start and End dates are invalid"</span>)
<span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>

view.Parameter(BuiltInParameter.VIEW_GRAPH_SUN_PATH).[<span class="highlight-keyword">Set</span>](<span class="highlight-number">1</span>)
<span class="highlight-comment">' turn on display of the sun path</span></pre></div></span></div><h1 class="heading"><span onclick="ExpandCollapse(familyToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(familyToggle, event)" tabindex="0"><img id="familyToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Inheritance Hierarchy</span></h1><div id="familySection" class="section" name="collapseableSection" style=""><span class="nolink">System<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>Object</span><br />  <a href="eb16114f-69ea-f4de-0d0d-f7388b105a16.htm">Autodesk.Revit.DB<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>Element</a><br />    <span class="selflink">Autodesk.Revit.DB<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>SunAndShadowSettings</span><br /></div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle, event)" tabindex="0"><img id="seeAlsoToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><a href="53022ab0-6e4a-2e4e-1ed8-5eb896ab4091.htm">SunAndShadowSettings Members</a></div><div class="seeAlsoStyle"><a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB Namespace</a></div></div></div><div id="footer"><div class="footerLine"><img width="100%" height="3px" src="../icons/footer.gif" alt="Footer image" title="Footer image" /></div><A NAME="feedback"></A><span id="fb" class="feedbackcss"></span><p />Send comments on this topic to
        <a id="HT_MailLink" href="mailto:revitapifeedback%40autodesk.com?Subject=Revit 2023 API">Autodesk</a><script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title;
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div></div></body></html>