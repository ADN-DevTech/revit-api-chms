<html xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>TransmissionData Class</title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="TransmissionData class" /><meta name="System.Keywords" content="Autodesk.Revit.DB.TransmissionData class" /><meta name="System.Keywords" content="TransmissionData class, about TransmissionData class" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.DB.TransmissionData" /><meta name="Microsoft.Help.Id" content="T:Autodesk.Revit.DB.TransmissionData" /><meta name="Description" content="A class representing information on all external file references in a document." /><meta name="Microsoft.Help.ContentType" content="Reference" /><link rel="stylesheet" type="text/css" href="../styles/Presentation.css" /><link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLink.css" /><script type="text/javascript" src="../scripts/EventUtilities.js"> </script><script type="text/javascript" src="../scripts/SplitScreen.js"> </script><script type="text/javascript" src="../scripts/Dropdown.js"> </script><script type="text/javascript" src="../scripts/script_manifold.js"> </script><script type="text/javascript" src="../scripts/script_feedBack.js"> </script><script type="text/javascript" src="../scripts/CheckboxMenu.js"> </script><script type="text/javascript" src="../scripts/CommonUtilities.js"> </script><meta name="container" content="Autodesk.Revit.DB" /><meta name="file" content="d78d1e9c-1cee-1336-88d5-b605dacd077d" /><meta name="guid" content="d78d1e9c-1cee-1336-88d5-b605dacd077d" /><xml><MSHelp:Attr Name="AssetID" Value="T:Autodesk.Revit.DB.TransmissionData" /><MSHelp:TOCTitle Title="TransmissionData Class" /><MSHelp:RLTitle Title="TransmissionData Class (Autodesk.Revit.DB)" /><MSHelp:Keyword Index="A" Term="T:Autodesk.Revit.DB.TransmissionData" /><MSHelp:Keyword Index="A" Term="frlrfAutodeskRevitDBTransmissionDataClassTopic" /><MSHelp:Keyword Index="K" Term="TransmissionData class" /><MSHelp:Keyword Index="K" Term="Autodesk.Revit.DB.TransmissionData class" /><MSHelp:Keyword Index="K" Term="TransmissionData class, about TransmissionData class" /><MSHelp:Keyword Index="F" Term="Autodesk.Revit.DB.TransmissionData" /><MSHelp:Attr Name="HelpPriority" Value="2" /><MSHelp:Attr Name="APIType" Value="Managed" /><MSHelp:Attr Name="APILocation" Value="RevitAPI.dll" /><MSHelp:Attr Name="APIName" Value="Autodesk.Revit.DB.TransmissionData" /><MSHelp:Attr Name="DevLang" Value="CSharp" /><MSHelp:Attr Name="DevLang" Value="VB" /><MSHelp:Attr Name="Locale" Value="en-us" /><MSHelp:Attr Name="TopicType" Value="kbSyntax" /><MSHelp:Attr Name="TopicType" Value="apiref" /><MSHelp:Attr Name="Abstract" Value="A class representing information on all external file references in a document." /><MSHelp:Attr Name="AssemblyVersion" Value="23.0.0.0" /></xml><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script></head><body><input type="hidden" id="userDataCache" class="userDataStyle" /><input type="hidden" id="hiddenScrollOffset" /><img id="collapseImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" alt="Collapse image" title="Collapse image" /><img id="expandImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" alt="Expand Image" title="Expand Image" /><img id="collapseAllImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" /><img id="expandAllImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" /><img id="dropDownImage" style="display:none; height:0; width:0;" src="../icons/dropdown.gif" /><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../icons/dropdownHover.gif" /><img id="copyImage" style="display:none; height:0; width:0;" src="../icons/copycode.gif" alt="Copy image" title="Copy image" /><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../icons/copycodeHighlight.gif" alt="CopyHover image" title="CopyHover image" /><div id="header"><table id="topTable" cellspacing="0" cellpadding="0"><tr><td><span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage, event)" tabindex="0"><img ID="toggleAllImage" class="toggleAll" src="../icons/collapse_all.gif" /> <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">Collapse All</label><label id="expandAllLabel" for="toggleAllImage" style="display: none;">Expand All</label> </span><span>    </span><span id="devlangsDropdown" class="filter" tabindex="0"><img id="devlangsDropdownImage" src="../icons/dropdown.gif" /> <label id="devlangsMenuAllLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: All </nobr></label><label id="devlangsMenuMultipleLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Multiple </nobr></label><label id="devlangsMenuCSharpLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: C# </nobr></label><label id="devlangsMenuVisualBasicLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Visual Basic </nobr></label><label id="devlangsMenuManagedCPlusPlusLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Visual C++ </nobr></label></span></td></tr></table><div id="devlangsMenu"><input id="CSharpCheckbox" type="checkbox" data="CSharp,cs,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="CSharpCheckbox">C#</label><br /><input id="VisualBasicCheckbox" type="checkbox" data="VisualBasic,vb,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="VisualBasicCheckbox">Visual Basic</label><br /><input id="ManagedCPlusPlusCheckbox" type="checkbox" data="ManagedCPlusPlus,cpp,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="ManagedCPlusPlusCheckbox">Visual C++</label><br /></div><table id="bottomTable" cellpadding="0" cellspacing="0"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText">Revit 2023 API</span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">TransmissionData Class</span></td></tr><tr id="headerTableRow3"><td align="left"><a href="31999f17-cdb5-a95f-483a-de53658970a7.htm">Members</a> <a href="#exampleToggle" onclick="OpenSection(exampleToggle)">Example</a> <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> <span id="headfeedbackarea" class="feedbackhead"><a href="javascript:SubmitFeedback('revitapifeedback@autodesk.com','Revit 2023 API','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback');">Send Feedback</a></span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()" /><span style="color: DarkGray"></span><div class="summary">
   A class representing information on all external file references
   in a document.
</div><p /><b>Namespace:</b> <a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB</a><br /><b>Assembly:</b> <span sdata="assembly">RevitAPI</span> (in RevitAPI.dll) Version: 23.0.0.0 (23.1.0.0)<br /><b>Since:</b> 
   2012
<h1 class="heading"><span onclick="ExpandCollapse(syntaxToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(syntaxToggle, event)" tabindex="0"><img id="syntaxToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Syntax</span></h1><div id="syntaxSection" class="section" name="collapseableSection" style=""><div id="syntaxCodeBlocks" class="code"><span codeLanguage="CSharp"><table><tr><th>C#</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">class</span> <span class="identifier">TransmissionData</span> : <span class="nolink">IDisposable</span></pre></td></tr></table></span><span codeLanguage="VisualBasicDeclaration"><table><tr><th>Visual Basic</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Class</span> <span class="identifier">TransmissionData</span> _
	<span class="keyword">Implements</span> <span class="nolink">IDisposable</span></pre></td></tr></table></span><span codeLanguage="ManagedCPlusPlus"><table><tr><th>Visual C++</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">ref class</span> <span class="identifier">TransmissionData</span> : <span class="nolink">IDisposable</span></pre></td></tr></table></span></div></div><h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle, event)" tabindex="0"><img id="remarksToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style=""><p>TransmissionData stores information on both the previous state
   and requested state of an external file reference.
   This means that it stores the load state and path of the reference
   from the most recent time this TransmissionData's document was opened.
   It also stores load state and path information for what Revit should
   do the next time the document is opened. </p><p>As such, TransmissionData can be used to perform operations on external
   file references without having to open the entire associated Revit
   document. The methods ReadTransmissionData and WriteTransmissionData
   can be used to obtain information about external references, or to
   change that information. For example, calling WriteTransmissionData
   with a TransmissionData object which has had all references set to
   LinkedFileStatus.Unloaded would cause no references to be loaded
   upon next opening the document.</p><p>TransmissionData cannot add or remove references to
   external files. If, on file open, Revit discovers information
   in the TransmissionData which does not correspond to an
   existing external file reference,
   the information will be ignored on file load.</p><p>The TransmissionData for a document does not contain information
   about references which come from external servers. TransmissionData only
   contains references to local files or Revit links on Revit Server.
   TransmissionData cannot
   be used to change a reference from a local file reference to an external
   server reference.</p><p>Note that TransmissionData objects must be set to "transmitted" for
   the requested reference data to be meaningful. Revit ignores the
   TransmissionData for non-transmitted files. Marking a file as
   transmitted has other effects - workshared files are opened as
   detached from the central model, and creation of new local files
   is prohibited, until the file is in its final location and the
   file has been marked as no longer transmitted. </p></div><h1 class="heading"><span onclick="ExpandCollapse(exampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exampleToggle, event)" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Examples</span></h1><div id="exampleSection" class="section" name="collapseableSection" style=""><span id="cbc_1" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/CopyCode.gif" />Copy</span>C#</div><div class="code"><pre xml:space="preserve"><span class="highlight-keyword">void</span> UnloadRevitLinks(ModelPath location)
<span class="highlight-comment">///  This method will set all Revit links to be unloaded the next time the document at the given location is opened. </span>
<span class="highlight-comment">///  The TransmissionData for a given document only contains top-level Revit links, not nested links.</span>
<span class="highlight-comment">///  However, nested links will be unloaded if their parent links are unloaded, so this function only needs to look at the document's immediate links. </span>
{
   <span class="highlight-comment">// access transmission data in the given Revit file</span>
   TransmissionData transData = TransmissionData.ReadTransmissionData(location);

   <span class="highlight-keyword">if</span> (transData != <span class="highlight-keyword">null</span>)
   {
      <span class="highlight-comment">// collect all (immediate) external references in the model</span>
      ICollection&lt;ElementId&gt; externalReferences = transData.GetAllExternalFileReferenceIds();

      <span class="highlight-comment">// find every reference that is a link</span>
      <span class="highlight-keyword">foreach</span> (ElementId refId <span class="highlight-keyword">in</span> externalReferences)
      {
         ExternalFileReference extRef = transData.GetLastSavedReferenceData(refId);

         <span class="highlight-keyword">if</span> (extRef.ExternalFileReferenceType == ExternalFileReferenceType.RevitLink)
         {
            <span class="highlight-comment">// we do not want to change neither the path nor the path-type</span>
            <span class="highlight-comment">// we only want the links to be unloaded (shouldLoad = false)</span>
            transData.SetDesiredReferenceData(refId, extRef.GetPath(), extRef.PathType, <span class="highlight-keyword">false</span>);
         }
      }

      <span class="highlight-comment">// make sure the IsTransmitted property is set </span>
      transData.IsTransmitted = <span class="highlight-keyword">true</span>;

      <span class="highlight-comment">// modified transmission data must be saved back to the model</span>
      TransmissionData.WriteTransmissionData(location, transData);
   }
   <span class="highlight-keyword">else</span>
   {
      Autodesk.Revit.UI.TaskDialog.Show(<span class="highlight-literal">"Unload Links"</span>, <span class="highlight-literal">"The document does not have any transmission data"</span>);
   }
}</pre></div></span><span id="cbc_2" x-lang="VisualBasic" codeLanguage="VisualBasic"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/CopyCode.gif" />Copy</span>VB.NET</div><div class="code"><pre xml:space="preserve"><span class="highlight-keyword">Private</span> <span class="highlight-keyword">Sub</span> UnloadRevitLinks(location <span class="highlight-keyword">As</span> ModelPath)
    <span class="highlight-comment">'  This method will set all Revit links to be unloaded the next time the document at the given location is opened. </span>
    <span class="highlight-comment">'  The TransmissionData for a given document only contains top-level Revit links, not nested links.</span>
    <span class="highlight-comment">'  However, nested links will be unloaded if their parent links are unloaded, so this function only needs to look at the document's immediate links. </span>
    <span class="highlight-comment">' access transmission data in the given Revit file</span>
    <span class="highlight-keyword">Dim</span> transData <span class="highlight-keyword">As</span> TransmissionData = TransmissionData.ReadTransmissionData(location)

    <span class="highlight-keyword">If</span> transData <span class="highlight-keyword">IsNot</span> <span class="highlight-keyword">Nothing</span> <span class="highlight-keyword">Then</span>
        <span class="highlight-comment">' collect all (immediate) external references in the model</span>
        <span class="highlight-keyword">Dim</span> externalReferences <span class="highlight-keyword">As</span> ICollection(<span class="highlight-keyword">Of</span> ElementId) = transData.GetAllExternalFileReferenceIds()

        <span class="highlight-comment">' find every reference that is a link</span>
        <span class="highlight-keyword">For</span> <span class="highlight-keyword">Each</span> refId <span class="highlight-keyword">As</span> ElementId <span class="highlight-keyword">In</span> externalReferences
            <span class="highlight-keyword">Dim</span> extRef <span class="highlight-keyword">As</span> ExternalFileReference = transData.GetLastSavedReferenceData(refId)

            <span class="highlight-keyword">If</span> extRef.ExternalFileReferenceType = ExternalFileReferenceType.RevitLink <span class="highlight-keyword">Then</span>
                <span class="highlight-comment">' we do not want to change neither the path nor the path-type</span>
                <span class="highlight-comment">' we only want the links to be unloaded (shouldLoad = false)</span>
                transData.SetDesiredReferenceData(refId, extRef.GetPath(), extRef.PathType, <span class="highlight-keyword">False</span>)
            <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
        <span class="highlight-keyword">Next</span>

        <span class="highlight-comment">' make sure the IsTransmitted property is set </span>
        transData.IsTransmitted = <span class="highlight-keyword">True</span>

        <span class="highlight-comment">' modified transmission data must be saved back to the model</span>
        TransmissionData.WriteTransmissionData(location, transData)
    <span class="highlight-keyword">Else</span>
        Autodesk.Revit.UI.TaskDialog.Show(<span class="highlight-literal">"Unload Links"</span>, <span class="highlight-literal">"The document does not have any transmission data"</span>)
    <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Sub</span></pre></div></span></div><h1 class="heading"><span onclick="ExpandCollapse(familyToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(familyToggle, event)" tabindex="0"><img id="familyToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Inheritance Hierarchy</span></h1><div id="familySection" class="section" name="collapseableSection" style=""><span class="nolink">System<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>Object</span><br />  <span class="selflink">Autodesk.Revit.DB<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>TransmissionData</span><br /></div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle, event)" tabindex="0"><img id="seeAlsoToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><a href="31999f17-cdb5-a95f-483a-de53658970a7.htm">TransmissionData Members</a></div><div class="seeAlsoStyle"><a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB Namespace</a></div></div></div><div id="footer"><div class="footerLine"><img width="100%" height="3px" src="../icons/footer.gif" alt="Footer image" title="Footer image" /></div><A NAME="feedback"></A><span id="fb" class="feedbackcss"></span><p />Send comments on this topic to
        <a id="HT_MailLink" href="mailto:revitapifeedback%40autodesk.com?Subject=Revit 2023 API">Autodesk</a><script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title;
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div></div></body></html>