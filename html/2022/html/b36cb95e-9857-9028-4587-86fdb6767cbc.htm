<html xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>RequestSystemsAnalysis Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="RequestSystemsAnalysis method" /><meta name="System.Keywords" content="ViewSystemsAnalysisReport.RequestSystemsAnalysis method" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.DB.Analysis.ViewSystemsAnalysisReport.RequestSystemsAnalysis" /><meta name="Microsoft.Help.Id" content="M:Autodesk.Revit.DB.Analysis.ViewSystemsAnalysisReport.RequestSystemsAnalysis(Autodesk.Revit.DB.Analysis.SystemsAnalysisOptions)" /><meta name="Description" content="Requests a new systems analysis in the background." /><meta name="Microsoft.Help.ContentType" content="Reference" /><link rel="stylesheet" type="text/css" href="../styles/Presentation.css" /><link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLink.css" /><script type="text/javascript" src="../scripts/EventUtilities.js"> </script><script type="text/javascript" src="../scripts/SplitScreen.js"> </script><script type="text/javascript" src="../scripts/Dropdown.js"> </script><script type="text/javascript" src="../scripts/script_manifold.js"> </script><script type="text/javascript" src="../scripts/script_feedBack.js"> </script><script type="text/javascript" src="../scripts/CheckboxMenu.js"> </script><script type="text/javascript" src="../scripts/CommonUtilities.js"> </script><meta name="container" content="Autodesk.Revit.DB.Analysis" /><meta name="file" content="b36cb95e-9857-9028-4587-86fdb6767cbc" /><meta name="guid" content="b36cb95e-9857-9028-4587-86fdb6767cbc" /><xml><MSHelp:Attr Name="AssetID" Value="M:Autodesk.Revit.DB.Analysis.ViewSystemsAnalysisReport.RequestSystemsAnalysis(Autodesk.Revit.DB.Analysis.SystemsAnalysisOptions)" /><MSHelp:TOCTitle Title="RequestSystemsAnalysis Method " /><MSHelp:RLTitle Title="ViewSystemsAnalysisReport.RequestSystemsAnalysis Method  (Autodesk.Revit.DB.Analysis)" /><MSHelp:Keyword Index="A" Term="M:Autodesk.Revit.DB.Analysis.ViewSystemsAnalysisReport.RequestSystemsAnalysis(Autodesk.Revit.DB.Analysis.SystemsAnalysisOptions)" /><MSHelp:Keyword Index="A" Term="frlrfAutodeskRevitDBAnalysisViewSystemsAnalysisReportClassRequestSystemsAnalysisTopic" /><MSHelp:Keyword Index="K" Term="RequestSystemsAnalysis method" /><MSHelp:Keyword Index="K" Term="ViewSystemsAnalysisReport.RequestSystemsAnalysis method" /><MSHelp:Keyword Index="F" Term="Autodesk.Revit.DB.Analysis.ViewSystemsAnalysisReport.RequestSystemsAnalysis" /><MSHelp:Attr Name="APIType" Value="Managed" /><MSHelp:Attr Name="APILocation" Value="RevitAPI.dll" /><MSHelp:Attr Name="APIName" Value="Autodesk.Revit.DB.Analysis.ViewSystemsAnalysisReport.RequestSystemsAnalysis" /><MSHelp:Attr Name="DevLang" Value="CSharp" /><MSHelp:Attr Name="DevLang" Value="VB" /><MSHelp:Attr Name="Locale" Value="en-us" /><MSHelp:Attr Name="TopicType" Value="kbSyntax" /><MSHelp:Attr Name="TopicType" Value="apiref" /><MSHelp:Attr Name="Abstract" Value="Requests a new systems analysis in the background." /><MSHelp:Attr Name="AssemblyVersion" Value="22.0.0.0" /></xml><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script></head><body><input type="hidden" id="userDataCache" class="userDataStyle" /><input type="hidden" id="hiddenScrollOffset" /><img id="collapseImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" alt="Collapse image" title="Collapse image" /><img id="expandImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" alt="Expand Image" title="Expand Image" /><img id="collapseAllImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" /><img id="expandAllImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" /><img id="dropDownImage" style="display:none; height:0; width:0;" src="../icons/dropdown.gif" /><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../icons/dropdownHover.gif" /><img id="copyImage" style="display:none; height:0; width:0;" src="../icons/copycode.gif" alt="Copy image" title="Copy image" /><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../icons/copycodeHighlight.gif" alt="CopyHover image" title="CopyHover image" /><div id="header"><table id="topTable" cellspacing="0" cellpadding="0"><tr><td><span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage, event)" tabindex="0"><img ID="toggleAllImage" class="toggleAll" src="../icons/collapse_all.gif" /> <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">Collapse All</label><label id="expandAllLabel" for="toggleAllImage" style="display: none;">Expand All</label> </span><span>    </span><span id="devlangsDropdown" class="filter" tabindex="0"><img id="devlangsDropdownImage" src="../icons/dropdown.gif" /> <label id="devlangsMenuAllLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: All </nobr></label><label id="devlangsMenuMultipleLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Multiple </nobr></label><label id="devlangsMenuCSharpLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: C# </nobr></label><label id="devlangsMenuVisualBasicLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Visual Basic </nobr></label><label id="devlangsMenuManagedCPlusPlusLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Visual C++ </nobr></label></span></td></tr></table><div id="devlangsMenu"><input id="CSharpCheckbox" type="checkbox" data="CSharp,cs,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="CSharpCheckbox">C#</label><br /><input id="VisualBasicCheckbox" type="checkbox" data="VisualBasic,vb,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="VisualBasicCheckbox">Visual Basic</label><br /><input id="ManagedCPlusPlusCheckbox" type="checkbox" data="ManagedCPlusPlus,cpp,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="ManagedCPlusPlusCheckbox">Visual C++</label><br /></div><table id="bottomTable" cellpadding="0" cellspacing="0"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText">Revit 2022 API</span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">ViewSystemsAnalysisReport<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>RequestSystemsAnalysis Method </span></td></tr><tr id="headerTableRow3"><td align="left"><a href="a7b5b7de-dfdb-e57f-7fac-1ff1dbf35e4d.htm">ViewSystemsAnalysisReport Class</a> <a href="#exampleToggle" onclick="OpenSection(exampleToggle)">Example</a> <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> <span id="headfeedbackarea" class="feedbackhead"><a href="javascript:SubmitFeedback('revitapifeedback@autodesk.com','Revit 2022 API','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback');">Send Feedback</a></span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()" /><span style="color: DarkGray"></span><div class="summary">
   Requests a new systems analysis in the background.
</div><p /><b>Namespace:</b> <a href="958e2e12-587d-f188-5d7b-f13d7dbfdf48.htm">Autodesk.Revit.DB.Analysis</a><br /><b>Assembly:</b> <span sdata="assembly">RevitAPI</span> (in RevitAPI.dll) Version: 22.0.0.0 (22.1.0.0)<br /><b>Since:</b> 
   2020.1
<h1 class="heading"><span onclick="ExpandCollapse(syntaxToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(syntaxToggle, event)" tabindex="0"><img id="syntaxToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Syntax</span></h1><div id="syntaxSection" class="section" name="collapseableSection" style=""><div id="syntaxCodeBlocks" class="code"><span codeLanguage="CSharp"><table><tr><th>C#</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">void</span> <span class="identifier">RequestSystemsAnalysis</span>(
	<a href="8d8fe6a8-d3f6-c4fd-99ac-3181ba0253d6.htm">SystemsAnalysisOptions</a> <span class="parameter">options</span>
)</pre></td></tr></table></span><span codeLanguage="VisualBasicDeclaration"><table><tr><th>Visual Basic</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Sub</span> <span class="identifier">RequestSystemsAnalysis</span> ( _
	<span class="parameter">options</span> <span class="keyword">As</span> <a href="8d8fe6a8-d3f6-c4fd-99ac-3181ba0253d6.htm">SystemsAnalysisOptions</a> _
)</pre></td></tr></table></span><span codeLanguage="ManagedCPlusPlus"><table><tr><th>Visual C++</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="keyword">void</span> <span class="identifier">RequestSystemsAnalysis</span>(
	<a href="8d8fe6a8-d3f6-c4fd-99ac-3181ba0253d6.htm">SystemsAnalysisOptions</a>^ <span class="parameter">options</span>
)</pre></td></tr></table></span></div><div id="parameters"><h4 class="subHeading">Parameters</h4><dl paramName="options"><dt><span class="parameter">options</span></dt><dd>Type: <a href="8d8fe6a8-d3f6-c4fd-99ac-3181ba0253d6.htm">Autodesk.Revit.DB.Analysis<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>SystemsAnalysisOptions</a><br />
   The additional options to run systems analysis. If empty, use the default value in the view element.
   The request may download the weather file at current site location if not specified in the options.
</dd></dl></div></div><h1 class="heading"><span onclick="ExpandCollapse(exampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exampleToggle, event)" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Examples</span></h1><div id="exampleSection" class="section" name="collapseableSection" style=""><span id="cbc_1" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/CopyCode.gif" />Copy</span>C#</div><div class="code"><pre xml:space="preserve"><span class="highlight-comment">// Create a new report and request systems analysis on the current energy model.</span>
ViewSystemsAnalysisReport newReport = <span class="highlight-keyword">null</span>;

SystemsAnalysisOptions theOptions = <span class="highlight-keyword">new</span> SystemsAnalysisOptions();
<span class="highlight-keyword">string</span> openStudioPath = Path.GetFullPath(Path.Combine(doc.Application.SystemsAnalysisWorkfilesRootPath, <span class="highlight-literal">@"..\"</span>));
<span class="highlight-comment">// The following are the default values for systems analysis if not specified.</span>
<span class="highlight-comment">// If the weather file is not specified, the analysis will use the weather at the current site location.</span>
theOptions.WorkflowFile = Path.Combine(openStudioPath, <span class="highlight-literal">@"workflows\HVAC Systems Loads and Sizing.osw"</span>);
theOptions.OutputFolder = Path.GetTempPath();
<span class="highlight-keyword">using</span> (Transaction transaction = <span class="highlight-keyword">new</span> Transaction(doc))
{
   transaction.Start(<span class="highlight-literal">"Create Systems Analysis View"</span>);

   newReport = ViewSystemsAnalysisReport.Create(doc, <span class="highlight-literal">"APITestView"</span>);
   <span class="highlight-comment">// Create a new report of systems analysis. </span>
   <span class="highlight-keyword">if</span> (newReport != <span class="highlight-keyword">null</span>)
   {
      newReport.RequestSystemsAnalysis(theOptions);
      <span class="highlight-comment">// Request the systems analysis in the background process. When the systems analysis is completed, </span>
      <span class="highlight-comment">// the result is automatically updated in the report view and the analytical space elements.</span>
      <span class="highlight-comment">// You may check the status by calling newReport.IsAnalysisCompleted().</span>
      transaction.Commit();
   }
   <span class="highlight-keyword">else</span>
   {
      transaction.RollBack();
   }
}</pre></div></span><span id="cbc_2" x-lang="VisualBasic" codeLanguage="VisualBasic"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/CopyCode.gif" />Copy</span>VB.NET</div><div class="code"><pre xml:space="preserve"><span class="highlight-comment">' Create a New report And request systems analysis on the current energy model.</span>
<span class="highlight-keyword">Dim</span> newReport <span class="highlight-keyword">As</span> ViewSystemsAnalysisReport = <span class="highlight-keyword">Nothing</span>

<span class="highlight-keyword">Dim</span> theOptions <span class="highlight-keyword">As</span> SystemsAnalysisOptions = <span class="highlight-keyword">New</span> SystemsAnalysisOptions()
<span class="highlight-keyword">Dim</span> openStudioPath <span class="highlight-keyword">As</span> <span class="highlight-keyword">String</span> = Path.GetFullPath(Path.Combine(doc.Application.SystemsAnalysisWorkfilesRootPath, <span class="highlight-literal">"..\"</span>))
<span class="highlight-comment">' The following are the default values for systems analysis if not specified.</span>
<span class="highlight-comment">' If the weather file is not specified, the analysis will use the weather at the current site location.</span>
theOptions.WorkflowFile = Path.Combine(openStudioPath, <span class="highlight-literal">"workflows\HVAC Systems Loads and Sizing.osw"</span>)
theOptions.OutputFolder = Path.GetTempPath()
<span class="highlight-keyword">Using</span> t <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> Transaction(doc, <span class="highlight-literal">"Create Systems Analysis View"</span>)
   t.Start()

   newReport = ViewSystemsAnalysisReport.Create(doc, <span class="highlight-literal">"APITestView"</span>)
   <span class="highlight-comment">' Create a new report of systems analysis. </span>
   <span class="highlight-keyword">If</span> newReport <span class="highlight-keyword">IsNot</span> <span class="highlight-keyword">Nothing</span> <span class="highlight-keyword">Then</span>
      newReport.RequestSystemsAnalysis(theOptions)
      <span class="highlight-comment">' Request the systems analysis in the background process. When the systems analysis Is completed, </span>
      <span class="highlight-comment">' the result Is automatically updated in the report view And the analytical space elements.</span>
      <span class="highlight-comment">' You may check the status by calling newReport.IsAnalysisCompleted().</span>
      t.Commit()
   <span class="highlight-keyword">Else</span>
      t.RollBack()
   <span class="highlight-keyword">End</span> <span class="highlight-keyword">If</span>
<span class="highlight-keyword">End</span> <span class="highlight-keyword">Using</span></pre></div></span></div><h1 class="heading"><span onclick="ExpandCollapse(exceptionsToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exceptionsToggle, event)" tabindex="0"><img id="exceptionsToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Exceptions</span></h1><div id="exceptionsSection" class="section" name="collapseableSection" style=""><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th class="exceptionNameColumn">Exception</th><th class="exceptionConditionColumn">Condition</th></tr><tr><td><a href="631e1424-60f4-929b-4e52-dda9dcd26316.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>ArgumentNullException</a></td><td>
   A non-optional argument was null
</td></tr><tr><td><a href="05972c68-fa6d-3a83-d720-ad84fbc4780f.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>ArgumentsInconsistentException</a></td><td>
   No weather station is within 500 nautical miles of this site location.
</td></tr><tr><td><a href="73250198-dbc6-e760-4297-ec062f00f574.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>FileNotFoundException</a></td><td>
   Fail to download the weather file.
</td></tr><tr><td><a href="9e715f03-3884-e539-4dd6-8d7545733adc.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>InvalidOperationException</a></td><td>
   A valid energy model is required for systems analysis.
   -or-
   Unable to access the weather service. Try again later.
</td></tr></table></div></div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle, event)" tabindex="0"><img id="seeAlsoToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><a href="a7b5b7de-dfdb-e57f-7fac-1ff1dbf35e4d.htm">ViewSystemsAnalysisReport Class</a></div><div class="seeAlsoStyle"><a href="958e2e12-587d-f188-5d7b-f13d7dbfdf48.htm">Autodesk.Revit.DB.Analysis Namespace</a></div></div></div><div id="footer"><div class="footerLine"><img width="100%" height="3px" src="../icons/footer.gif" alt="Footer image" title="Footer image" /></div><A NAME="feedback"></A><span id="fb" class="feedbackcss"></span><p />Send comments on this topic to
        <a id="HT_MailLink" href="mailto:revitapifeedback%40autodesk.com?Subject=Revit 2022 API">Autodesk</a><script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title;
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div></div></body></html>