<html xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>DownloadParameter Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="DownloadParameter method" /><meta name="System.Keywords" content="ParameterUtils.DownloadParameter method" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.DB.ParameterUtils.DownloadParameter" /><meta name="Microsoft.Help.Id" content="M:Autodesk.Revit.DB.ParameterUtils.DownloadParameter(Autodesk.Revit.DB.Document,Autodesk.Revit.DB.ParameterDownloadOptions,Autodesk.Revit.DB.ForgeTypeId)" /><meta name="Description" content="Create a shared parameter element in the given document according to a parameter definition downloaded from the Parameters Service." /><meta name="Microsoft.Help.ContentType" content="Reference" /><link rel="stylesheet" type="text/css" href="../styles/Presentation.css" /><link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLink.css" /><script type="text/javascript" src="../scripts/EventUtilities.js"> </script><script type="text/javascript" src="../scripts/SplitScreen.js"> </script><script type="text/javascript" src="../scripts/Dropdown.js"> </script><script type="text/javascript" src="../scripts/script_manifold.js"> </script><script type="text/javascript" src="../scripts/script_feedBack.js"> </script><script type="text/javascript" src="../scripts/CheckboxMenu.js"> </script><script type="text/javascript" src="../scripts/CommonUtilities.js"> </script><meta name="container" content="Autodesk.Revit.DB" /><meta name="file" content="6449c1fe-90af-e6d4-e852-91f6eeae5c97" /><meta name="guid" content="6449c1fe-90af-e6d4-e852-91f6eeae5c97" /><xml><MSHelp:Attr Name="AssetID" Value="M:Autodesk.Revit.DB.ParameterUtils.DownloadParameter(Autodesk.Revit.DB.Document,Autodesk.Revit.DB.ParameterDownloadOptions,Autodesk.Revit.DB.ForgeTypeId)" /><MSHelp:TOCTitle Title="DownloadParameter Method " /><MSHelp:RLTitle Title="ParameterUtils.DownloadParameter Method  (Autodesk.Revit.DB)" /><MSHelp:Keyword Index="A" Term="M:Autodesk.Revit.DB.ParameterUtils.DownloadParameter(Autodesk.Revit.DB.Document,Autodesk.Revit.DB.ParameterDownloadOptions,Autodesk.Revit.DB.ForgeTypeId)" /><MSHelp:Keyword Index="A" Term="frlrfAutodeskRevitDBParameterUtilsClassDownloadParameterTopic" /><MSHelp:Keyword Index="K" Term="DownloadParameter method" /><MSHelp:Keyword Index="K" Term="ParameterUtils.DownloadParameter method" /><MSHelp:Keyword Index="F" Term="Autodesk.Revit.DB.ParameterUtils.DownloadParameter" /><MSHelp:Attr Name="APIType" Value="Managed" /><MSHelp:Attr Name="APILocation" Value="RevitAPI.dll" /><MSHelp:Attr Name="APIName" Value="Autodesk.Revit.DB.ParameterUtils.DownloadParameter" /><MSHelp:Attr Name="DevLang" Value="CSharp" /><MSHelp:Attr Name="DevLang" Value="VB" /><MSHelp:Attr Name="Locale" Value="en-us" /><MSHelp:Attr Name="TopicType" Value="kbSyntax" /><MSHelp:Attr Name="TopicType" Value="apiref" /><MSHelp:Attr Name="Abstract" Value="Create a shared parameter element in the given document according to a parameter definition downloaded from the Parameters Service." /><MSHelp:Attr Name="AssemblyVersion" Value="24.0.0.0" /></xml></head><body><input type="hidden" id="userDataCache" class="userDataStyle" /><input type="hidden" id="hiddenScrollOffset" /><img id="collapseImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" alt="Collapse image" title="Collapse image" /><img id="expandImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" alt="Expand Image" title="Expand Image" /><img id="collapseAllImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" /><img id="expandAllImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" /><img id="dropDownImage" style="display:none; height:0; width:0;" src="../icons/dropdown.gif" /><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../icons/dropdownHover.gif" /><img id="copyImage" style="display:none; height:0; width:0;" src="../icons/copycode.gif" alt="Copy image" title="Copy image" /><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../icons/copycodeHighlight.gif" alt="CopyHover image" title="CopyHover image" /><div id="header"><table id="topTable" cellspacing="0" cellpadding="0"><tr><td><span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage, event)" tabindex="0"><img ID="toggleAllImage" class="toggleAll" src="../icons/collapse_all.gif" /> <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">Collapse All</label><label id="expandAllLabel" for="toggleAllImage" style="display: none;">Expand All</label> </span><span>    </span><span id="devlangsDropdown" class="filter" tabindex="0"><img id="devlangsDropdownImage" src="../icons/dropdown.gif" /> <label id="devlangsMenuAllLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: All </nobr></label><label id="devlangsMenuMultipleLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Multiple </nobr></label><label id="devlangsMenuCSharpLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: C# </nobr></label><label id="devlangsMenuVisualBasicLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Visual Basic </nobr></label><label id="devlangsMenuManagedCPlusPlusLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Visual C++ </nobr></label></span></td></tr></table><div id="devlangsMenu"><input id="CSharpCheckbox" type="checkbox" data="CSharp,cs,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="CSharpCheckbox">C#</label><br /><input id="VisualBasicCheckbox" type="checkbox" data="VisualBasic,vb,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="VisualBasicCheckbox">Visual Basic</label><br /><input id="ManagedCPlusPlusCheckbox" type="checkbox" data="ManagedCPlusPlus,cpp,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="ManagedCPlusPlusCheckbox">Visual C++</label><br /></div><table id="bottomTable" cellpadding="0" cellspacing="0"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText">Revit 2024 API</span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">ParameterUtils<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>DownloadParameter Method </span></td></tr><tr id="headerTableRow3"><td align="left"><a href="df5da06e-35c6-e32e-53c0-9fd68d3ab142.htm">ParameterUtils Class</a> <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> <span id="headfeedbackarea" class="feedbackhead"><a href="javascript:SubmitFeedback('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback');">Send Feedback</a></span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()" /><span style="color: DarkGray"></span><div class="summary">
   Create a shared parameter element in the given document according to a parameter definition downloaded from the Parameters Service.
</div><p /><b>Namespace:</b> <a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB</a><br /><b>Assembly:</b> <span sdata="assembly">RevitAPI</span> (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)<br /><b>Since:</b> 
   2024
<h1 class="heading"><span onclick="ExpandCollapse(syntaxToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(syntaxToggle, event)" tabindex="0"><img id="syntaxToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Syntax</span></h1><div id="syntaxSection" class="section" name="collapseableSection" style=""><div id="syntaxCodeBlocks" class="code"><span codeLanguage="CSharp"><table><tr><th>C#</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">static</span> <a href="d8a0f2ae-7e10-39bd-e362-3756cbae661b.htm">SharedParameterElement</a> <span class="identifier">DownloadParameter</span>(
	<a href="db03274b-a107-aa32-9034-f3e0df4bb1ec.htm">Document</a> <span class="parameter">document</span>,
	<a href="7359f11b-4102-15f3-597b-51078e1141bc.htm">ParameterDownloadOptions</a> <span class="parameter">options</span>,
	<a href="d9fcf276-9566-de83-2b0b-d89b65ccc8af.htm">ForgeTypeId</a> <span class="parameter">parameterTypeId</span>
)</pre></td></tr></table></span><span codeLanguage="VisualBasicDeclaration"><table><tr><th>Visual Basic</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Shared</span> <span class="keyword">Function</span> <span class="identifier">DownloadParameter</span> ( _
	<span class="parameter">document</span> <span class="keyword">As</span> <a href="db03274b-a107-aa32-9034-f3e0df4bb1ec.htm">Document</a>, _
	<span class="parameter">options</span> <span class="keyword">As</span> <a href="7359f11b-4102-15f3-597b-51078e1141bc.htm">ParameterDownloadOptions</a>, _
	<span class="parameter">parameterTypeId</span> <span class="keyword">As</span> <a href="d9fcf276-9566-de83-2b0b-d89b65ccc8af.htm">ForgeTypeId</a> _
) <span class="keyword">As</span> <a href="d8a0f2ae-7e10-39bd-e362-3756cbae661b.htm">SharedParameterElement</a></pre></td></tr></table></span><span codeLanguage="ManagedCPlusPlus"><table><tr><th>Visual C++</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="keyword">static</span> <a href="d8a0f2ae-7e10-39bd-e362-3756cbae661b.htm">SharedParameterElement</a>^ <span class="identifier">DownloadParameter</span>(
	<a href="db03274b-a107-aa32-9034-f3e0df4bb1ec.htm">Document</a>^ <span class="parameter">document</span>, 
	<a href="7359f11b-4102-15f3-597b-51078e1141bc.htm">ParameterDownloadOptions</a>^ <span class="parameter">options</span>, 
	<a href="d9fcf276-9566-de83-2b0b-d89b65ccc8af.htm">ForgeTypeId</a>^ <span class="parameter">parameterTypeId</span>
)</pre></td></tr></table></span></div><div id="parameters"><h4 class="subHeading">Parameters</h4><dl paramName="document"><dt><span class="parameter">document</span></dt><dd>Type: <a href="db03274b-a107-aa32-9034-f3e0df4bb1ec.htm">Autodesk.Revit.DB<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>Document</a><br />
   Document in which to create a shared parameter from a downloaded definition.
</dd></dl><dl paramName="options"><dt><span class="parameter">options</span></dt><dd>Type: <a href="7359f11b-4102-15f3-597b-51078e1141bc.htm">Autodesk.Revit.DB<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>ParameterDownloadOptions</a><br />
   Parameter download options.
</dd></dl><dl paramName="parameterTypeId"><dt><span class="parameter">parameterTypeId</span></dt><dd>Type: <a href="d9fcf276-9566-de83-2b0b-d89b65ccc8af.htm">Autodesk.Revit.DB<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>ForgeTypeId</a><br />
   Parameter identifier.
</dd></dl></div><h4 class="subHeading">Return Value</h4>
   The shared parameter instance.
</div><h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle, event)" tabindex="0"><img id="remarksToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style=""><p>The identifier of a user-defined parameter definition on the Parameters Service has the form
   "parameters.&lt;accountId&gt;:&lt;schemaId&gt;-&lt;versionNumber&gt;", where &lt;versionNumber&gt; is a
   semantic version number such as "1.0.0" and &lt;accountId&gt; and &lt;schemaId&gt; are GUIDs consisting of
   32 hexadecimal digits. Revit will extract the &lt;schemaId&gt; GUID to identify the shared parameter
   element.</p><p>If a shared parameter with a matching GUID is not yet present in the document, this method will attempt
   to obtain the parameter and apply the given bindings. If the parameter definition is already available
   locally, Revit will use the local definition. Otherwise, Revit will attempt to download the requested
   parameter definition from the Parameters Service.</p><p>The given document may be either a project or a family document. The rules for adding parameters to
   project and family documents differ.</p><p>For family documents, requesting a parameter with a GUID matching that of a shared parameter already
   present in the family document is an error.</p><p>Family parameters must have unique names. There is an error if the target document is a family and the
   downloaded parameter is found to have a name that matches that of a parameter already present in the family
   document.</p><p>Family parameters must be initialized to a default value. There is an error if the target document is a
   family and the downloaded parameter is a Family Type parameter and no family of the requisite category
   exists in the family document.</p><p>When the target document is a project, if a parameter exactly matching the given ForgeTypeId is already
   present in the document, this method will not download anything. Otherwise, if a local shared parameter with
   a GUID colliding with the given ForgeTypeId is already present in the project document, this method will
   download the requested parameter from the Parameters Service, validate that the requested parameter is
   compatible with the existing local definition, and overwrite the existing local definition according to the
   downloaded definition. Attempting to download an incompatible definition that collides with an existing
   local shared parameter is an error. If the parameter or a compatible local parameter is already present in
   the target project document, this method will update the existing parameter's bindings according to the
   given bindings. When updating bindings, new category bindings may be added to the existing parameter but
   existing category bindings will not be removed.</p></div><h1 class="heading"><span onclick="ExpandCollapse(exceptionsToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exceptionsToggle, event)" tabindex="0"><img id="exceptionsToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Exceptions</span></h1><div id="exceptionsSection" class="section" name="collapseableSection" style=""><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th class="exceptionNameColumn">Exception</th><th class="exceptionConditionColumn">Condition</th></tr><tr><td><a href="2e6e4206-97a8-dd4b-df5d-4269f4bb6088.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>ArgumentException</a></td><td>
   Thrown when the parameter identifier does not include a GUID, when required bindings are not assigned, when
   the requested group identifier does not identify a group that accommodates user-defined parameters, when a
   parameter with a matching GUID is already present in the given family document, when the given project
   document already contains an incompatible parameter definition with the same GUID, or when a parameter with
   a matching name is already present in the given family document.
</td></tr><tr><td><a href="631e1424-60f4-929b-4e52-dda9dcd26316.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>ArgumentNullException</a></td><td>
   A non-optional argument was null
</td></tr><tr><td><a href="b26719be-e9a8-eab2-3fac-66bc8765febe.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>DefaultValueException</a></td><td>
   Thrown when the target document is a family and the downloaded parameter is a Family Type parameter and no
   family of the requisite category exists in the family document.
</td></tr><tr><td><a href="77e5da6e-c129-8e56-c944-26d2c5e925a3.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>NetworkCommunicationException</a></td><td>
   Thrown when communication with the Parameters Service is unsuccessful.
</td></tr><tr><td><a href="4ef7bcee-5831-e2c9-ee4a-06a0dd6c255f.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>ResourceNotFoundException</a></td><td>
   Thrown when the requested parameter definition is not found on the Parameters Service.
</td></tr><tr><td><a href="9f929b36-8215-444e-30fd-518c94fb6d29.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>SchemaException</a></td><td>
   Thrown when there is an error interpreting a downloaded parameter definition.
</td></tr></table></div></div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle, event)" tabindex="0"><img id="seeAlsoToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><a href="df5da06e-35c6-e32e-53c0-9fd68d3ab142.htm">ParameterUtils Class</a></div><div class="seeAlsoStyle"><a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB Namespace</a></div></div></div><div id="footer"><div class="footerLine"><img width="100%" height="3px" src="../icons/footer.gif" alt="Footer image" title="Footer image" /></div><A NAME="feedback"></A><span id="fb" class="feedbackcss"></span><p />Send comments on this topic to
        <a id="HT_MailLink" href="mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API">Autodesk</a><script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title;
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div></div></body></html>