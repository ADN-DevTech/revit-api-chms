<html xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>SaveAs Method (String, SaveAsOptions)</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="M:Autodesk.Revit.DB.Document.SaveAs(System.String,Autodesk.Revit.DB.SaveAsOptions)" /><meta name="Description" content="Saves the document to a given file path." /><meta name="Microsoft.Help.ContentType" content="Reference" /><link rel="stylesheet" type="text/css" href="../styles/Presentation.css" /><link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLink.css" /><script type="text/javascript" src="../scripts/EventUtilities.js"> </script><script type="text/javascript" src="../scripts/SplitScreen.js"> </script><script type="text/javascript" src="../scripts/Dropdown.js"> </script><script type="text/javascript" src="../scripts/script_manifold.js"> </script><script type="text/javascript" src="../scripts/script_feedBack.js"> </script><script type="text/javascript" src="../scripts/CheckboxMenu.js"> </script><script type="text/javascript" src="../scripts/CommonUtilities.js"> </script><meta name="container" content="Autodesk.Revit.DB" /><meta name="file" content="df74c7e1-a98a-7751-676a-e9b074566f62" /><meta name="guid" content="df74c7e1-a98a-7751-676a-e9b074566f62" /><xml><MSHelp:Attr Name="AssetID" Value="M:Autodesk.Revit.DB.Document.SaveAs(System.String,Autodesk.Revit.DB.SaveAsOptions)" /><MSHelp:TOCTitle Title="SaveAs Method (String, SaveAsOptions)" /><MSHelp:RLTitle Title="Document.SaveAs Method (String, SaveAsOptions) (Autodesk.Revit.DB)" /><MSHelp:Keyword Index="A" Term="M:Autodesk.Revit.DB.Document.SaveAs(System.String,Autodesk.Revit.DB.SaveAsOptions)" /><MSHelp:Attr Name="APIType" Value="Managed" /><MSHelp:Attr Name="APILocation" Value="RevitAPI.dll" /><MSHelp:Attr Name="APIName" Value="Autodesk.Revit.DB.Document.SaveAs" /><MSHelp:Attr Name="DevLang" Value="CSharp" /><MSHelp:Attr Name="DevLang" Value="VB" /><MSHelp:Attr Name="Locale" Value="en-us" /><MSHelp:Attr Name="TopicType" Value="kbSyntax" /><MSHelp:Attr Name="TopicType" Value="apiref" /><MSHelp:Attr Name="Abstract" Value="Saves the document to a given file path." /><MSHelp:Attr Name="AssemblyVersion" Value="24.0.0.0" /></xml><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script></head><body><input type="hidden" id="userDataCache" class="userDataStyle" /><input type="hidden" id="hiddenScrollOffset" /><img id="collapseImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" alt="Collapse image" title="Collapse image" /><img id="expandImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" alt="Expand Image" title="Expand Image" /><img id="collapseAllImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" /><img id="expandAllImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" /><img id="dropDownImage" style="display:none; height:0; width:0;" src="../icons/dropdown.gif" /><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../icons/dropdownHover.gif" /><img id="copyImage" style="display:none; height:0; width:0;" src="../icons/copycode.gif" alt="Copy image" title="Copy image" /><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../icons/copycodeHighlight.gif" alt="CopyHover image" title="CopyHover image" /><div id="header"><table id="topTable" cellspacing="0" cellpadding="0"><tr><td><span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage, event)" tabindex="0"><img ID="toggleAllImage" class="toggleAll" src="../icons/collapse_all.gif" /> <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">Collapse All</label><label id="expandAllLabel" for="toggleAllImage" style="display: none;">Expand All</label> </span><span>    </span><span id="devlangsDropdown" class="filter" tabindex="0"><img id="devlangsDropdownImage" src="../icons/dropdown.gif" /> <label id="devlangsMenuAllLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: All </nobr></label><label id="devlangsMenuMultipleLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Multiple </nobr></label><label id="devlangsMenuCSharpLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: C# </nobr></label><label id="devlangsMenuVisualBasicLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Visual Basic </nobr></label><label id="devlangsMenuManagedCPlusPlusLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Visual C++ </nobr></label></span></td></tr></table><div id="devlangsMenu"><input id="CSharpCheckbox" type="checkbox" data="CSharp,cs,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="CSharpCheckbox">C#</label><br /><input id="VisualBasicCheckbox" type="checkbox" data="VisualBasic,vb,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="VisualBasicCheckbox">Visual Basic</label><br /><input id="ManagedCPlusPlusCheckbox" type="checkbox" data="ManagedCPlusPlus,cpp,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="ManagedCPlusPlusCheckbox">Visual C++</label><br /></div><table id="bottomTable" cellpadding="0" cellspacing="0"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText">Revit 2024 API</span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Document<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>SaveAs Method (String, SaveAsOptions)</span></td></tr><tr id="headerTableRow3"><td align="left"><a href="db03274b-a107-aa32-9034-f3e0df4bb1ec.htm">Document Class</a> <a href="#exampleToggle" onclick="OpenSection(exampleToggle)">Example</a> <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> <span id="headfeedbackarea" class="feedbackhead"><a href="javascript:SubmitFeedback('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback');">Send Feedback</a></span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()" /><span style="color: DarkGray"></span><div class="summary">
   Saves the document to a given file path.
</div><p /><b>Namespace:</b> <a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB</a><br /><b>Assembly:</b> <span sdata="assembly">RevitAPI</span> (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)<br /><b>Since:</b> 
   2014
<h1 class="heading"><span onclick="ExpandCollapse(syntaxToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(syntaxToggle, event)" tabindex="0"><img id="syntaxToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Syntax</span></h1><div id="syntaxSection" class="section" name="collapseableSection" style=""><div id="syntaxCodeBlocks" class="code"><span codeLanguage="CSharp"><table><tr><th>C#</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">void</span> <span class="identifier">SaveAs</span>(
	<span class="nolink">string</span> <span class="parameter">filepath</span>,
	<a href="f8eecf56-8b25-4140-d66e-c87f0d664ee1.htm">SaveAsOptions</a> <span class="parameter">options</span>
)</pre></td></tr></table></span><span codeLanguage="VisualBasicDeclaration"><table><tr><th>Visual Basic</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Sub</span> <span class="identifier">SaveAs</span> ( _
	<span class="parameter">filepath</span> <span class="keyword">As</span> <span class="nolink">String</span>, _
	<span class="parameter">options</span> <span class="keyword">As</span> <a href="f8eecf56-8b25-4140-d66e-c87f0d664ee1.htm">SaveAsOptions</a> _
)</pre></td></tr></table></span><span codeLanguage="ManagedCPlusPlus"><table><tr><th>Visual C++</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="keyword">void</span> <span class="identifier">SaveAs</span>(
	<span class="nolink">String</span>^ <span class="parameter">filepath</span>, 
	<a href="f8eecf56-8b25-4140-d66e-c87f0d664ee1.htm">SaveAsOptions</a>^ <span class="parameter">options</span>
)</pre></td></tr></table></span></div><div id="parameters"><h4 class="subHeading">Parameters</h4><dl paramName="filepath"><dt><span class="parameter">filepath</span></dt><dd>Type: <span class="nolink">System<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>String</span><br />
   File name and path to be saved as. Either a relative or absolute path can be provided.
</dd></dl><dl paramName="options"><dt><span class="parameter">options</span></dt><dd>Type: <a href="f8eecf56-8b25-4140-d66e-c87f0d664ee1.htm">Autodesk.Revit.DB<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>SaveAsOptions</a><br />
   Options to govern the SaveAs operation.
</dd></dl></div></div><h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle, event)" tabindex="0"><img id="remarksToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style=""><p> This method may not be called unless all transactions, sub-transactions, and transaction groups
   that were opened by the API code were closed.
   That also implies that this method cannot be called during dynamic updates.
   Event handlers are not allowed to save document that are currently in modifiable state.</p><p> If options.rename is true, then the document's title in Revit's title bar
   will be updated automatically to reflect the file's new name. </p></div><h1 class="heading"><span onclick="ExpandCollapse(exampleToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exampleToggle, event)" tabindex="0"><img id="exampleToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Examples</span></h1><div id="exampleSection" class="section" name="collapseableSection" style=""><span id="cbc_1" x-lang="CSharp" codeLanguage="CSharp"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/CopyCode.gif" />Copy</span>C#</div><div class="code"><pre xml:space="preserve"><span class="highlight-comment">// Get the document's preview settings</span>
DocumentPreviewSettings settings = document.GetDocumentPreviewSettings();

<span class="highlight-comment">// Find a candidate plan view</span>
FilteredElementCollector collector = <span class="highlight-keyword">new</span> FilteredElementCollector(document);
collector.OfClass(<span class="highlight-keyword">typeof</span>(ViewPlan));

Func&lt;ViewPlan, <span class="highlight-keyword">bool</span>&gt; isValidForPreview = v =&gt; settings.IsViewIdValidForPreview(v.Id);

ViewPlan viewForPreview = collector.OfType&lt;ViewPlan&gt;().First&lt;ViewPlan&gt;(isValidForPreview);

<span class="highlight-comment">// Save the document</span>
SaveAsOptions options = <span class="highlight-keyword">new</span> SaveAsOptions();
options.PreviewViewId = viewForPreview.Id;

document.SaveAs(<span class="highlight-literal">@"c:\renamed_family.rfa"</span>, options);</pre></div></span><span id="cbc_2" x-lang="VisualBasic" codeLanguage="VisualBasic"><div class="highlight-title"><span class="highlight-copycode" onkeypress="javascript:CopyColorizedCodeCheckKey(this.parentNode, event);" tabindex="0" onmouseover="CopyCodeChangeIcon(this)" onmouseout="CopyCodeChangeIcon(this)" onclick="javascript:CopyColorizedCode(this.parentNode);"><img style="margin-right: 5px;" src="../icons/CopyCode.gif" />Copy</span>VB.NET</div><div class="code"><pre xml:space="preserve"><span class="highlight-comment">' Get the document's preview settings</span>
<span class="highlight-keyword">Dim</span> settings <span class="highlight-keyword">As</span> DocumentPreviewSettings = document.GetDocumentPreviewSettings()

<span class="highlight-comment">' Find a candidate plan view</span>
<span class="highlight-keyword">Dim</span> collector <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> FilteredElementCollector(document)
collector.OfClass(<span class="highlight-keyword">GetType</span>(ViewPlan))

<span class="highlight-keyword">Dim</span> isValidForPreview <span class="highlight-keyword">As</span> Func(<span class="highlight-keyword">Of</span> ViewPlan, <span class="highlight-keyword">Boolean</span>) = <span class="highlight-keyword">Function</span>(v) settings.IsViewIdValidForPreview(v.Id)

<span class="highlight-keyword">Dim</span> viewForPreview <span class="highlight-keyword">As</span> ViewPlan = collector.OfType(<span class="highlight-keyword">Of</span> ViewPlan)().First(isValidForPreview)

<span class="highlight-comment">' Save the document</span>
<span class="highlight-keyword">Dim</span> options <span class="highlight-keyword">As</span> <span class="highlight-keyword">New</span> SaveAsOptions()
options.PreviewViewId = viewForPreview.Id

document.SaveAs(<span class="highlight-literal">"c:\renamed_family.rfa"</span>, options)</pre></div></span></div><h1 class="heading"><span onclick="ExpandCollapse(exceptionsToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exceptionsToggle, event)" tabindex="0"><img id="exceptionsToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Exceptions</span></h1><div id="exceptionsSection" class="section" name="collapseableSection" style=""><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th class="exceptionNameColumn">Exception</th><th class="exceptionConditionColumn">Condition</th></tr><tr><td><a href="2e6e4206-97a8-dd4b-df5d-4269f4bb6088.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>ArgumentException</a></td><td>
   filepath is an empty string.
   -or-
   The specified filepath is invalid.
   -or-
   options.PreviewViewId is not valid for generation of a preview.
   -or-
   The document is not workshared,
   so no WorksharingSaveAsOptions are allowed to be set for SaveAs.
   -or-
   The document just had worksharing enabled or was opened detached,
   so WorksharingSaveAsOptions.SaveAsCentral must be set to true for SaveAs.
   -or-
   Revit cannot clear the transmitted flag. This is not a transmitted document.
</td></tr><tr><td><a href="631e1424-60f4-929b-4e52-dda9dcd26316.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>ArgumentNullException</a></td><td>
   A non-optional argument was null
</td></tr><tr><td><a href="0e2ac15f-ca64-42c3-b3ef-e6f7ca1cb59a.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>CentralModelException</a></td><td>
   Central model is missing.
   -or-
   Central model is incompatible.
   -or-
   The central model was saved in a different version of Revit.
   -or-
   Revit encountered errors while saving to the new central model.  Resave again as a new central model.
   -or-
   Incompatible servers for external services.
   -or-
   Username does not match the one used to create the local file.
   -or-
   Revit could not save all of the worksets that have been changed.  Try again.
</td></tr><tr><td><a href="187d56d7-0b37-699f-2abd-6ddebfa93f1e.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>FileAccessException</a></td><td>
   The file at the given path location could not be accessed or saved.
</td></tr><tr><td><a href="73250198-dbc6-e760-4297-ec062f00f574.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>FileNotFoundException</a></td><td>
   The given file, path or network location could not be found during save.
</td></tr><tr><td><a href="c5b911f6-1e8f-2cd4-6965-286f41221fe0.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>ForbiddenForDynamicUpdateException</a></td><td>
   SaveAs may not be called during dynamic update.
</td></tr><tr><td><a href="658e57bc-6929-4883-d245-dcd832fed696.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>InsufficientResourcesException</a></td><td>
   This computer does not have enough memory, disk space, or other necessary resource to save the model.
</td></tr><tr><td><a href="9e715f03-3884-e539-4dd6-8d7545733adc.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>InvalidOperationException</a></td><td>
   This Document is not a primary document, it is a linked document.
   -or-
   SaveAs is temporarily disabled.
   -or-
   options.overwriteExistingFile is 'false' but there is an existing file at filepath.
   -or-
   options.overwriteExistingFile is 'true' but the target file at filepath is read only.
   -or-
   Saving is not allowed in the current application mode.
   -or-
   Operation is not permitted when there is any open sub-transaction, transaction, or transaction group.
   -or-
   Revit cannot clear the transmitted flag. This is not a transmitted document.
   -or-
   Saving failed.
</td></tr><tr><td><a href="aea34480-ceb5-b49f-129d-0799e7bb1c21.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>OperationCanceledException</a></td><td>
   Saving was canceled by the user or by an API event callback.
</td></tr><tr><td><a href="d38fd86b-6281-788d-bf20-6b896da2fbbb.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>OutdatedDirectlyOpenedCentralException</a></td><td>
   Other users have modified the central model while you had it opened. Resave your document as a local file and then synchronize with central again.
</td></tr></table></div></div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle, event)" tabindex="0"><img id="seeAlsoToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><a href="db03274b-a107-aa32-9034-f3e0df4bb1ec.htm">Document Class</a></div><div class="seeAlsoStyle"><a href="c605e437-5f18-81a5-d4ed-e664ba4f941d.htm">SaveAs Overload</a></div><div class="seeAlsoStyle"><a href="87546ba7-461b-c646-cbb1-2cb8f5bff8b2.htm">Autodesk.Revit.DB Namespace</a></div></div></div><div id="footer"><div class="footerLine"><img width="100%" height="3px" src="../icons/footer.gif" alt="Footer image" title="Footer image" /></div><A NAME="feedback"></A><span id="fb" class="feedbackcss"></span><p />Send comments on this topic to
        <a id="HT_MailLink" href="mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API">Autodesk</a><script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title;
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div></div></body></html>