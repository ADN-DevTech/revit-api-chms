<html xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>SetPreferredConstraintForHandle Method </title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="SetPreferredConstraintForHandle method" /><meta name="System.Keywords" content="RebarConstraintsManager.SetPreferredConstraintForHandle method" /><meta name="Microsoft.Help.F1" content="Autodesk.Revit.DB.Structure.RebarConstraintsManager.SetPreferredConstraintForHandle" /><meta name="Microsoft.Help.Id" content="M:Autodesk.Revit.DB.Structure.RebarConstraintsManager.SetPreferredConstraintForHandle(Autodesk.Revit.DB.Structure.RebarConstrainedHandle,Autodesk.Revit.DB.Structure.RebarConstraint)" /><meta name="Description" content="For ShapeDriven Rebar: Sets the RebarConstraint as preferred constraint target for the specified RebarConstrainedHandle.For FreeForm Rebar: Sets the RebarConstraint as the target for the specified RebarConstraintHandle." /><meta name="Microsoft.Help.ContentType" content="Reference" /><link rel="stylesheet" type="text/css" href="../styles/Presentation.css" /><link rel="stylesheet" type="text/css" href="ms-help://Hx/HxRuntime/HxLink.css" /><script type="text/javascript" src="../scripts/EventUtilities.js"> </script><script type="text/javascript" src="../scripts/SplitScreen.js"> </script><script type="text/javascript" src="../scripts/Dropdown.js"> </script><script type="text/javascript" src="../scripts/script_manifold.js"> </script><script type="text/javascript" src="../scripts/script_feedBack.js"> </script><script type="text/javascript" src="../scripts/CheckboxMenu.js"> </script><script type="text/javascript" src="../scripts/CommonUtilities.js"> </script><meta name="container" content="Autodesk.Revit.DB.Structure" /><meta name="file" content="4ba8adbf-3098-5682-bf09-6a4cc5e0a203" /><meta name="guid" content="4ba8adbf-3098-5682-bf09-6a4cc5e0a203" /><xml><MSHelp:Attr Name="AssetID" Value="M:Autodesk.Revit.DB.Structure.RebarConstraintsManager.SetPreferredConstraintForHandle(Autodesk.Revit.DB.Structure.RebarConstrainedHandle,Autodesk.Revit.DB.Structure.RebarConstraint)" /><MSHelp:TOCTitle Title="SetPreferredConstraintForHandle Method " /><MSHelp:RLTitle Title="RebarConstraintsManager.SetPreferredConstraintForHandle Method  (Autodesk.Revit.DB.Structure)" /><MSHelp:Keyword Index="A" Term="M:Autodesk.Revit.DB.Structure.RebarConstraintsManager.SetPreferredConstraintForHandle(Autodesk.Revit.DB.Structure.RebarConstrainedHandle,Autodesk.Revit.DB.Structure.RebarConstraint)" /><MSHelp:Keyword Index="A" Term="frlrfAutodeskRevitDBStructureRebarConstraintsManagerClassSetPreferredConstraintForHandleTopic" /><MSHelp:Keyword Index="K" Term="SetPreferredConstraintForHandle method" /><MSHelp:Keyword Index="K" Term="RebarConstraintsManager.SetPreferredConstraintForHandle method" /><MSHelp:Keyword Index="F" Term="Autodesk.Revit.DB.Structure.RebarConstraintsManager.SetPreferredConstraintForHandle" /><MSHelp:Attr Name="APIType" Value="Managed" /><MSHelp:Attr Name="APILocation" Value="RevitAPI.dll" /><MSHelp:Attr Name="APIName" Value="Autodesk.Revit.DB.Structure.RebarConstraintsManager.SetPreferredConstraintForHandle" /><MSHelp:Attr Name="DevLang" Value="CSharp" /><MSHelp:Attr Name="DevLang" Value="VB" /><MSHelp:Attr Name="Locale" Value="en-us" /><MSHelp:Attr Name="TopicType" Value="kbSyntax" /><MSHelp:Attr Name="TopicType" Value="apiref" /><MSHelp:Attr Name="Abstract" Value="For ShapeDriven Rebar: Sets the RebarConstraint as preferred constraint target for the specified RebarConstrainedHandle.For FreeForm Rebar: Sets the RebarConstraint as the target for the specified RebarConstraintHandle." /><MSHelp:Attr Name="AssemblyVersion" Value="24.0.0.0" /></xml></head><body><input type="hidden" id="userDataCache" class="userDataStyle" /><input type="hidden" id="hiddenScrollOffset" /><img id="collapseImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" alt="Collapse image" title="Collapse image" /><img id="expandImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" alt="Expand Image" title="Expand Image" /><img id="collapseAllImage" style="display:none; height:0; width:0;" src="../icons/collapse_all.gif" /><img id="expandAllImage" style="display:none; height:0; width:0;" src="../icons/expand_all.gif" /><img id="dropDownImage" style="display:none; height:0; width:0;" src="../icons/dropdown.gif" /><img id="dropDownHoverImage" style="display:none; height:0; width:0;" src="../icons/dropdownHover.gif" /><img id="copyImage" style="display:none; height:0; width:0;" src="../icons/copycode.gif" alt="Copy image" title="Copy image" /><img id="copyHoverImage" style="display:none; height:0; width:0;" src="../icons/copycodeHighlight.gif" alt="CopyHover image" title="CopyHover image" /><div id="header"><table id="topTable" cellspacing="0" cellpadding="0"><tr><td><span onclick="ExpandCollapseAll(toggleAllImage)" style="cursor:default;" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage, event)" tabindex="0"><img ID="toggleAllImage" class="toggleAll" src="../icons/collapse_all.gif" /> <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">Collapse All</label><label id="expandAllLabel" for="toggleAllImage" style="display: none;">Expand All</label> </span><span>    </span><span id="devlangsDropdown" class="filter" tabindex="0"><img id="devlangsDropdownImage" src="../icons/dropdown.gif" /> <label id="devlangsMenuAllLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: All </nobr></label><label id="devlangsMenuMultipleLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Multiple </nobr></label><label id="devlangsMenuCSharpLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: C# </nobr></label><label id="devlangsMenuVisualBasicLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Visual Basic </nobr></label><label id="devlangsMenuManagedCPlusPlusLabel" for="devlangsDropdownImage" style="display: none;"><nobr>Code: Visual C++ </nobr></label></span></td></tr></table><div id="devlangsMenu"><input id="CSharpCheckbox" type="checkbox" data="CSharp,cs,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="CSharpCheckbox">C#</label><br /><input id="VisualBasicCheckbox" type="checkbox" data="VisualBasic,vb,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="VisualBasicCheckbox">Visual Basic</label><br /><input id="ManagedCPlusPlusCheckbox" type="checkbox" data="ManagedCPlusPlus,cpp,'persist'" value="on" onClick="SetLanguage(this)" /><label class="checkboxLabel" for="ManagedCPlusPlusCheckbox">Visual C++</label><br /></div><table id="bottomTable" cellpadding="0" cellspacing="0"><tr id="headerTableRow1"><td align="left"><span id="runningHeaderText">Revit 2024 API</span></td></tr><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">RebarConstraintsManager<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>SetPreferredConstraintForHandle Method </span></td></tr><tr id="headerTableRow3"><td align="left"><a href="32fe1ec6-ddb3-feac-f18c-8683b054f639.htm">RebarConstraintsManager Class</a> <a href="#seeAlsoToggle" onclick="OpenSection(seeAlsoToggle)">See Also</a> <span id="headfeedbackarea" class="feedbackhead"><a href="javascript:SubmitFeedback('revitapifeedback@autodesk.com','Revit 2024 API','','','','%0\dYour%20feedback%20is%20used%20to%20improve%20the%20documentation%20and%20the%20product.%20Your%20e-mail%20address%20will%20not%20be%20used%20for%20any%20other%20purpose%20and%20is%20disposed%20of%20after%20the%20issue%20you%20report%20is%20resolved.%20%20While%20working%20to%20resolve%20the%20issue%20that%20you%20report,%20you%20may%20be%20contacted%20via%20e-mail%20to%20get%20further%20details%20or%20clarification%20on%20the%20feedback%20you%20sent.%20After%20the%20issue%20you%20report%20has%20been%20addressed,%20you%20may%20receive%20an%20e-mail%20to%20let%20you%20know%20that%20your%20feedback%20has%20been%20addressed.%0\A%0\d','Customer%20Feedback');">Send Feedback</a></span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()" /><span style="color: DarkGray"></span><div class="summary"><p>For ShapeDriven Rebar: Sets the RebarConstraint as preferred constraint target for the specified RebarConstrainedHandle.</p><p>For FreeForm Rebar: Sets the RebarConstraint as the target for the specified RebarConstraintHandle.</p></div><p /><b>Namespace:</b> <a href="d586b341-f687-9d90-e96d-255806b7d4fc.htm">Autodesk.Revit.DB.Structure</a><br /><b>Assembly:</b> <span sdata="assembly">RevitAPI</span> (in RevitAPI.dll) Version: 24.0.0.0 (24.0.0.0)<br /><b>Since:</b> 
   2014
<h1 class="heading"><span onclick="ExpandCollapse(syntaxToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(syntaxToggle, event)" tabindex="0"><img id="syntaxToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Syntax</span></h1><div id="syntaxSection" class="section" name="collapseableSection" style=""><div id="syntaxCodeBlocks" class="code"><span codeLanguage="CSharp"><table><tr><th>C#</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">void</span> <span class="identifier">SetPreferredConstraintForHandle</span>(
	<a href="08b4c4a3-3bb9-0801-9cc8-cd5420a306d9.htm">RebarConstrainedHandle</a> <span class="parameter">handle</span>,
	<a href="748823c8-f059-68c1-d7b5-7cfaba93a445.htm">RebarConstraint</a> <span class="parameter">constraint</span>
)</pre></td></tr></table></span><span codeLanguage="VisualBasicDeclaration"><table><tr><th>Visual Basic</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">Public</span> <span class="keyword">Sub</span> <span class="identifier">SetPreferredConstraintForHandle</span> ( _
	<span class="parameter">handle</span> <span class="keyword">As</span> <a href="08b4c4a3-3bb9-0801-9cc8-cd5420a306d9.htm">RebarConstrainedHandle</a>, _
	<span class="parameter">constraint</span> <span class="keyword">As</span> <a href="748823c8-f059-68c1-d7b5-7cfaba93a445.htm">RebarConstraint</a> _
)</pre></td></tr></table></span><span codeLanguage="ManagedCPlusPlus"><table><tr><th>Visual C++</th></tr><tr><td><pre xml:space="preserve"><span class="keyword">public</span>:
<span class="keyword">void</span> <span class="identifier">SetPreferredConstraintForHandle</span>(
	<a href="08b4c4a3-3bb9-0801-9cc8-cd5420a306d9.htm">RebarConstrainedHandle</a>^ <span class="parameter">handle</span>, 
	<a href="748823c8-f059-68c1-d7b5-7cfaba93a445.htm">RebarConstraint</a>^ <span class="parameter">constraint</span>
)</pre></td></tr></table></span></div><div id="parameters"><h4 class="subHeading">Parameters</h4><dl paramName="handle"><dt><span class="parameter">handle</span></dt><dd>Type: <a href="08b4c4a3-3bb9-0801-9cc8-cd5420a306d9.htm">Autodesk.Revit.DB.Structure<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>RebarConstrainedHandle</a><br />
   The RebarConstrainedHandle to which the new RebarConstraint is to be applied.
</dd></dl><dl paramName="constraint"><dt><span class="parameter">constraint</span></dt><dd>Type: <a href="748823c8-f059-68c1-d7b5-7cfaba93a445.htm">Autodesk.Revit.DB.Structure<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>RebarConstraint</a><br />
   The new RebarConstraint to be applied to the RebarConstrainedHandle.
</dd></dl></div></div><h1 class="heading"><span onclick="ExpandCollapse(remarksToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(remarksToggle, event)" tabindex="0"><img id="remarksToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Remarks</span></h1><div id="remarksSection" class="section" name="collapseableSection" style=""><p>ShapeDriven:</p><p>The RebarConstraint should be one of the candidate RebarConstraints returned by
   getConstraintCandidatesForHandle.</p><p>In general, the caller should assume that the 'set' operation can fail, as some
   of the candidates may be legal targets for the handle, but may cause the rebar
   to flex into an insoluble shape.</p><p>Once a preferred constraint has been successfully assigned to a handle, the
   user can still drag the handle, and the Rebar can generally be flexed in much
   the same way as it could before (preferred constraints do not have the same
   effect as Revit locked dimensions).  However, the rebar's behavior will change
   in subtle ways.</p><p>A handle with a FixedDistanceToHostFace preferred constraint will allow the
   constraint's offset distance to change as the user moves the handle.  However,
   in subsequent model updates, the handle will continue to follow the preferred
   constraint target, even if other legitimate constraint targets are closer to
   the handle.  One can think of this behavior as equivalent to unlocking a
   locked dimension, moving one of dimension references, and then re-locking the
   dimension - all in one step.</p><p>When a handle with a ToCover or ToOtherRebar preferred constraint is dragged by
   the user, it will snap back to its constraint target, unless it is dragged
   beyond tolerance distance.  In that case, it will select a new constraint using
   default logic, but will continue to treat the "broken" constraint as preferred,
   and will snap back to the preferred target again, if it is dragged to within
   tolerance distance.</p><p>If, during a model update, the rebar determines that a preferred constraint
   target no longer exists, or has been modified so that it is no longer a legal
   candidate for the handle, then the rebar will remove the preferred status of
   that target and will assign a new constraint to the handle using the default
   logic.</p><p>FreeForm:</p><p>Sets the RebarConstraint to be active for the specified RebarConstrainedHandle.
   The RebarConstrainedHandle needs to be a valid handle for this rebar element.</p></div><h1 class="heading"><span onclick="ExpandCollapse(exceptionsToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(exceptionsToggle, event)" tabindex="0"><img id="exceptionsToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />Exceptions</span></h1><div id="exceptionsSection" class="section" name="collapseableSection" style=""><div class="tableSection"><table width="100%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th class="exceptionNameColumn">Exception</th><th class="exceptionConditionColumn">Condition</th></tr><tr><td><a href="2e6e4206-97a8-dd4b-df5d-4269f4bb6088.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>ArgumentException</a></td><td>
   constraint is no longer valid.
   -or-
   handle is no longer valid.
</td></tr><tr><td><a href="631e1424-60f4-929b-4e52-dda9dcd26316.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>ArgumentNullException</a></td><td>
   A non-optional argument was null
</td></tr><tr><td><a href="9e715f03-3884-e539-4dd6-8d7545733adc.htm">Autodesk.Revit.Exceptions<span class="languageSpecificText"><span class="cs">.</span><span class="vb">.</span><span class="cpp">::</span><span class="nu">.</span><span class="fs">.</span></span>InvalidOperationException</a></td><td>
   The RebarConstraintsManager does not manage a valid Rebar element.
</td></tr></table></div></div><h1 class="heading"><span onclick="ExpandCollapse(seeAlsoToggle)" style="cursor:default;" onkeypress="ExpandCollapse_CheckKey(seeAlsoToggle, event)" tabindex="0"><img id="seeAlsoToggle" class="toggle" name="toggleSwitch" src="../icons/collapse_all.gif" />See Also</span></h1><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><a href="32fe1ec6-ddb3-feac-f18c-8683b054f639.htm">RebarConstraintsManager Class</a></div><div class="seeAlsoStyle"><a href="d586b341-f687-9d90-e96d-255806b7d4fc.htm">Autodesk.Revit.DB.Structure Namespace</a></div></div></div><div id="footer"><div class="footerLine"><img width="100%" height="3px" src="../icons/footer.gif" alt="Footer image" title="Footer image" /></div><A NAME="feedback"></A><span id="fb" class="feedbackcss"></span><p />Send comments on this topic to
        <a id="HT_MailLink" href="mailto:revitapifeedback%40autodesk.com?Subject=Revit 2024 API">Autodesk</a><script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title;
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div></div></body></html>